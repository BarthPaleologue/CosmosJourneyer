
//  This file is part of Cosmos Journeyer
//
//  Copyright (C) 2024 Barthélemy Paléologue <barth.paleologue@cosmosjourneyer.com>
//
//  This program is free software: you can redistribute it and/or modify
//  it under the terms of the GNU Affero General Public License as published by
//  the Free Software Foundation, either version 3 of the License, or
//  (at your option) any later version.
//
//  This program is distributed in the hope that it will be useful,
//  but WITHOUT ANY WARRANTY; without even the implied warranty of
//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//  GNU Affero General Public License for more details.
//
//  You should have received a copy of the GNU Affero General Public License
//  along with this program.  If not, see <https://www.gnu.org/licenses/>.
        
"use strict";(self.webpackChunkcosmos_journeyer=self.webpackChunkcosmos_journeyer||[]).push([[357],{4629:(t,e,r)=>{r.d(e,{rX:()=>i});let i=!1},6885:(t,e,r)=>{function i(t,e,r=!1){const i=e.width,s=e.height;if(t instanceof Float32Array){let e=t.byteLength/t.BYTES_PER_ELEMENT;const r=new Uint8Array(e);for(;--e>=0;){let i=t[e];i<0?i=0:i>1&&(i=1),r[e]=255*i}t=r}const a=document.createElement("canvas");a.width=i,a.height=s;const n=a.getContext("2d");if(!n)return null;const h=n.createImageData(i,s);if(h.data.set(t),n.putImageData(h,0,0),r){const t=document.createElement("canvas");t.width=i,t.height=s;const e=t.getContext("2d");return e?(e.translate(0,s),e.scale(1,-1),e.drawImage(a,0,0),t.toDataURL("image/png")):null}return a.toDataURL("image/png")}function s(t,e=0,r=0){const s=t.getInternalTexture();if(!s)return null;const a=t._readPixelsSync(e,r);return a?i(a,t.getSize(),s.invertY):null}async function a(t,e=0,r=0){const s=t.getInternalTexture();if(!s)return null;const a=await t.readPixels(e,r);return a?i(a,t.getSize(),s.invertY):null}r.d(e,{lP:()=>s,nh:()=>a})},7967:(t,e,r)=>{r.d(e,{$z:()=>a,Cx:()=>b,GG:()=>p,P_:()=>c,WM:()=>u,Y9:()=>l,bR:()=>m,fW:()=>x,jT:()=>o,lK:()=>n,n1:()=>f,qK:()=>g,uM:()=>h,wL:()=>_,xG:()=>d});var i=r(44556);function s(t,e){return(r,s)=>{const a=(0,i.B)(r);a[s]||(a[s]={type:t,sourceName:e})}}function a(t,e=null){return function(t,e=null){return(r,i)=>{const s=e||"_"+i;Object.defineProperty(r,i,{get:function(){return this[s]},set:function(e){"function"==typeof this.equals&&this.equals(e)||this[s]!==e&&(this[s]=e,r[t].apply(this))},enumerable:!0,configurable:!0})}}(t,e)}function n(t){return s(0,t)}function h(t){return s(1,t)}function o(t){return s(2,t)}function l(t){return s(3,t)}function u(t){return s(4,t)}function c(t){return s(5,t)}function d(t){return s(6,t)}function _(t){return s(7,t)}function g(t){return s(8,t)}function f(t){return s(9,t)}function m(t){return s(10,t)}function p(t){return s(12,t)}function x(t){return s(11,t)}function b(t,e,r,i){const s=r.value;r.value=(...r)=>{let a=s;if("undefined"!=typeof _native&&_native[e]){const t=_native[e];a=i?(...e)=>i(...e)?t(...e):s(...e):t}return t[e]=a,a(...r)}}b.filter=function(t){return(e,r,i)=>b(e,r,i,t)}},10136:(t,e,r)=>{function i(t,e,r,i){var s,a=arguments.length,n=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,r,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(n=(a<3?s(n):a>3?s(e,r,n):s(e,r))||n);return a>3&&n&&Object.defineProperty(e,r,n),n}r.d(e,{Cg:()=>i}),Object.create,Object.create},10460:(t,e,r)=>{r.d(e,{D:()=>s});var i=r(56301);class s{get wrapU(){return this._wrapU}set wrapU(t){this._wrapU=t}get wrapV(){return this._wrapV}set wrapV(t){this._wrapV=t}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(t){this._texture&&(this._texture.isCube=t)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(t){this._texture&&(this._texture.is3D=t)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(t){this._texture&&(this._texture.is2DArray=t)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(t){return void 0!==t?.shareDepth}constructor(t){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=i.o.Zero(),this._cachedBaseSize=i.o.Zero(),this._initialSamplingMode=2,this._texture=s._IsRenderTargetWrapper(t)?t.texture:t,this._texture&&(this._engine=this._texture.getEngine())}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(t){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(t,this._texture)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}},11357:(t,e,r)=>{r.d(e,{g:()=>p});var i=r(10136),s=r(7967),a=r(40380),n=r(34991),h=r(94826),o=r(9300),l=r(24099),u=r(87712),c=r(477),d=r(27216),_=r(62273),g=r(6885),f=r(4629),m=r(15153);class p extends h.t{static _CreateVideoTexture(t,e,r,i=!1,s=!1,a=p.TRILINEAR_SAMPLINGMODE,n={},h,o=5){throw(0,l.n)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(t){this._isBlocking=t}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(t,e,r,i,s=p.TRILINEAR_SAMPLINGMODE,n=null,h=null,o=null,l=!1,c,d,_,g,m){let x;super(e),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new a.cP,this._isBlocking=!0,this.name=t||"",this.url=t;let b=!1,R=null,T=!0;"object"==typeof r&&null!==r?(x=r.noMipmap??!1,i=r.invertY??!f.rX,s=r.samplingMode??p.TRILINEAR_SAMPLINGMODE,n=r.onLoad??null,h=r.onError??null,o=r.buffer??null,l=r.deleteBuffer??!1,c=r.format,d=r.mimeType,_=r.loaderOptions,g=r.creationFlags,b=r.useSRGBBuffer??!1,R=r.internalTexture??null,T=r.gammaSpace??T,m=r.forcedExtension??m):x=!!r,this._gammaSpace=T,this._noMipmap=x,this._invertY=void 0===i?!f.rX:i,this._initialSamplingMode=s,this._buffer=o,this._deleteBuffer=l,this._mimeType=d,this._loaderOptions=_,this._creationFlags=g,this._useSRGBBuffer=b,this._forcedExtension=m,c&&(this._format=c);const M=this.getScene(),y=this._getEngine();if(!y)return;y.onBeforeTextureInitObservable.notifyObservers(this);const S=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),n&&n(),!this.isBlocking&&M&&M.resetCachedMaterial()},w=(t,e)=>{this._loadingError=!0,this._errorObject={message:t,exception:e},h&&h(t,e),p.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!R)return this._delayedOnLoad=S,void(this._delayedOnError=w);if(this._texture=R??this._getFromCache(this.url,x,s,this._invertY,b,this.isCube),this._texture)if(this._texture.isReady)u._.SetImmediate((()=>S()));else{const t=this._texture.onLoadedObservable.add(S);this._texture.onErrorObservable.add((e=>{w(e.message,e.exception),this._texture?.onLoadedObservable.remove(t)}))}else if(M&&M.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=S,this._delayedOnError=w;else{try{this._texture=y.createTexture(this.url,x,this._invertY,M,s,S,w,this._buffer,void 0,this._format,this._forcedExtension,d,_,g,b)}catch(t){throw w("error loading",t),t}l&&(this._buffer=null)}}updateURL(t,e=null,r,i){this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(1,(t=>t.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=t),this.url=t,this._buffer=e,this._forcedExtension=i,this.delayLoadState=4,r&&(this._delayedOnLoad=r),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const t=this.getScene();t&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?u._.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=t.getEngine().createTexture(this.url,this._noMipmap,this._invertY,t,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(t,e,r,i){t*=this._cachedUScale,e*=this._cachedVScale,t-=this.uRotationCenter*this._cachedUScale,e-=this.vRotationCenter*this._cachedVScale,r-=this.wRotationCenter,n.Pq.TransformCoordinatesFromFloatsToRef(t,e,r,this._rowGenerationMatrix,i),i.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,i.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,i.z+=this.wRotationCenter}getTextureMatrix(t=1){if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*t===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*t,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=n.uq.Zero(),this._rowGenerationMatrix=new n.uq,this._t0=n.Pq.Zero(),this._t1=n.Pq.Zero(),this._t2=n.Pq.Zero()),n.uq.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(n.uq.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,n.AA.Matrix[0]),n.uq.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,n.AA.Matrix[1]),n.uq.ScalingToRef(this._cachedUScale,this._cachedVScale,0,n.AA.Matrix[2]),n.uq.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,n.AA.Matrix[3]),n.AA.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(n.AA.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(n.AA.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(n.AA.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),n.uq.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const e=this.getScene();if(!e)return this._cachedTextureMatrix;const r=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&r!==this._cachedIdentity3x2&&e.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const t=this.getScene();if(!t)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==p.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===t.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=n.uq.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=n.uq.Zero());const e=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case p.PLANAR_MODE:n.uq.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case p.PROJECTION_MODE:{n.uq.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const e=t.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=e.updateFlag,e.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:n.uq.IdentityToRef(this._cachedReflectionTextureMatrix)}return e&&t.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const t={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,onLoad:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return m.p.Clone((()=>new p(this._texture?this._texture.url:null,this.getScene(),t)),this)}serialize(){const t=this.name;p.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const e=super.serialize(p._SerializeInternalTextureUniqueId);return e?((p.SerializeBuffers||p.ForceSerializeBuffers)&&("string"==typeof this._buffer&&"data:"===this._buffer.substring(0,5)?(e.base64String=this._buffer,e.name=e.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?e.base64String="data:image/png;base64,"+(0,_.EL)(this._buffer):(p.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(e.base64String=!this._engine||this._engine._features.supportSyncTextureRead?(0,g.lP)(this):(0,g.nh)(this))),e.invertY=this._invertY,e.samplingMode=this.samplingMode,e._creationFlags=this._creationFlags,e._useSRGBBuffer=this._useSRGBBuffer,p._SerializeInternalTextureUniqueId&&(e.internalTextureUniqueId=this._texture?.uniqueId),e.internalTextureLabel=this._texture?.label,e.noMipmap=this._noMipmap,this.name=t,e):null}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(t,e,r){if(t.customType){const i=c.n.Instantiate(t.customType).Parse(t,e,r);return t.samplingMode&&i.updateSamplingMode&&i._samplingMode&&i._samplingMode!==t.samplingMode&&i.updateSamplingMode(t.samplingMode),i}if(t.isCube&&!t.isRenderTarget)return p._CubeTextureParser(t,e,r);const i=void 0!==t.internalTextureUniqueId;if(!t.name&&!t.isRenderTarget&&!i)return null;let s;if(i){const r=e.getEngine().getLoadedTexturesCache();for(const e of r)if(e.uniqueId===t.internalTextureUniqueId){s=e;break}}const a=e=>{if(e&&e._texture&&(e._texture._cachedWrapU=null,e._texture._cachedWrapV=null,e._texture._cachedWrapR=null),t.samplingMode){const r=t.samplingMode;e&&e.samplingMode!==r&&e.updateSamplingMode(r)}if(e&&t.animations)for(let r=0;r<t.animations.length;r++){const i=t.animations[r],s=(0,o.n9)("BABYLON.Animation");s&&e.animations.push(s.Parse(i))}e&&e._texture&&(i&&!s&&e._texture._setUniqueId(t.internalTextureUniqueId),e._texture.label=t.internalTextureLabel)};return m.p.Parse((()=>{let i=!0;if(t.noMipmap&&(i=!1),t.mirrorPlane){const r=p._CreateMirror(t.name,t.renderTargetSize,e,i);return r._waitingRenderList=t.renderList,r.mirrorPlane=d.Z.FromArray(t.mirrorPlane),a(r),r}if(t.isRenderTarget){let r=null;if(t.isCube){if(e.reflectionProbes)for(let r=0;r<e.reflectionProbes.length;r++){const i=e.reflectionProbes[r];if(i.name===t.name)return i.cubeTexture}}else r=p._CreateRenderTargetTexture(t.name,t.renderTargetSize,e,i,t._creationFlags??0),r._waitingRenderList=t.renderList;return a(r),r}if(t.isVideo){const s=p._CreateVideoTexture(r+(t.url||t.name),r+(t.src||t.url),e,i,t.invertY,t.samplingMode,t.settings||{});return a(s),s}{let n;if(t.base64String&&!s)n=p.CreateFromBase64String(t.base64String,t.base64String,e,!i,t.invertY,t.samplingMode,(()=>{a(n)}),t._creationFlags??0,t._useSRGBBuffer??!1),n.name=t.name;else{let h;h=t.name&&(t.name.indexOf("://")>0||t.name.startsWith("data:"))?t.name:r+t.name,t.url&&(t.url.startsWith("data:")||p.UseSerializedUrlIfAny)&&(h=t.url);const o={noMipmap:!i,invertY:t.invertY,samplingMode:t.samplingMode,onLoad:()=>{a(n)},internalTexture:s};n=new p(h,e,o)}return n}}),t,e)}static CreateFromBase64String(t,e,r,i,s,a=p.TRILINEAR_SAMPLINGMODE,n=null,h=null,o=5,l,u){return new p("data:"+e,r,i,s,a,n,h,t,!1,o,void 0,void 0,l,u)}static LoadFromDataString(t,e,r,i=!1,s,a=!0,n=p.TRILINEAR_SAMPLINGMODE,h=null,o=null,l=5,u,c){return"data:"!==t.substring(0,5)&&(t="data:"+t),new p(t,r,s,a,n,h,o,e,i,l,void 0,void 0,u,c)}}p.SerializeBuffers=!0,p.ForceSerializeBuffers=!1,p.OnTextureLoadErrorObservable=new a.cP,p._SerializeInternalTextureUniqueId=!1,p._CubeTextureParser=(t,e,r)=>{throw(0,l.n)("CubeTexture")},p._CreateMirror=(t,e,r,i)=>{throw(0,l.n)("MirrorTexture")},p._CreateRenderTargetTexture=(t,e,r,i,s)=>{throw(0,l.n)("RenderTargetTexture")},p.NEAREST_SAMPLINGMODE=1,p.NEAREST_NEAREST_MIPLINEAR=8,p.BILINEAR_SAMPLINGMODE=2,p.LINEAR_LINEAR_MIPNEAREST=11,p.TRILINEAR_SAMPLINGMODE=3,p.LINEAR_LINEAR_MIPLINEAR=3,p.NEAREST_NEAREST_MIPNEAREST=4,p.NEAREST_LINEAR_MIPNEAREST=5,p.NEAREST_LINEAR_MIPLINEAR=6,p.NEAREST_LINEAR=7,p.NEAREST_NEAREST=1,p.LINEAR_NEAREST_MIPNEAREST=9,p.LINEAR_NEAREST_MIPLINEAR=10,p.LINEAR_LINEAR=2,p.LINEAR_NEAREST=12,p.EXPLICIT_MODE=0,p.SPHERICAL_MODE=1,p.PLANAR_MODE=2,p.CUBIC_MODE=3,p.PROJECTION_MODE=4,p.SKYBOX_MODE=5,p.INVCUBIC_MODE=6,p.EQUIRECTANGULAR_MODE=7,p.FIXED_EQUIRECTANGULAR_MODE=8,p.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,p.CLAMP_ADDRESSMODE=0,p.WRAP_ADDRESSMODE=1,p.MIRROR_ADDRESSMODE=2,p.UseSerializedUrlIfAny=!1,(0,i.Cg)([(0,s.lK)()],p.prototype,"url",void 0),(0,i.Cg)([(0,s.lK)()],p.prototype,"uOffset",void 0),(0,i.Cg)([(0,s.lK)()],p.prototype,"vOffset",void 0),(0,i.Cg)([(0,s.lK)()],p.prototype,"uScale",void 0),(0,i.Cg)([(0,s.lK)()],p.prototype,"vScale",void 0),(0,i.Cg)([(0,s.lK)()],p.prototype,"uAng",void 0),(0,i.Cg)([(0,s.lK)()],p.prototype,"vAng",void 0),(0,i.Cg)([(0,s.lK)()],p.prototype,"wAng",void 0),(0,i.Cg)([(0,s.lK)()],p.prototype,"uRotationCenter",void 0),(0,i.Cg)([(0,s.lK)()],p.prototype,"vRotationCenter",void 0),(0,i.Cg)([(0,s.lK)()],p.prototype,"wRotationCenter",void 0),(0,i.Cg)([(0,s.lK)()],p.prototype,"homogeneousRotationInUVTransform",void 0),(0,i.Cg)([(0,s.lK)()],p.prototype,"isBlocking",null),(0,o.Y5)("BABYLON.Texture",p),m.p._TextureParser=p.Parse},15153:(t,e,r)=>{r.d(e,{p:()=>l});var i=r(24099),s=r(81036),a=r(21797),n=r(34991),h=r(44556);const o=function(t,e,r,i={}){const a=t();s.Y&&s.Y.HasTags(e)&&s.Y.AddTagsTo(a,s.Y.GetTags(e,!0));const n=(0,h.K)(a),o={};for(const t in n){const s=n[t],h=e[t],u=s.type;if(null!=h&&("uniqueId"!==t||l.AllowLoadingUniqueId))switch(u){case 0:case 6:case 9:case 11:a[t]=h;break;case 1:i.cloneTexturesOnlyOnce&&o[h.uniqueId]?a[t]=o[h.uniqueId]:(a[t]=r||h.isRenderTarget?h:h.clone(),o[h.uniqueId]=a[t]);break;case 2:case 3:case 4:case 5:case 7:case 8:case 10:case 12:a[t]=r?h:h.clone()}}return a};class l{static AppendSerializedAnimations(t,e){if(t.animations){e.animations=[];for(let r=0;r<t.animations.length;r++){const i=t.animations[r];e.animations.push(i.serialize())}}}static Serialize(t,e){e||(e={}),s.Y&&(e.tags=s.Y.GetTags(t));const r=(0,h.K)(t);for(const i in r){const s=r[i],a=s.sourceName||i,n=s.type,h=t[i];if(null!=h&&("uniqueId"!==i||l.AllowLoadingUniqueId))switch(n){case 0:e[a]=h;break;case 1:case 3:case 7:case 9:e[a]=h.serialize();break;case 2:case 4:case 5:case 8:case 10:case 12:e[a]=h.asArray();break;case 6:case 11:e[a]=h.id}}return e}static ParseProperties(t,e,r,i){i||(i="");const s=(0,h.K)(e);for(const h in s){const o=s[h],u=t[o.sourceName||h],c=o.type;if(null!=u&&("uniqueId"!==h||l.AllowLoadingUniqueId)){const t=e;switch(c){case 0:t[h]=u;break;case 1:r&&(t[h]=l._TextureParser(u,r,i));break;case 2:t[h]=a.v9.FromArray(u);break;case 3:t[h]=l._FresnelParametersParser(u);break;case 4:t[h]=n.I9.FromArray(u);break;case 5:t[h]=n.Pq.FromArray(u);break;case 6:r&&(t[h]=r.getLastMeshById(u));break;case 7:t[h]=l._ColorCurvesParser(u);break;case 8:t[h]=a.ov.FromArray(u);break;case 9:t[h]=l._ImageProcessingConfigurationParser(u);break;case 10:t[h]=n.PT.FromArray(u);break;case 11:r&&(t[h]=r.getCameraById(u));break;case 12:t[h]=n.uq.FromArray(u)}}}}static Parse(t,e,r,i=null){const a=t();return s.Y&&s.Y.AddTagsTo(a,e.tags),l.ParseProperties(e,a,r,i),a}static Clone(t,e,r={}){return o(t,e,!1,r)}static Instanciate(t,e){return o(t,e,!0)}}l.AllowLoadingUniqueId=!1,l._ImageProcessingConfigurationParser=t=>{throw(0,i.n)("ImageProcessingConfiguration")},l._FresnelParametersParser=t=>{throw(0,i.n)("FresnelParameters")},l._ColorCurvesParser=t=>{throw(0,i.n)("ColorCurves")},l._TextureParser=(t,e,r)=>{throw(0,i.n)("Texture")}},21797:(t,e,r)=>{r.d(e,{IG:()=>_,ov:()=>d,v9:()=>c});var i=r(7913),s=r(9300),a=r(19779),n=r(33583);function h(t){return Math.pow(t,a.tk)}function o(t){return t<=.04045?.0773993808*t:Math.pow(.947867299*(t+.055),2.4)}function l(t){return Math.pow(t,a.rv)}function u(t){return t<=.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class c{constructor(t=0,e=0,r=0){this.r=t,this.g=e,this.b=r}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let t=255*this.r|0;return t=397*t^255*this.g,t=397*t^255*this.b,t}toArray(t,e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,this}fromArray(t,e=0){return c.FromArrayToRef(t,e,this),this}toColor4(t=1){return new d(this.r,this.g,this.b,t)}asArray(){return[this.r,this.g,this.b]}toLuminance(){return.3*this.r+.59*this.g+.11*this.b}multiply(t){return new c(this.r*t.r,this.g*t.g,this.b*t.b)}multiplyToRef(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,e}multiplyInPlace(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyByFloats(t,e,r){return new c(this.r*t,this.g*e,this.b*r)}divide(t){throw new ReferenceError("Can not divide a color")}divideToRef(t,e){throw new ReferenceError("Can not divide a color")}divideInPlace(t){throw new ReferenceError("Can not divide a color")}minimizeInPlace(t){return this.minimizeInPlaceFromFloats(t.r,t.g,t.b)}maximizeInPlace(t){return this.maximizeInPlaceFromFloats(t.r,t.g,t.b)}minimizeInPlaceFromFloats(t,e,r){return this.r=Math.min(t,this.r),this.g=Math.min(e,this.g),this.b=Math.min(r,this.b),this}maximizeInPlaceFromFloats(t,e,r){return this.r=Math.max(t,this.r),this.g=Math.max(e,this.g),this.b=Math.max(r,this.b),this}floorToRef(t){throw new ReferenceError("Can not floor a color")}floor(){throw new ReferenceError("Can not floor a color")}fractToRef(t){throw new ReferenceError("Can not fract a color")}fract(){throw new ReferenceError("Can not fract a color")}equals(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b}equalsFloats(t,e,r){return this.equalsToFloats(t,e,r)}equalsToFloats(t,e,r){return this.r===t&&this.g===e&&this.b===r}equalsWithEpsilon(t,e=a.bH){return(0,n.WithinEpsilon)(this.r,t.r,e)&&(0,n.WithinEpsilon)(this.g,t.g,e)&&(0,n.WithinEpsilon)(this.b,t.b,e)}negate(){throw new ReferenceError("Can not negate a color")}negateInPlace(){throw new ReferenceError("Can not negate a color")}negateToRef(t){throw new ReferenceError("Can not negate a color")}scale(t){return new c(this.r*t,this.g*t,this.b*t)}scaleInPlace(t){return this.r*=t,this.g*=t,this.b*=t,this}scaleToRef(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e}scaleAndAddToRef(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,e}clampToRef(t=0,e=1,r){return r.r=(0,n.Clamp)(this.r,t,e),r.g=(0,n.Clamp)(this.g,t,e),r.b=(0,n.Clamp)(this.b,t,e),r}add(t){return new c(this.r+t.r,this.g+t.g,this.b+t.b)}addInPlace(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addInPlaceFromFloats(t,e,r){return this.r+=t,this.g+=e,this.b+=r,this}addToRef(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,e}subtract(t){return new c(this.r-t.r,this.g-t.g,this.b-t.b)}subtractToRef(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e}subtractInPlace(t){return this.r-=t.r,this.g-=t.g,this.b-=t.b,this}subtractFromFloats(t,e,r){return new c(this.r-t,this.g-e,this.b-r)}subtractFromFloatsToRef(t,e,r,i){return i.r=this.r-t,i.g=this.g-e,i.b=this.b-r,i}clone(){return new c(this.r,this.g,this.b)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyFromFloats(t,e,r){return this.r=t,this.g=e,this.b=r,this}set(t,e,r){return this.copyFromFloats(t,e,r)}setAll(t){return this.r=this.g=this.b=t,this}toHexString(){const t=Math.round(255*this.r),e=Math.round(255*this.g),r=Math.round(255*this.b);return"#"+(0,n.ToHex)(t)+(0,n.ToHex)(e)+(0,n.ToHex)(r)}fromHexString(t){return"#"!==t.substring(0,1)||7!==t.length||(this.r=parseInt(t.substring(1,3),16)/255,this.g=parseInt(t.substring(3,5),16)/255,this.b=parseInt(t.substring(5,7),16)/255),this}toHSV(){return this.toHSVToRef(new c)}toHSVToRef(t){const e=this.r,r=this.g,i=this.b,s=Math.max(e,r,i),a=Math.min(e,r,i);let n=0,h=0;const o=s,l=s-a;return 0!==s&&(h=l/s),s!=a&&(s==e?(n=(r-i)/l,r<i&&(n+=6)):s==r?n=(i-e)/l+2:s==i&&(n=(e-r)/l+4),n*=60),t.r=n,t.g=h,t.b=o,t}toLinearSpace(t=!1){const e=new c;return this.toLinearSpaceToRef(e,t),e}toLinearSpaceToRef(t,e=!1){return e?(t.r=o(this.r),t.g=o(this.g),t.b=o(this.b)):(t.r=h(this.r),t.g=h(this.g),t.b=h(this.b)),this}toGammaSpace(t=!1){const e=new c;return this.toGammaSpaceToRef(e,t),e}toGammaSpaceToRef(t,e=!1){return e?(t.r=u(this.r),t.g=u(this.g),t.b=u(this.b)):(t.r=l(this.r),t.g=l(this.g),t.b=l(this.b)),this}static HSVtoRGBToRef(t,e,r,i){const s=r*e,a=t/60,n=s*(1-Math.abs(a%2-1));let h=0,o=0,l=0;a>=0&&a<=1?(h=s,o=n):a>=1&&a<=2?(h=n,o=s):a>=2&&a<=3?(o=s,l=n):a>=3&&a<=4?(o=n,l=s):a>=4&&a<=5?(h=n,l=s):a>=5&&a<=6&&(h=s,l=n);const u=r-s;return i.r=h+u,i.g=o+u,i.b=l+u,i}static FromHSV(t,e,r){const i=new c(0,0,0);return c.HSVtoRGBToRef(t,e,r,i),i}static FromHexString(t){return new c(0,0,0).fromHexString(t)}static FromArray(t,e=0){return new c(t[e],t[e+1],t[e+2])}static FromArrayToRef(t,e=0,r){r.r=t[e],r.g=t[e+1],r.b=t[e+2]}static FromInts(t,e,r){return new c(t/255,e/255,r/255)}static Lerp(t,e,r){const i=new c(0,0,0);return c.LerpToRef(t,e,r,i),i}static LerpToRef(t,e,r,i){i.r=t.r+(e.r-t.r)*r,i.g=t.g+(e.g-t.g)*r,i.b=t.b+(e.b-t.b)*r}static Hermite(t,e,r,i,s){const a=s*s,n=s*a,h=2*n-3*a+1,o=-2*n+3*a,l=n-2*a+s,u=n-a,d=t.r*h+r.r*o+e.r*l+i.r*u,_=t.g*h+r.g*o+e.g*l+i.g*u,g=t.b*h+r.b*o+e.b*l+i.b*u;return new c(d,_,g)}static Hermite1stDerivative(t,e,r,i,s){const a=c.Black();return this.Hermite1stDerivativeToRef(t,e,r,i,s,a),a}static Hermite1stDerivativeToRef(t,e,r,i,s,a){const n=s*s;a.r=6*(n-s)*t.r+(3*n-4*s+1)*e.r+6*(-n+s)*r.r+(3*n-2*s)*i.r,a.g=6*(n-s)*t.g+(3*n-4*s+1)*e.g+6*(-n+s)*r.g+(3*n-2*s)*i.g,a.b=6*(n-s)*t.b+(3*n-4*s+1)*e.b+6*(-n+s)*r.b+(3*n-2*s)*i.b}static Red(){return new c(1,0,0)}static Green(){return new c(0,1,0)}static Blue(){return new c(0,0,1)}static Black(){return new c(0,0,0)}static get BlackReadOnly(){return c._BlackReadOnly}static White(){return new c(1,1,1)}static Purple(){return new c(.5,0,.5)}static Magenta(){return new c(1,0,1)}static Yellow(){return new c(1,1,0)}static Gray(){return new c(.5,.5,.5)}static Teal(){return new c(0,1,1)}static Random(){return new c(Math.random(),Math.random(),Math.random())}}c._V8PerformanceHack=new c(.5,.5,.5),c._BlackReadOnly=c.Black(),Object.defineProperties(c.prototype,{dimension:{value:[3]},rank:{value:1}});class d{constructor(t=0,e=0,r=0,i=1){this.r=t,this.g=e,this.b=r,this.a=i}asArray(){return[this.r,this.g,this.b,this.a]}toArray(t,e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t[e+3]=this.a,this}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this.a=t[e+3],this}equals(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}add(t){return new d(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}addToRef(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,e.a=this.a+t.a,e}addInPlace(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this}addInPlaceFromFloats(t,e,r,i){return this.r+=t,this.g+=e,this.b+=r,this.a+=i,this}subtract(t){return new d(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}subtractToRef(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e.a=this.a-t.a,e}subtractInPlace(t){return this.r-=t.r,this.g-=t.g,this.b-=t.b,this.a-=t.a,this}subtractFromFloats(t,e,r,i){return new d(this.r-t,this.g-e,this.b-r,this.a-i)}subtractFromFloatsToRef(t,e,r,i,s){return s.r=this.r-t,s.g=this.g-e,s.b=this.b-r,s.a=this.a-i,s}scale(t){return new d(this.r*t,this.g*t,this.b*t,this.a*t)}scaleInPlace(t){return this.r*=t,this.g*=t,this.b*=t,this.a*=t,this}scaleToRef(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e.a=this.a*t,e}scaleAndAddToRef(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,e.a+=this.a*t,e}clampToRef(t=0,e=1,r){return r.r=(0,n.Clamp)(this.r,t,e),r.g=(0,n.Clamp)(this.g,t,e),r.b=(0,n.Clamp)(this.b,t,e),r.a=(0,n.Clamp)(this.a,t,e),r}multiply(t){return new d(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a)}multiplyToRef(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,e.a=this.a*t.a,e}multiplyInPlace(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this.a*=t.a,this}multiplyByFloats(t,e,r,i){return new d(this.r*t,this.g*e,this.b*r,this.a*i)}divide(t){throw new ReferenceError("Can not divide a color")}divideToRef(t,e){throw new ReferenceError("Can not divide a color")}divideInPlace(t){throw new ReferenceError("Can not divide a color")}minimizeInPlace(t){return this.r=Math.min(this.r,t.r),this.g=Math.min(this.g,t.g),this.b=Math.min(this.b,t.b),this.a=Math.min(this.a,t.a),this}maximizeInPlace(t){return this.r=Math.max(this.r,t.r),this.g=Math.max(this.g,t.g),this.b=Math.max(this.b,t.b),this.a=Math.max(this.a,t.a),this}minimizeInPlaceFromFloats(t,e,r,i){return this.r=Math.min(t,this.r),this.g=Math.min(e,this.g),this.b=Math.min(r,this.b),this.a=Math.min(i,this.a),this}maximizeInPlaceFromFloats(t,e,r,i){return this.r=Math.max(t,this.r),this.g=Math.max(e,this.g),this.b=Math.max(r,this.b),this.a=Math.max(i,this.a),this}floorToRef(t){throw new ReferenceError("Can not floor a color")}floor(){throw new ReferenceError("Can not floor a color")}fractToRef(t){throw new ReferenceError("Can not fract a color")}fract(){throw new ReferenceError("Can not fract a color")}negate(){throw new ReferenceError("Can not negate a color")}negateInPlace(){throw new ReferenceError("Can not negate a color")}negateToRef(t){throw new ReferenceError("Can not negate a color")}equalsWithEpsilon(t,e=a.bH){return(0,n.WithinEpsilon)(this.r,t.r,e)&&(0,n.WithinEpsilon)(this.g,t.g,e)&&(0,n.WithinEpsilon)(this.b,t.b,e)&&(0,n.WithinEpsilon)(this.a,t.a,e)}equalsToFloats(t,e,r,i){return this.r===t&&this.g===e&&this.b===r&&this.a===i}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let t=255*this.r|0;return t=397*t^255*this.g,t=397*t^255*this.b,t=397*t^255*this.a,t}clone(){return(new d).copyFrom(this)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}copyFromFloats(t,e,r,i){return this.r=t,this.g=e,this.b=r,this.a=i,this}set(t,e,r,i){return this.copyFromFloats(t,e,r,i)}setAll(t){return this.r=this.g=this.b=this.a=t,this}toHexString(t=!1){const e=Math.round(255*this.r),r=Math.round(255*this.g),i=Math.round(255*this.b);if(t)return"#"+(0,n.ToHex)(e)+(0,n.ToHex)(r)+(0,n.ToHex)(i);const s=Math.round(255*this.a);return"#"+(0,n.ToHex)(e)+(0,n.ToHex)(r)+(0,n.ToHex)(i)+(0,n.ToHex)(s)}fromHexString(t){return"#"!==t.substring(0,1)||9!==t.length&&7!==t.length||(this.r=parseInt(t.substring(1,3),16)/255,this.g=parseInt(t.substring(3,5),16)/255,this.b=parseInt(t.substring(5,7),16)/255,9===t.length&&(this.a=parseInt(t.substring(7,9),16)/255)),this}toLinearSpace(t=!1){const e=new d;return this.toLinearSpaceToRef(e,t),e}toLinearSpaceToRef(t,e=!1){return e?(t.r=o(this.r),t.g=o(this.g),t.b=o(this.b)):(t.r=h(this.r),t.g=h(this.g),t.b=h(this.b)),t.a=this.a,this}toGammaSpace(t=!1){const e=new d;return this.toGammaSpaceToRef(e,t),e}toGammaSpaceToRef(t,e=!1){return e?(t.r=u(this.r),t.g=u(this.g),t.b=u(this.b)):(t.r=l(this.r),t.g=l(this.g),t.b=l(this.b)),t.a=this.a,this}static FromHexString(t){return"#"!==t.substring(0,1)||9!==t.length&&7!==t.length?new d(0,0,0,0):new d(0,0,0,1).fromHexString(t)}static Lerp(t,e,r){return d.LerpToRef(t,e,r,new d)}static LerpToRef(t,e,r,i){return i.r=t.r+(e.r-t.r)*r,i.g=t.g+(e.g-t.g)*r,i.b=t.b+(e.b-t.b)*r,i.a=t.a+(e.a-t.a)*r,i}static Hermite(t,e,r,i,s){const a=s*s,n=s*a,h=2*n-3*a+1,o=-2*n+3*a,l=n-2*a+s,u=n-a,c=t.r*h+r.r*o+e.r*l+i.r*u,_=t.g*h+r.g*o+e.g*l+i.g*u,g=t.b*h+r.b*o+e.b*l+i.b*u,f=t.a*h+r.a*o+e.a*l+i.a*u;return new d(c,_,g,f)}static Hermite1stDerivative(t,e,r,i,s){const a=new d;return this.Hermite1stDerivativeToRef(t,e,r,i,s,a),a}static Hermite1stDerivativeToRef(t,e,r,i,s,a){const n=s*s;a.r=6*(n-s)*t.r+(3*n-4*s+1)*e.r+6*(-n+s)*r.r+(3*n-2*s)*i.r,a.g=6*(n-s)*t.g+(3*n-4*s+1)*e.g+6*(-n+s)*r.g+(3*n-2*s)*i.g,a.b=6*(n-s)*t.b+(3*n-4*s+1)*e.b+6*(-n+s)*r.b+(3*n-2*s)*i.b,a.a=6*(n-s)*t.a+(3*n-4*s+1)*e.a+6*(-n+s)*r.a+(3*n-2*s)*i.a}static FromColor3(t,e=1){return new d(t.r,t.g,t.b,e)}static FromArray(t,e=0){return new d(t[e],t[e+1],t[e+2],t[e+3])}static FromArrayToRef(t,e=0,r){r.r=t[e],r.g=t[e+1],r.b=t[e+2],r.a=t[e+3]}static FromInts(t,e,r,i){return new d(t/255,e/255,r/255,i/255)}static CheckColors4(t,e){if(t.length===3*e){const e=[];for(let r=0;r<t.length;r+=3){const i=r/3*4;e[i]=t[r],e[i+1]=t[r+1],e[i+2]=t[r+2],e[i+3]=1}return e}return t}}d._V8PerformanceHack=new d(.5,.5,.5,.5),Object.defineProperties(d.prototype,{dimension:{value:[4]},rank:{value:1}});class _{}_.Color3=(0,i.mI)(3,c.Black),_.Color4=(0,i.mI)(3,(()=>new d(0,0,0,0))),(0,s.Y5)("BABYLON.Color3",c),(0,s.Y5)("BABYLON.Color4",d)},22951:(t,e,r)=>{r.d(e,{Z:()=>i});class i{static Eval(t,e){return"true"===(t=t.match(/\([^()]*\)/g)?t.replace(/\([^()]*\)/g,(t=>(t=t.slice(1,t.length-1),i._HandleParenthesisContent(t,e)))):i._HandleParenthesisContent(t,e))||"false"!==t&&i.Eval(t,e)}static _HandleParenthesisContent(t,e){let r;e=e||(t=>"true"===t);const s=t.split("||");for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)){let a=i._SimplifyNegation(s[t].trim());const n=a.split("&&");if(n.length>1)for(let t=0;t<n.length;++t){const s=i._SimplifyNegation(n[t].trim());if(r="true"!==s&&"false"!==s?"!"===s[0]?!e(s.substring(1)):e(s):"true"===s,!r){a="false";break}}if(r||"true"===a){r=!0;break}r="true"!==a&&"false"!==a?"!"===a[0]?!e(a.substring(1)):e(a):"true"===a}return r?"true":"false"}static _SimplifyNegation(t){return"!true"===(t=(t=t.replace(/^[\s!]+/,(t=>(t=t.replace(/[\s]/g,(()=>""))).length%2?"!":""))).trim())?t="false":"!false"===t&&(t="true"),t}}},27216:(t,e,r)=>{r.d(e,{Z:()=>s});var i=r(34991);class s{constructor(t,e,r,s){this.normal=new i.Pq(t,e,r),this.d=s}asArray(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}clone(){return new s(this.normal.x,this.normal.y,this.normal.z,this.d)}getClassName(){return"Plane"}getHashCode(){let t=this.normal.getHashCode();return t=397*t^this.d,t}normalize(){const t=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z);let e=0;return 0!==t&&(e=1/t),this.normal.x*=e,this.normal.y*=e,this.normal.z*=e,this.d*=e,this}transform(t){const e=s._TmpMatrix;t.invertToRef(e);const r=e.m,i=this.normal.x,a=this.normal.y,n=this.normal.z,h=this.d,o=i*r[0]+a*r[1]+n*r[2]+h*r[3],l=i*r[4]+a*r[5]+n*r[6]+h*r[7],u=i*r[8]+a*r[9]+n*r[10]+h*r[11],c=i*r[12]+a*r[13]+n*r[14]+h*r[15];return new s(o,l,u,c)}dotCoordinate(t){return this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z+this.d}copyFromPoints(t,e,r){const i=e.x-t.x,s=e.y-t.y,a=e.z-t.z,n=r.x-t.x,h=r.y-t.y,o=r.z-t.z,l=s*o-a*h,u=a*n-i*o,c=i*h-s*n,d=Math.sqrt(l*l+u*u+c*c);let _;return _=0!==d?1/d:0,this.normal.x=l*_,this.normal.y=u*_,this.normal.z=c*_,this.d=-(this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z),this}isFrontFacingTo(t,e){return i.Pq.Dot(this.normal,t)<=e}signedDistanceTo(t){return i.Pq.Dot(t,this.normal)+this.d}static FromArray(t){return new s(t[0],t[1],t[2],t[3])}static FromPoints(t,e,r){const i=new s(0,0,0,0);return i.copyFromPoints(t,e,r),i}static FromPositionAndNormal(t,e){const r=new s(0,0,0,0);return this.FromPositionAndNormalToRef(t,e,r)}static FromPositionAndNormalToRef(t,e,r){return r.normal.copyFrom(e),r.normal.normalize(),r.d=-t.dot(r.normal),r}static SignedDistanceToPlaneFromPositionAndNormal(t,e,r){const s=-(e.x*t.x+e.y*t.y+e.z*t.z);return i.Pq.Dot(r,e)+s}}s._TmpMatrix=i.uq.Identity()},44556:(t,e,r)=>{r.d(e,{B:()=>a,K:()=>n});const i={},s={};function a(t){const e=t.getClassName();return s[e]||(s[e]={}),s[e]}function n(t){const e=t.getClassName();if(i[e])return i[e];i[e]={};const r=i[e];let a=t,n=e;for(;n;){const t=s[n];for(const e in t)r[e]=t[e];let e,i=!1;do{if(e=Object.getPrototypeOf(a),!e.getClassName){i=!0;break}if(e.getClassName()!==n)break;a=e}while(e);if(i)break;n=e.getClassName(),a=e}return r}},56301:(t,e,r)=>{r.d(e,{o:()=>i});class i{constructor(t,e){this.width=t,this.height=e}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let t=0|this.width;return t=397*t^this.height,t}copyFrom(t){this.width=t.width,this.height=t.height}copyFromFloats(t,e){return this.width=t,this.height=e,this}set(t,e){return this.copyFromFloats(t,e)}multiplyByFloats(t,e){return new i(this.width*t,this.height*e)}clone(){return new i(this.width,this.height)}equals(t){return!!t&&this.width===t.width&&this.height===t.height}get surface(){return this.width*this.height}static Zero(){return new i(0,0)}add(t){return new i(this.width+t.width,this.height+t.height)}subtract(t){return new i(this.width-t.width,this.height-t.height)}scale(t){return new i(this.width*t,this.height*t)}static Lerp(t,e,r){const s=t.width+(e.width-t.width)*r,a=t.height+(e.height-t.height)*r;return new i(s,a)}}},81036:(t,e,r)=>{r.d(e,{Y:()=>s});var i=r(22951);class s{static EnableFor(t){t._tags=t._tags||{},t.hasTags=()=>s.HasTags(t),t.addTags=e=>s.AddTagsTo(t,e),t.removeTags=e=>s.RemoveTagsFrom(t,e),t.matchesTagsQuery=e=>s.MatchesQuery(t,e)}static DisableFor(t){delete t._tags,delete t.hasTags,delete t.addTags,delete t.removeTags,delete t.matchesTagsQuery}static HasTags(t){if(!t._tags)return!1;const e=t._tags;for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!0;return!1}static GetTags(t,e=!0){if(!t._tags)return null;if(e){const e=[];for(const r in t._tags)Object.prototype.hasOwnProperty.call(t._tags,r)&&!0===t._tags[r]&&e.push(r);return e.join(" ")}return t._tags}static AddTagsTo(t,e){e&&"string"==typeof e&&e.split(" ").forEach((function(e){s._AddTagTo(t,e)}))}static _AddTagTo(t,e){""!==(e=e.trim())&&"true"!==e&&"false"!==e&&(e.match(/[\s]/)||e.match(/^([!]|([|]|[&]){2})/)||(s.EnableFor(t),t._tags[e]=!0))}static RemoveTagsFrom(t,e){if(!s.HasTags(t))return;const r=e.split(" ");for(const e in r)s._RemoveTagFrom(t,r[e])}static _RemoveTagFrom(t,e){delete t._tags[e]}static MatchesQuery(t,e){return void 0===e||(""===e?s.HasTags(t):i.Z.Eval(e,(e=>s.HasTags(t)&&t._tags[e])))}}},94826:(t,e,r)=>{r.d(e,{t:()=>c});var i=r(10136),s=r(7967),a=r(40380),n=r(34991),h=r(44903),o=r(45892),l=(r(64800),r(10460)),u=r(15153);class c extends l.D{set hasAlpha(t){this._hasAlpha!==t&&(this._hasAlpha=t,this._scene&&this._scene.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this))))}get hasAlpha(){return this._hasAlpha}set getAlphaFromRGB(t){this._getAlphaFromRGB!==t&&(this._getAlphaFromRGB=t,this._scene&&this._scene.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(t){this._coordinatesIndex!==t&&(this._coordinatesIndex=t,this._scene&&this._scene.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(t){this._coordinatesMode!==t&&(this._coordinatesMode=t,this._scene&&this._scene.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(t){this._wrapU=t}get wrapV(){return this._wrapV}set wrapV(t){this._wrapV=t}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(t){this._texture?this._texture.isCube=t:this._isCube=t}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(t){this._texture&&(this._texture.is3D=t)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(t){this._texture&&(this._texture.is2DArray=t)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(t){if(this._texture){if(this._texture._gammaSpace===t)return;this._texture._gammaSpace=t}else{if(this._gammaSpace===t)return;this._gammaSpace=t}this.getScene()?.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(t){t!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=t),this.getScene()?.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(t){this._texture&&(this._texture._lodGenerationOffset=t)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(t){this._texture&&(this._texture._lodGenerationScale=t)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(t){this._texture&&(this._texture._linearSpecularLOD=t)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(t){this._texture&&(this._texture._irradianceTexture=t)}get uid(){return this._uid||(this._uid=(0,o.z)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(t,e=null){super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=c.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.onDisposeObservable=new a.cP,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,t?c._IsScene(t)?this._scene=t:this._engine=t:this._scene=h.q.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=e,this._uid=null}getScene(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return n.uq.IdentityReadOnly}getReflectionTextureMatrix(){return n.uq.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(t){}get canRescale(){return!1}_getFromCache(t,e,r,i,s,a){const n=this._getEngine();if(!n)return null;const h=n._getUseSRGBBuffer(!!s,e),o=n.getLoadedTexturesCache();for(let n=0;n<o.length;n++){const l=o[n];if(!(void 0!==s&&h!==l._useSRGBBuffer||void 0!==i&&i!==l.invertY||l.url!==t||l.generateMipMaps!==!e||r&&r!==l.samplingMode||void 0!==a&&a!==l.isCube))return l.incrementReferences(),l}return null}_rebuild(t=!1){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const t=this.getScene();t&&t.markAllMaterialsAsDirty(1)}readPixels(t=0,e=0,r=null,i=!0,s=!1,a=0,n=0,h=Number.MAX_VALUE,o=Number.MAX_VALUE){if(!this._texture)return null;const l=this._getEngine();if(!l)return null;const u=this.getSize();let c=u.width,d=u.height;0!==e&&(c/=Math.pow(2,e),d/=Math.pow(2,e),c=Math.round(c),d=Math.round(d)),h=Math.min(c,h),o=Math.min(d,o);try{return this._texture.isCube?l._readTexturePixels(this._texture,h,o,t,e,r,i,s,a,n):l._readTexturePixels(this._texture,h,o,-1,e,r,i,s,a,n)}catch(t){return null}}_readPixelsSync(t=0,e=0,r=null,i=!0,s=!1){if(!this._texture)return null;const a=this.getSize();let n=a.width,h=a.height;const o=this._getEngine();if(!o)return null;0!=e&&(n/=Math.pow(2,e),h/=Math.pow(2,e),n=Math.round(n),h=Math.round(h));try{return this._texture.isCube?o._readTexturePixelsSync(this._texture,n,h,t,e,r,i,s):o._readTexturePixelsSync(this._texture,n,h,-1,e,r,i,s)}catch(t){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const t=this._scene.textures.indexOf(this);if(t>=0&&this._scene.textures.splice(t,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const t=this._parentContainer.textures.indexOf(this);t>-1&&this._parentContainer.textures.splice(t,1),this._parentContainer=null}}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.metadata=null,super.dispose()}serialize(t=!1){if(!this.name&&!t)return null;const e=u.p.Serialize(this);return u.p.AppendSerializedAnimations(this,e),e}static WhenAllReady(t,e){let r=t.length;if(0!==r)for(let i=0;i<t.length;i++){const s=t[i];if(s.isReady())0==--r&&e();else{const t=s.onLoadObservable;t?t.addOnce((()=>{0==--r&&e()})):0==--r&&e()}}else e()}static _IsScene(t){return"Scene"===t.getClassName()}}c.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,i.Cg)([(0,s.lK)()],c.prototype,"uniqueId",void 0),(0,i.Cg)([(0,s.lK)()],c.prototype,"name",void 0),(0,i.Cg)([(0,s.lK)()],c.prototype,"displayName",void 0),(0,i.Cg)([(0,s.lK)()],c.prototype,"metadata",void 0),(0,i.Cg)([(0,s.lK)("hasAlpha")],c.prototype,"_hasAlpha",void 0),(0,i.Cg)([(0,s.lK)("getAlphaFromRGB")],c.prototype,"_getAlphaFromRGB",void 0),(0,i.Cg)([(0,s.lK)()],c.prototype,"level",void 0),(0,i.Cg)([(0,s.lK)("coordinatesIndex")],c.prototype,"_coordinatesIndex",void 0),(0,i.Cg)([(0,s.lK)()],c.prototype,"optimizeUVAllocation",void 0),(0,i.Cg)([(0,s.lK)("coordinatesMode")],c.prototype,"_coordinatesMode",void 0),(0,i.Cg)([(0,s.lK)()],c.prototype,"wrapU",null),(0,i.Cg)([(0,s.lK)()],c.prototype,"wrapV",null),(0,i.Cg)([(0,s.lK)()],c.prototype,"wrapR",void 0),(0,i.Cg)([(0,s.lK)()],c.prototype,"anisotropicFilteringLevel",void 0),(0,i.Cg)([(0,s.lK)()],c.prototype,"isCube",null),(0,i.Cg)([(0,s.lK)()],c.prototype,"is3D",null),(0,i.Cg)([(0,s.lK)()],c.prototype,"is2DArray",null),(0,i.Cg)([(0,s.lK)()],c.prototype,"gammaSpace",null),(0,i.Cg)([(0,s.lK)()],c.prototype,"invertZ",void 0),(0,i.Cg)([(0,s.lK)()],c.prototype,"lodLevelInAlpha",void 0),(0,i.Cg)([(0,s.lK)()],c.prototype,"lodGenerationOffset",null),(0,i.Cg)([(0,s.lK)()],c.prototype,"lodGenerationScale",null),(0,i.Cg)([(0,s.lK)()],c.prototype,"linearSpecularLOD",null),(0,i.Cg)([(0,s.uM)()],c.prototype,"irradianceTexture",null),(0,i.Cg)([(0,s.lK)()],c.prototype,"isRenderTarget",void 0)}}]);