/*
 *  This file is part of Cosmos Journeyer
 *
 *  Copyright (C) 2024 Barthélemy Paléologue <barth.paleologue@cosmosjourneyer.com>
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Affero General Public License for more details.
 *
 *  You should have received a copy of the GNU Affero General Public License
 *  along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */

"use strict";(globalThis.webpackChunkcosmos_journeyer=globalThis.webpackChunkcosmos_journeyer||[]).push([["2125"],{92771:function(t,e,r){r.d(e,{g:()=>b});var i=r(38562),s=r(13385),a=r(48462),h=r(36801),n=r(48808),o=r(358),l=r(5813),c=r(62474),u=r(35407),d=r(87602),g=r(92507),f=r(19695),_=r(5451),m=r(39219);class b extends n.t{static _CreateVideoTexture(t,e,r,i=!1,s=!1,a=b.TRILINEAR_SAMPLINGMODE,h={},n,o=5){throw(0,l.n)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(t){this._isBlocking=t}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(t,e,r,i,s=b.TRILINEAR_SAMPLINGMODE,h=null,n=null,o=null,l=!1,u,d,g,f,m){let R;super(e),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new a.cP,this._isBlocking=!0,this.name=t||"",this.url=t;let x=!1,p=null,T=!0;"object"==typeof r&&null!==r?(R=r.noMipmap??!1,i=r.invertY??!_.rX,s=r.samplingMode??b.TRILINEAR_SAMPLINGMODE,h=r.onLoad??null,n=r.onError??null,o=r.buffer??null,l=r.deleteBuffer??!1,u=r.format,d=r.mimeType,g=r.loaderOptions,f=r.creationFlags,x=r.useSRGBBuffer??!1,p=r.internalTexture??null,T=r.gammaSpace??T,m=r.forcedExtension??m):R=!!r,this._gammaSpace=T,this._noMipmap=R,this._invertY=void 0===i?!_.rX:i,this._initialSamplingMode=s,this._buffer=o,this._deleteBuffer=l,this._mimeType=d,this._loaderOptions=g,this._creationFlags=f,this._useSRGBBuffer=x,this._forcedExtension=m,void 0!==u&&(this._format=u);const M=this.getScene(),S=this._getEngine();if(!S)return;S.onBeforeTextureInitObservable.notifyObservers(this);const w=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),h&&h(),!this.isBlocking&&M&&M.resetCachedMaterial()},E=(t,e)=>{this._loadingError=!0,this._errorObject={message:t,exception:e},n&&n(t,e),b.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!p){this._delayedOnLoad=w,this._delayedOnError=E;return}if(this._texture=p??this._getFromCache(this.url,R,s,this._invertY,x,this.isCube),this._texture)if(this._texture.isReady)c._.SetImmediate(()=>w());else{const t=this._texture.onLoadedObservable.add(w);this._texture.onErrorObservable.add(e=>{E(e.message,e.exception),this._texture?.onLoadedObservable.remove(t)})}else if(M&&M.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=w,this._delayedOnError=E;else{try{this._texture=S.createTexture(this.url,R,this._invertY,M,s,w,E,this._buffer,void 0,this._format,this._forcedExtension,d,g,f,x)}catch(t){throw E("error loading",t),t}l&&(this._buffer=null)}}updateURL(t,e=null,r,i){this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(1,t=>t.hasTexture(this))),(!this.name||this.name.startsWith("data:"))&&(this.name=t),this.url=t,this._buffer=e,this._forcedExtension=i,this.delayLoadState=4,r&&(this._delayedOnLoad=r),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;let t=this.getScene();t&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?c._.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=t.getEngine().createTexture(this.url,this._noMipmap,this._invertY,t,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(t,e,r,i){t*=this._cachedUScale,e*=this._cachedVScale,t-=this.uRotationCenter*this._cachedUScale,e-=this.vRotationCenter*this._cachedVScale,r-=this.wRotationCenter,h.Pq.TransformCoordinatesFromFloatsToRef(t,e,r,this._rowGenerationMatrix,i),i.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,i.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,i.z+=this.wRotationCenter}getTextureMatrix(t=1){if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*t===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*t,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=h.uq.Zero(),this._rowGenerationMatrix=new h.uq,this._t0=h.Pq.Zero(),this._t1=h.Pq.Zero(),this._t2=h.Pq.Zero()),h.uq.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(h.uq.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,h.AA.Matrix["0"]),h.uq.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,h.AA.Matrix["1"]),h.uq.ScalingToRef(this._cachedUScale,this._cachedVScale,0,h.AA.Matrix["2"]),h.uq.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,h.AA.Matrix["3"]),h.AA.Matrix["0"].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(h.AA.Matrix["1"],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(h.AA.Matrix["2"],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(h.AA.Matrix["3"],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),h.uq.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));let e=this.getScene();if(!e)return this._cachedTextureMatrix;let r=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&r!==this._cachedIdentity3x2&&e.markAllMaterialsAsDirty(1,t=>t.hasTexture(this)),this._cachedTextureMatrix}getReflectionTextureMatrix(){let t=this.getScene();if(!t)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==b.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;else if(this._cachedReflectionProjectionMatrixId===t.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=h.uq.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=h.uq.Zero());let e=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case b.PLANAR_MODE:h.uq.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case b.PROJECTION_MODE:{h.uq.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);let e=t.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=e.updateFlag,e.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:h.uq.IdentityToRef(this._cachedReflectionTextureMatrix)}return e&&t.markAllMaterialsAsDirty(1,t=>t.hasTexture(this)),this._cachedReflectionTextureMatrix}clone(){let t={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,onLoad:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return m.p.Clone(()=>new b(this._texture?this._texture.url:null,this.getScene(),t),this)}serialize(){let t=this.name;!b.SerializeBuffers&&this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");let e=super.serialize(b._SerializeInternalTextureUniqueId);if(!e)return null;if(b.SerializeBuffers||b.ForceSerializeBuffers)if("string"==typeof this._buffer&&this._buffer.startsWith("data:"))e.base64String=this._buffer,e.name=e.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){let t=this.mimeType||"image/png";e.base64String=`data:${t};base64,${(0,g.EL)(this._buffer)}`}else(b.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(e.base64String=!this._engine||this._engine._features.supportSyncTextureRead?(0,f.lP)(this):(0,f.nh)(this));return e.invertY=this._invertY,e.samplingMode=this.samplingMode,e._creationFlags=this._creationFlags,e._useSRGBBuffer=this._useSRGBBuffer,b._SerializeInternalTextureUniqueId&&(e.internalTextureUniqueId=this._texture?.uniqueId),e.internalTextureLabel=this._texture?.label,e.noMipmap=this._noMipmap,this.name=t,e}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(t,e,r){let i;if(t.customType){let i=u.n.Instantiate(t.customType).Parse(t,e,r);return t.samplingMode&&i.updateSamplingMode&&i._samplingMode&&i._samplingMode!==t.samplingMode&&i.updateSamplingMode(t.samplingMode),i}if(t.isCube&&!t.isRenderTarget)return b._CubeTextureParser(t,e,r);let s=void 0!==t.internalTextureUniqueId;if(!t.name&&!t.isRenderTarget&&!s)return null;if(s){for(let r of e.getEngine().getLoadedTexturesCache())if(r.uniqueId===t.internalTextureUniqueId){i=r;break}}let a=e=>{if(e&&e._texture&&(e._texture._cachedWrapU=null,e._texture._cachedWrapV=null,e._texture._cachedWrapR=null),t.samplingMode){let r=t.samplingMode;e&&e.samplingMode!==r&&e.updateSamplingMode(r)}if(e&&t.animations)for(let r=0;r<t.animations.length;r++){let i=t.animations[r],s=(0,o.n9)("BABYLON.Animation");s&&e.animations.push(s.Parse(i))}e&&e._texture&&(s&&!i&&e._texture._setUniqueId(t.internalTextureUniqueId),e._texture.label=t.internalTextureLabel)};return m.p.Parse(()=>{let s=!0;if(t.noMipmap&&(s=!1),t.mirrorPlane){let r=b._CreateMirror(t.name,t.renderTargetSize,e,s);return r._waitingRenderList=t.renderList,r.mirrorPlane=d.Z.FromArray(t.mirrorPlane),a(r),r}if(t.isRenderTarget&&!t.base64String){let r=null;if(t.isCube){if(e.reflectionProbes)for(let r=0;r<e.reflectionProbes.length;r++){let i=e.reflectionProbes[r];if(i.name===t.name)return i.cubeTexture}}else(r=b._CreateRenderTargetTexture(t.name,t.renderTargetSize,e,s,t._creationFlags??0))._waitingRenderList=t.renderList;return a(r),r}if(t.isVideo){let i=b._CreateVideoTexture(r+(t.url||t.name),r+(t.src||t.url),e,s,t.invertY,t.samplingMode,t.settings||{});return a(i),i}{let h;if(t.base64String&&!i)(h=b.CreateFromBase64String(t.base64String,t.base64String,e,!s,t.invertY,t.samplingMode,()=>{a(h)},t._creationFlags??0,t._useSRGBBuffer??!1)).name=t.name;else{let n;n=t.name&&(t.name.indexOf("://")>0||t.name.startsWith("data:"))?t.name:r+t.name,t.url&&(t.url.startsWith("data:")||b.UseSerializedUrlIfAny)&&(n=t.url),h=new b(n,e,{noMipmap:!s,invertY:t.invertY,samplingMode:t.samplingMode,onLoad:()=>{a(h)},internalTexture:i})}return h}},t,e)}static CreateFromBase64String(t,e,r,i,s,a=b.TRILINEAR_SAMPLINGMODE,h=null,n=null,o=5,l,c){return new b("data:"+e,r,i,s,a,h,n,t,!1,o,void 0,void 0,l,c)}static LoadFromDataString(t,e,r,i=!1,s,a=!0,h=b.TRILINEAR_SAMPLINGMODE,n=null,o=null,l=5,c,u){return"data:"!==t.substring(0,5)&&(t="data:"+t),new b(t,r,s,a,h,n,o,e,i,l,void 0,void 0,c,u)}}b.SerializeBuffers=!0,b.ForceSerializeBuffers=!1,b.OnTextureLoadErrorObservable=new a.cP,b._SerializeInternalTextureUniqueId=!1,b._CubeTextureParser=(t,e,r)=>{throw(0,l.n)("CubeTexture")},b._CreateMirror=(t,e,r,i)=>{throw(0,l.n)("MirrorTexture")},b._CreateRenderTargetTexture=(t,e,r,i,s)=>{throw(0,l.n)("RenderTargetTexture")},b.NEAREST_SAMPLINGMODE=1,b.NEAREST_NEAREST_MIPLINEAR=8,b.BILINEAR_SAMPLINGMODE=2,b.LINEAR_LINEAR_MIPNEAREST=11,b.TRILINEAR_SAMPLINGMODE=3,b.LINEAR_LINEAR_MIPLINEAR=3,b.NEAREST_NEAREST_MIPNEAREST=4,b.NEAREST_LINEAR_MIPNEAREST=5,b.NEAREST_LINEAR_MIPLINEAR=6,b.NEAREST_LINEAR=7,b.NEAREST_NEAREST=1,b.LINEAR_NEAREST_MIPNEAREST=9,b.LINEAR_NEAREST_MIPLINEAR=10,b.LINEAR_LINEAR=2,b.LINEAR_NEAREST=12,b.EXPLICIT_MODE=0,b.SPHERICAL_MODE=1,b.PLANAR_MODE=2,b.CUBIC_MODE=3,b.PROJECTION_MODE=4,b.SKYBOX_MODE=5,b.INVCUBIC_MODE=6,b.EQUIRECTANGULAR_MODE=7,b.FIXED_EQUIRECTANGULAR_MODE=8,b.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,b.CLAMP_ADDRESSMODE=0,b.WRAP_ADDRESSMODE=1,b.MIRROR_ADDRESSMODE=2,b.UseSerializedUrlIfAny=!1,(0,i.Cg)([(0,s.lK)()],b.prototype,"url",void 0),(0,i.Cg)([(0,s.lK)()],b.prototype,"uOffset",void 0),(0,i.Cg)([(0,s.lK)()],b.prototype,"vOffset",void 0),(0,i.Cg)([(0,s.lK)()],b.prototype,"uScale",void 0),(0,i.Cg)([(0,s.lK)()],b.prototype,"vScale",void 0),(0,i.Cg)([(0,s.lK)()],b.prototype,"uAng",void 0),(0,i.Cg)([(0,s.lK)()],b.prototype,"vAng",void 0),(0,i.Cg)([(0,s.lK)()],b.prototype,"wAng",void 0),(0,i.Cg)([(0,s.lK)()],b.prototype,"uRotationCenter",void 0),(0,i.Cg)([(0,s.lK)()],b.prototype,"vRotationCenter",void 0),(0,i.Cg)([(0,s.lK)()],b.prototype,"wRotationCenter",void 0),(0,i.Cg)([(0,s.lK)()],b.prototype,"homogeneousRotationInUVTransform",void 0),(0,i.Cg)([(0,s.lK)()],b.prototype,"isBlocking",null),(0,o.Y5)("BABYLON.Texture",b),m.p._TextureParser=b.Parse},28995:function(t,e,r){r.d(e,{IG:()=>g,ov:()=>d,v9:()=>u});var i=r(33231),s=r(358),a=r(77281),h=r(14265);function n(t){return Math.pow(t,a.tk)}function o(t){return t<=.04045?.0773993808*t:Math.pow(.947867299*(t+.055),2.4)}function l(t){return Math.pow(t,a.rv)}function c(t){return t<=.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class u{constructor(t=0,e=0,r=0){this.r=t,this.g=e,this.b=r}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let t=255*this.r|0;return 397*(t=397*t^(255*this.g|0))^(255*this.b|0)}toArray(t,e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,this}fromArray(t,e=0){return u.FromArrayToRef(t,e,this),this}toColor4(t=1){return new d(this.r,this.g,this.b,t)}asArray(){return[this.r,this.g,this.b]}toLuminance(){return .3*this.r+.59*this.g+.11*this.b}multiply(t){return new u(this.r*t.r,this.g*t.g,this.b*t.b)}multiplyToRef(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,e}multiplyInPlace(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyByFloats(t,e,r){return new u(this.r*t,this.g*e,this.b*r)}divide(t){throw ReferenceError("Can not divide a color")}divideToRef(t,e){throw ReferenceError("Can not divide a color")}divideInPlace(t){throw ReferenceError("Can not divide a color")}minimizeInPlace(t){return this.minimizeInPlaceFromFloats(t.r,t.g,t.b)}maximizeInPlace(t){return this.maximizeInPlaceFromFloats(t.r,t.g,t.b)}minimizeInPlaceFromFloats(t,e,r){return this.r=Math.min(t,this.r),this.g=Math.min(e,this.g),this.b=Math.min(r,this.b),this}maximizeInPlaceFromFloats(t,e,r){return this.r=Math.max(t,this.r),this.g=Math.max(e,this.g),this.b=Math.max(r,this.b),this}floorToRef(t){throw ReferenceError("Can not floor a color")}floor(){throw ReferenceError("Can not floor a color")}fractToRef(t){throw ReferenceError("Can not fract a color")}fract(){throw ReferenceError("Can not fract a color")}equals(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b}equalsFloats(t,e,r){return this.equalsToFloats(t,e,r)}equalsToFloats(t,e,r){return this.r===t&&this.g===e&&this.b===r}equalsWithEpsilon(t,e=a.bH){return(0,h.WithinEpsilon)(this.r,t.r,e)&&(0,h.WithinEpsilon)(this.g,t.g,e)&&(0,h.WithinEpsilon)(this.b,t.b,e)}negate(){throw ReferenceError("Can not negate a color")}negateInPlace(){throw ReferenceError("Can not negate a color")}negateToRef(t){throw ReferenceError("Can not negate a color")}scale(t){return new u(this.r*t,this.g*t,this.b*t)}scaleInPlace(t){return this.r*=t,this.g*=t,this.b*=t,this}scaleToRef(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e}scaleAndAddToRef(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,e}clampToRef(t=0,e=1,r){return r.r=(0,h.Clamp)(this.r,t,e),r.g=(0,h.Clamp)(this.g,t,e),r.b=(0,h.Clamp)(this.b,t,e),r}add(t){return new u(this.r+t.r,this.g+t.g,this.b+t.b)}addInPlace(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addInPlaceFromFloats(t,e,r){return this.r+=t,this.g+=e,this.b+=r,this}addToRef(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,e}subtract(t){return new u(this.r-t.r,this.g-t.g,this.b-t.b)}subtractToRef(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e}subtractInPlace(t){return this.r-=t.r,this.g-=t.g,this.b-=t.b,this}subtractFromFloats(t,e,r){return new u(this.r-t,this.g-e,this.b-r)}subtractFromFloatsToRef(t,e,r,i){return i.r=this.r-t,i.g=this.g-e,i.b=this.b-r,i}clone(){return new u(this.r,this.g,this.b)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyFromFloats(t,e,r){return this.r=t,this.g=e,this.b=r,this}set(t,e,r){return this.copyFromFloats(t,e,r)}setAll(t){return this.r=this.g=this.b=t,this}toHexString(){let t=Math.round(255*this.r),e=Math.round(255*this.g),r=Math.round(255*this.b);return"#"+(0,h.ToHex)(t)+(0,h.ToHex)(e)+(0,h.ToHex)(r)}fromHexString(t){return"#"!==t.substring(0,1)||7!==t.length||(this.r=parseInt(t.substring(1,3),16)/255,this.g=parseInt(t.substring(3,5),16)/255,this.b=parseInt(t.substring(5,7),16)/255),this}toHSV(){return this.toHSVToRef(new u)}toHSVToRef(t){let e=this.r,r=this.g,i=this.b,s=Math.max(e,r,i),a=Math.min(e,r,i),h=0,n=0,o=s-a;return 0!==s&&(n=o/s),s!=a&&(s==e?(h=(r-i)/o,r<i&&(h+=6)):s==r?h=(i-e)/o+2:s==i&&(h=(e-r)/o+4),h*=60),t.r=h,t.g=n,t.b=s,t}toLinearSpace(t=!1){let e=new u;return this.toLinearSpaceToRef(e,t),e}toLinearSpaceToRef(t,e=!1){return e?(t.r=o(this.r),t.g=o(this.g),t.b=o(this.b)):(t.r=n(this.r),t.g=n(this.g),t.b=n(this.b)),this}toGammaSpace(t=!1){let e=new u;return this.toGammaSpaceToRef(e,t),e}toGammaSpaceToRef(t,e=!1){return e?(t.r=c(this.r),t.g=c(this.g),t.b=c(this.b)):(t.r=l(this.r),t.g=l(this.g),t.b=l(this.b)),this}static HSVtoRGBToRef(t,e,r,i){let s=r*e,a=t/60,h=s*(1-Math.abs(a%2-1)),n=0,o=0,l=0;a>=0&&a<=1?(n=s,o=h):a>=1&&a<=2?(n=h,o=s):a>=2&&a<=3?(o=s,l=h):a>=3&&a<=4?(o=h,l=s):a>=4&&a<=5?(n=h,l=s):a>=5&&a<=6&&(n=s,l=h);let c=r-s;return i.r=n+c,i.g=o+c,i.b=l+c,i}static FromHSV(t,e,r){let i=new u(0,0,0);return u.HSVtoRGBToRef(t,e,r,i),i}static FromHexString(t){return new u(0,0,0).fromHexString(t)}static FromArray(t,e=0){return new u(t[e],t[e+1],t[e+2])}static FromArrayToRef(t,e=0,r){r.r=t[e],r.g=t[e+1],r.b=t[e+2]}static FromInts(t,e,r){return new u(t/255,e/255,r/255)}static Lerp(t,e,r){let i=new u(0,0,0);return u.LerpToRef(t,e,r,i),i}static LerpToRef(t,e,r,i){i.r=t.r+(e.r-t.r)*r,i.g=t.g+(e.g-t.g)*r,i.b=t.b+(e.b-t.b)*r}static Hermite(t,e,r,i,s){let a=s*s,h=s*a,n=2*h-3*a+1,o=-2*h+3*a,l=h-2*a+s,c=h-a;return new u(t.r*n+r.r*o+e.r*l+i.r*c,t.g*n+r.g*o+e.g*l+i.g*c,t.b*n+r.b*o+e.b*l+i.b*c)}static Hermite1stDerivative(t,e,r,i,s){let a=u.Black();return this.Hermite1stDerivativeToRef(t,e,r,i,s,a),a}static Hermite1stDerivativeToRef(t,e,r,i,s,a){let h=s*s;a.r=(h-s)*6*t.r+(3*h-4*s+1)*e.r+(-h+s)*6*r.r+(3*h-2*s)*i.r,a.g=(h-s)*6*t.g+(3*h-4*s+1)*e.g+(-h+s)*6*r.g+(3*h-2*s)*i.g,a.b=(h-s)*6*t.b+(3*h-4*s+1)*e.b+(-h+s)*6*r.b+(3*h-2*s)*i.b}static Red(){return new u(1,0,0)}static Green(){return new u(0,1,0)}static Blue(){return new u(0,0,1)}static Black(){return new u(0,0,0)}static get BlackReadOnly(){return u._BlackReadOnly}static White(){return new u(1,1,1)}static Purple(){return new u(.5,0,.5)}static Magenta(){return new u(1,0,1)}static Yellow(){return new u(1,1,0)}static Gray(){return new u(.5,.5,.5)}static Teal(){return new u(0,1,1)}static Random(){return new u(Math.random(),Math.random(),Math.random())}}u._V8PerformanceHack=new u(.5,.5,.5),u._BlackReadOnly=u.Black(),Object.defineProperties(u.prototype,{dimension:{value:[3]},rank:{value:1}});class d{constructor(t=0,e=0,r=0,i=1){this.r=t,this.g=e,this.b=r,this.a=i}asArray(){return[this.r,this.g,this.b,this.a]}toArray(t,e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t[e+3]=this.a,this}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this.a=t[e+3],this}equals(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}add(t){return new d(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}addToRef(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,e.a=this.a+t.a,e}addInPlace(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this}addInPlaceFromFloats(t,e,r,i){return this.r+=t,this.g+=e,this.b+=r,this.a+=i,this}subtract(t){return new d(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}subtractToRef(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e.a=this.a-t.a,e}subtractInPlace(t){return this.r-=t.r,this.g-=t.g,this.b-=t.b,this.a-=t.a,this}subtractFromFloats(t,e,r,i){return new d(this.r-t,this.g-e,this.b-r,this.a-i)}subtractFromFloatsToRef(t,e,r,i,s){return s.r=this.r-t,s.g=this.g-e,s.b=this.b-r,s.a=this.a-i,s}scale(t){return new d(this.r*t,this.g*t,this.b*t,this.a*t)}scaleInPlace(t){return this.r*=t,this.g*=t,this.b*=t,this.a*=t,this}scaleToRef(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e.a=this.a*t,e}scaleAndAddToRef(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,e.a+=this.a*t,e}clampToRef(t=0,e=1,r){return r.r=(0,h.Clamp)(this.r,t,e),r.g=(0,h.Clamp)(this.g,t,e),r.b=(0,h.Clamp)(this.b,t,e),r.a=(0,h.Clamp)(this.a,t,e),r}multiply(t){return new d(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a)}multiplyToRef(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,e.a=this.a*t.a,e}multiplyInPlace(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this.a*=t.a,this}multiplyByFloats(t,e,r,i){return new d(this.r*t,this.g*e,this.b*r,this.a*i)}divide(t){throw ReferenceError("Can not divide a color")}divideToRef(t,e){throw ReferenceError("Can not divide a color")}divideInPlace(t){throw ReferenceError("Can not divide a color")}minimizeInPlace(t){return this.r=Math.min(this.r,t.r),this.g=Math.min(this.g,t.g),this.b=Math.min(this.b,t.b),this.a=Math.min(this.a,t.a),this}maximizeInPlace(t){return this.r=Math.max(this.r,t.r),this.g=Math.max(this.g,t.g),this.b=Math.max(this.b,t.b),this.a=Math.max(this.a,t.a),this}minimizeInPlaceFromFloats(t,e,r,i){return this.r=Math.min(t,this.r),this.g=Math.min(e,this.g),this.b=Math.min(r,this.b),this.a=Math.min(i,this.a),this}maximizeInPlaceFromFloats(t,e,r,i){return this.r=Math.max(t,this.r),this.g=Math.max(e,this.g),this.b=Math.max(r,this.b),this.a=Math.max(i,this.a),this}floorToRef(t){throw ReferenceError("Can not floor a color")}floor(){throw ReferenceError("Can not floor a color")}fractToRef(t){throw ReferenceError("Can not fract a color")}fract(){throw ReferenceError("Can not fract a color")}negate(){throw ReferenceError("Can not negate a color")}negateInPlace(){throw ReferenceError("Can not negate a color")}negateToRef(t){throw ReferenceError("Can not negate a color")}equalsWithEpsilon(t,e=a.bH){return(0,h.WithinEpsilon)(this.r,t.r,e)&&(0,h.WithinEpsilon)(this.g,t.g,e)&&(0,h.WithinEpsilon)(this.b,t.b,e)&&(0,h.WithinEpsilon)(this.a,t.a,e)}equalsToFloats(t,e,r,i){return this.r===t&&this.g===e&&this.b===r&&this.a===i}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let t=255*this.r|0;return 397*(t=397*(t=397*t^(255*this.g|0))^(255*this.b|0))^(255*this.a|0)}clone(){return new d().copyFrom(this)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}copyFromFloats(t,e,r,i){return this.r=t,this.g=e,this.b=r,this.a=i,this}set(t,e,r,i){return this.copyFromFloats(t,e,r,i)}setAll(t){return this.r=this.g=this.b=this.a=t,this}toHexString(t=!1){let e=Math.round(255*this.r),r=Math.round(255*this.g),i=Math.round(255*this.b);if(t)return"#"+(0,h.ToHex)(e)+(0,h.ToHex)(r)+(0,h.ToHex)(i);let s=Math.round(255*this.a);return"#"+(0,h.ToHex)(e)+(0,h.ToHex)(r)+(0,h.ToHex)(i)+(0,h.ToHex)(s)}fromHexString(t){return"#"!==t.substring(0,1)||9!==t.length&&7!==t.length||(this.r=parseInt(t.substring(1,3),16)/255,this.g=parseInt(t.substring(3,5),16)/255,this.b=parseInt(t.substring(5,7),16)/255,9===t.length&&(this.a=parseInt(t.substring(7,9),16)/255)),this}toLinearSpace(t=!1){let e=new d;return this.toLinearSpaceToRef(e,t),e}toLinearSpaceToRef(t,e=!1){return e?(t.r=o(this.r),t.g=o(this.g),t.b=o(this.b)):(t.r=n(this.r),t.g=n(this.g),t.b=n(this.b)),t.a=this.a,this}toGammaSpace(t=!1){let e=new d;return this.toGammaSpaceToRef(e,t),e}toGammaSpaceToRef(t,e=!1){return e?(t.r=c(this.r),t.g=c(this.g),t.b=c(this.b)):(t.r=l(this.r),t.g=l(this.g),t.b=l(this.b)),t.a=this.a,this}static FromHexString(t){return"#"!==t.substring(0,1)||9!==t.length&&7!==t.length?new d(0,0,0,0):new d(0,0,0,1).fromHexString(t)}static Lerp(t,e,r){return d.LerpToRef(t,e,r,new d)}static LerpToRef(t,e,r,i){return i.r=t.r+(e.r-t.r)*r,i.g=t.g+(e.g-t.g)*r,i.b=t.b+(e.b-t.b)*r,i.a=t.a+(e.a-t.a)*r,i}static Hermite(t,e,r,i,s){let a=s*s,h=s*a,n=2*h-3*a+1,o=-2*h+3*a,l=h-2*a+s,c=h-a;return new d(t.r*n+r.r*o+e.r*l+i.r*c,t.g*n+r.g*o+e.g*l+i.g*c,t.b*n+r.b*o+e.b*l+i.b*c,t.a*n+r.a*o+e.a*l+i.a*c)}static Hermite1stDerivative(t,e,r,i,s){let a=new d;return this.Hermite1stDerivativeToRef(t,e,r,i,s,a),a}static Hermite1stDerivativeToRef(t,e,r,i,s,a){let h=s*s;a.r=(h-s)*6*t.r+(3*h-4*s+1)*e.r+(-h+s)*6*r.r+(3*h-2*s)*i.r,a.g=(h-s)*6*t.g+(3*h-4*s+1)*e.g+(-h+s)*6*r.g+(3*h-2*s)*i.g,a.b=(h-s)*6*t.b+(3*h-4*s+1)*e.b+(-h+s)*6*r.b+(3*h-2*s)*i.b,a.a=(h-s)*6*t.a+(3*h-4*s+1)*e.a+(-h+s)*6*r.a+(3*h-2*s)*i.a}static FromColor3(t,e=1){return new d(t.r,t.g,t.b,e)}static FromArray(t,e=0){return new d(t[e],t[e+1],t[e+2],t[e+3])}static FromArrayToRef(t,e=0,r){r.r=t[e],r.g=t[e+1],r.b=t[e+2],r.a=t[e+3]}static FromInts(t,e,r,i){return new d(t/255,e/255,r/255,i/255)}static CheckColors4(t,e){if(t.length===3*e){let e=[];for(let r=0;r<t.length;r+=3){let i=r/3*4;e[i]=t[r],e[i+1]=t[r+1],e[i+2]=t[r+2],e[i+3]=1}return e}return t}}d._V8PerformanceHack=new d(.5,.5,.5,.5),Object.defineProperties(d.prototype,{dimension:{value:[4]},rank:{value:1}});class g{}g.Color3=(0,i.mI)(3,u.Black),g.Color4=(0,i.mI)(3,()=>new d(0,0,0,0)),(0,s.Y5)("BABYLON.Color3",u),(0,s.Y5)("BABYLON.Color4",d)},87602:function(t,e,r){r.d(e,{Z:()=>s});var i=r(36801);class s{constructor(t,e,r,s){this.normal=new i.Pq(t,e,r),this.d=s}asArray(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}clone(){return new s(this.normal.x,this.normal.y,this.normal.z,this.d)}getClassName(){return"Plane"}getHashCode(){let t=this.normal.getHashCode();return 397*t^(0|this.d)}normalize(){let t=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),e=0;return 0!==t&&(e=1/t),this.normal.x*=e,this.normal.y*=e,this.normal.z*=e,this.d*=e,this}transform(t){let e=s._TmpMatrix;t.invertToRef(e);let r=e.m,i=this.normal.x,a=this.normal.y,h=this.normal.z,n=this.d;return new s(i*r[0]+a*r[1]+h*r[2]+n*r[3],i*r[4]+a*r[5]+h*r[6]+n*r[7],i*r[8]+a*r[9]+h*r[10]+n*r[11],i*r[12]+a*r[13]+h*r[14]+n*r[15])}dotCoordinate(t){return this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z+this.d}copyFromPoints(t,e,r){let i,s=e.x-t.x,a=e.y-t.y,h=e.z-t.z,n=r.x-t.x,o=r.y-t.y,l=r.z-t.z,c=a*l-h*o,u=h*n-s*l,d=s*o-a*n,g=Math.sqrt(c*c+u*u+d*d);return i=0!==g?1/g:0,this.normal.x=c*i,this.normal.y=u*i,this.normal.z=d*i,this.d=-(this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z),this}isFrontFacingTo(t,e){return i.Pq.Dot(this.normal,t)<=e}signedDistanceTo(t){return i.Pq.Dot(t,this.normal)+this.d}static FromArray(t){return new s(t[0],t[1],t[2],t[3])}static FromPoints(t,e,r){let i=new s(0,0,0,0);return i.copyFromPoints(t,e,r),i}static FromPositionAndNormal(t,e){let r=new s(0,0,0,0);return this.FromPositionAndNormalToRef(t,e,r)}static FromPositionAndNormalToRef(t,e,r){return r.normal.copyFrom(e),r.normal.normalize(),r.d=-t.dot(r.normal),r}static SignedDistanceToPlaneFromPositionAndNormal(t,e,r){let s=-(e.x*t.x+e.y*t.y+e.z*t.z);return i.Pq.Dot(r,e)+s}}s._TmpMatrix=i.uq.Identity()},42079:function(t,e,r){r.d(e,{o:()=>i});class i{constructor(t,e){this.width=t,this.height=e}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let t=0|this.width;return 397*t^(0|this.height)}copyFrom(t){this.width=t.width,this.height=t.height}copyFromFloats(t,e){return this.width=t,this.height=e,this}set(t,e){return this.copyFromFloats(t,e)}multiplyByFloats(t,e){return new i(this.width*t,this.height*e)}clone(){return new i(this.width,this.height)}equals(t){return!!t&&this.width===t.width&&this.height===t.height}get surface(){return this.width*this.height}static Zero(){return new i(0,0)}add(t){return new i(this.width+t.width,this.height+t.height)}subtract(t){return new i(this.width-t.width,this.height-t.height)}scale(t){return new i(this.width*t,this.height*t)}static Lerp(t,e,r){return new i(t.width+(e.width-t.width)*r,t.height+(e.height-t.height)*r)}}},41058:function(t,e,r){r.d(e,{B:()=>a,K:()=>h});let i={},s={};function a(t){let e=t.getClassName();return s[e]||(s[e]={}),s[e]}function h(t){let e=t.getClassName();if(i[e])return i[e];i[e]={};let r=i[e],a=t,h=e;for(;h;){let t,e=s[h];for(let t in e)r[t]=e[t];let i=!1;do{if(!(t=Object.getPrototypeOf(a)).getClassName){i=!0;break}if(t.getClassName()!==h)break;a=t}while(t);if(i)break;h=t.getClassName(),a=t}return r}},38562:function(t,e,r){r.d(e,{Cg:()=>i});function i(t,e,r,i){var s,a=arguments.length,h=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(t,e,r,i);else for(var n=t.length-1;n>=0;n--)(s=t[n])&&(h=(a<3?s(h):a>3?s(e,r,h):s(e,r))||h);return a>3&&h&&Object.defineProperty(e,r,h),h}}}]);