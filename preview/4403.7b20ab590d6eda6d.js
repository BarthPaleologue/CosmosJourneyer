/*
 *  This file is part of Cosmos Journeyer
 *
 *  Copyright (C) 2024 Barthélemy Paléologue <barth.paleologue@cosmosjourneyer.com>
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Affero General Public License for more details.
 *
 *  You should have received a copy of the GNU Affero General Public License
 *  along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */

"use strict";(globalThis.webpackChunk_cosmos_journeyer_game=globalThis.webpackChunk_cosmos_journeyer_game||[]).push([["4403"],{28689:function(e,t,r){r.d(t,{A5:()=>g,C5:()=>p,Cm:()=>l,EX:()=>u,GX:()=>d,N5:()=>s,YM:()=>K,bS:()=>P,kf:()=>c,tI:()=>f,tg:()=>m});var o=r(10439),i=r(892);let a=new WeakMap,n={_webGLVersion:2,cachedPipelines:{}};function s(e){let t=a.get(e);if(!t){if(!e)return n;t={_webGLVersion:e.TEXTURE_BINDING_3D?2:1,_context:e,parallelShaderCompile:e.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},a.set(e,t)}return t}function l(e){a.delete(e)}function c(e,t,r,o,i,a){let n=s(o);return a||(a=n._createShaderProgramInjection??f),a(e,h(t,"vertex",o,n._contextWasLost),h(r,"fragment",o,n._contextWasLost),o,i,n.validateShaderPrograms)}function u(e,t,r,o,i,a=null,n){let l=s(i);n||(n=l._createShaderProgramInjection??f);let c=l._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return n(e,v(t,"vertex",o,c,i,l._contextWasLost),v(r,"fragment",o,c,i,l._contextWasLost),i,a,l.validateShaderPrograms)}function d(e,t){let r=new o.x,i=s(e);return i.parallelShaderCompile&&!i.disableParallelShaderCompile&&(r.isParallelCompiled=!0),r.context=i._context,r}function f(e,t,r,o,i=null,a){let n=o.createProgram();if(e.program=n,!n)throw Error("Unable to create program");return o.attachShader(n,t),o.attachShader(n,r),o.linkProgram(n),e.context=o,e.vertexShader=t,e.fragmentShader=r,e.isParallelCompiled||m(e,o,a),n}function g(e,t,r){if(e._isDisposed)return!1;let o=s(t);return!!(o&&o.parallelShaderCompile&&o.parallelShaderCompile.COMPLETION_STATUS_KHR&&e.program&&t.getProgramParameter(e.program,o.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(m(e,t,r),!0)}function m(e,t,r){let o=e.context,i=e.vertexShader,a=e.fragmentShader,n=e.program;if(!o.getProgramParameter(n,o.LINK_STATUS)){if(!t.getShaderParameter(i,t.COMPILE_STATUS)){let r=t.getShaderInfoLog(i);if(r)throw e.vertexCompilationError=r,Error("VERTEX SHADER "+r)}if(!t.getShaderParameter(a,t.COMPILE_STATUS)){let r=t.getShaderInfoLog(a);if(r)throw e.fragmentCompilationError=r,Error("FRAGMENT SHADER "+r)}let r=o.getProgramInfoLog(n);if(r)throw e.programLinkError=r,Error(r)}if(r&&(o.validateProgram(n),!o.getProgramParameter(n,o.VALIDATE_STATUS))){let t=o.getProgramInfoLog(n);if(t)throw e.programValidationError=t,Error(t)}o.deleteShader(i),o.deleteShader(a),e.vertexShader=void 0,e.fragmentShader=void 0,e.onCompiled&&(e.onCompiled(),e.onCompiled=void 0)}function K(e,t,r,o,i,a,n,l,d,f="",g,m,v){let h=s(e.context);m||(m=h.createRawShaderProgramInjection??c),v||(v=h.createShaderProgramInjection??u),o?e.program=m(e,t,r,e.context,d):e.program=v(e,t,r,l,e.context,d),e.program.__SPECTOR_rebuildProgram=n,g()}function v(e,t,r,o,a,n){return h((0,i.iL)(e,r,o),t,a,n)}function h(e,t,r,o){let i=r.createShader("vertex"===t?r.VERTEX_SHADER:r.FRAGMENT_SHADER);if(!i){let e=r.NO_ERROR,i=r.NO_ERROR;for(;(i=r.getError())!==r.NO_ERROR;)e=i;throw Error(`Something went wrong while creating a gl ${t} shader object. gl error=${e}, gl isContextLost=${r.isContextLost()}, _contextWasLost=${o}`)}return r.shaderSource(i,e),r.compileShader(i),i}function p(e,t){t.useProgram(e)}function P(e,t){if(!e.isParallelCompiled)return void t(e);let r=e.onCompiled;e.onCompiled=()=>{r?.(),t(e)}}},32898:function(e,t,r){r.d(t,{JH:()=>d,b4:()=>c,mO:()=>u,uR:()=>g});var o=r(46703),i=r(28689),a=r(22081),n=r(48766),s=r(90876),l=r(892);function c(e,t){return(0,i.N5)(t).cachedPipelines[e]}function u(e){let t=e._name,r=e.context;if(t&&r){let e=(0,i.N5)(r),o=e.cachedPipelines[t];o?.dispose(),delete e.cachedPipelines[t]}}function d(e,t,r,i,a,n,l){let c,u,d=(0,o.BA)()?n?.getHostDocument():null;c="string"==typeof t?t:t.vertexSource?"source:"+t.vertexSource:t.vertexElement?d?.getElementById(t.vertexElement)||t.vertexElement:t.vertex||t,u="string"==typeof t?t:t.fragmentSource?"source:"+t.fragmentSource:t.fragmentElement?d?.getElementById(t.fragmentElement)||t.fragmentElement:t.fragment||t;let g=[void 0,void 0],m=()=>{if(g[0]&&g[1]){e.isFragment=!0;let[o,c]=g;(0,s.M0)(c,e,(n,c)=>{var u,d,f,g;l&&(l._fragmentSourceCodeBeforeMigration=c),r&&(n=r("fragment",n));let m=(0,s.nO)(o,n,e);e=null;let K=(u=m.vertexCode,d=m.fragmentCode,f=t,g=a,f?{vertexSourceCode:(1===g?"//":"")+"#define SHADER_NAME vertex:"+(f.vertexElement||f.vertex||f.spectorName||f)+"\n"+u,fragmentSourceCode:(1===g?"//":"")+"#define SHADER_NAME fragment:"+(f.fragmentElement||f.fragment||f.spectorName||f)+"\n"+d}:{vertexSourceCode:u,fragmentSourceCode:d});i?.(K.vertexSourceCode,K.fragmentSourceCode)},n)}};f(c,"Vertex","",t=>{(0,s.pB)(e),(0,s.M0)(t,e,(e,o)=>{l&&(l._rawVertexSourceCode=t,l._vertexSourceCodeBeforeMigration=o),r&&(e=r("vertex",e)),g[0]=e,m()},n)},a),f(u,"Fragment","Pixel",e=>{l&&(l._rawFragmentSourceCode=e),g[1]=e,m()},a)}function f(e,t,r,i,n,s){let c;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return void i((0,o.Zl)(e));if("source:"===e.substring(0,7))return void i(e.substring(7));if("base64:"===e.substring(0,7))return void i(window.atob(e.substring(7)));let u=a.l.GetShadersStore(n);if(u[e+t+"Shader"])return void i(u[e+t+"Shader"]);if(r&&u[e+r+"Shader"])return void i(u[e+r+"Shader"]);if(c="."===e[0]||"/"===e[0]||e.indexOf("http")>-1?e:a.l.GetShadersRepository(n)+e,!(s=s||l.sb))throw Error("loadFileInjection is not defined");s(c+"."+t.toLowerCase()+".fx",i)}let g=(e,t,r,o)=>{try{let a=e.context?(0,i.N5)(e.context):null;a&&(a.disableParallelShaderCompile=e.disableParallelCompilation);let n=e.existingPipelineContext||t(e.shaderProcessingContext);return n._name=e.name,e.name&&a&&(a.cachedPipelines[e.name]=n),r(n,e.vertex,e.fragment,!!e.createAsRaw,"","",e.rebuildRebind,e.defines,e.transformFeedbackVaryings,"",()=>{o(n,()=>{e.onRenderingStateCompiled?.(n)})}),n}catch(e){throw n.V.Error("Error compiling effect"),e}}},46703:function(e,t,r){function o(){return"undefined"!=typeof window}function i(){return"undefined"!=typeof navigator}function a(){return"undefined"!=typeof document}function n(e){let t="",r=e.firstChild;for(;r;)3===r.nodeType&&(t+=r.textContent),r=r.nextSibling;return t}r.d(t,{Az:()=>s,BA:()=>o,Nf:()=>a,XD:()=>i,Zl:()=>n});let s={IsWindowObjectExist:o,IsNavigatorAvailable:i,IsDocumentAvailable:a,GetDOMTextContent:n}},45981:function(e,t,r){let o;r.d(t,{M1:()=>C,Mi:()=>P,NJ:()=>T,VB:()=>U,W$:()=>B,ZP:()=>R,dy:()=>j,eC:()=>A,f2:()=>y,hX:()=>p,my:()=>F,ny:()=>S,qc:()=>b,rh:()=>w,rz:()=>x,sh:()=>L,wS:()=>o,zU:()=>E});var i=r(6497),a=r(46703),n=r(97183),s=r(51030),l=r(3311),c=r(93298),u=r(72312),d=r(90876),f=r(63468),g=r(48766),m=r(24825),K=r(892),v=r(66799);let h=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i);class p extends c.bu{constructor(e,t){super(e,c.tG.LoadFileError),this.name="LoadFileError",c.Cf._setPrototypeOf(this,p.prototype),t instanceof i.u?this.request=t:this.file=t}}class P extends c.bu{constructor(e,t){super(e,c.tG.RequestFileError),this.request=t,this.name="RequestFileError",c.Cf._setPrototypeOf(this,P.prototype)}}class U extends c.bu{constructor(e,t){super(e,c.tG.ReadFileError),this.file=t,this.name="ReadFileError",c.Cf._setPrototypeOf(this,U.prototype)}}let A={DefaultRetryStrategy:l.a.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:e=>e,ScriptBaseUrl:"",ScriptPreprocessUrl:e=>e,CleanUrl:e=>e=e.replace(/#/gm,"%23")},C=(e,t)=>{if((!e||0!==e.indexOf("data:"))&&A.CorsBehavior)if("string"==typeof A.CorsBehavior||A.CorsBehavior instanceof String)t.crossOrigin=A.CorsBehavior;else{let r=A.CorsBehavior(e);r&&(t.crossOrigin=r)}},b={getRequiredSize:null},B=(e,t,r,o,a="",n,l=f.q.LastCreatedEngine)=>{let c;if("undefined"==typeof HTMLImageElement&&!l?._features.forceBitmapOverHTMLImageElement)return r("LoadImage is only supported in web or BabylonNative environments."),null;let d=!1;e instanceof ArrayBuffer||ArrayBuffer.isView(e)?"undefined"!=typeof Blob&&"undefined"!=typeof URL?(c=URL.createObjectURL(new Blob([e],{type:a})),d=!0):c=`data:${a};base64,`+(0,u.EL)(e):e instanceof Blob?(c=URL.createObjectURL(e),d=!0):(c=A.CleanUrl(e),c=A.PreprocessUrl(c));let g=t=>{if(r){let o=c||e.toString();r(`Error while trying to load image: ${0===o.indexOf("http")||o.length<=128?o:o.slice(0,128)+"..."}`,t)}};if(l?._features.forceBitmapOverHTMLImageElement)return E(c,o=>{l.createImageBitmap(new Blob([o],{type:a}),{premultiplyAlpha:"none",...n}).then(e=>{t(e),d&&URL.revokeObjectURL(c)}).catch(t=>{r&&r("Error while trying to load image: "+e,t)})},void 0,o||void 0,!0,(e,t)=>{g(t)}),null;let m=new Image;if(b.getRequiredSize){let t=b.getRequiredSize(e);t.width&&(m.width=t.width),t.height&&(m.height=t.height)}C(c,m);let K=[],v=()=>{for(let e of K)e.target.removeEventListener(e.name,e.handler);K.length=0};for(let e of(K.push({target:m,name:"load",handler:()=>{v(),t(m),d&&m.src&&URL.revokeObjectURL(m.src)}}),K.push({target:m,name:"error",handler:e=>{v(),g(e),d&&m.src&&URL.revokeObjectURL(m.src)}}),K.push({target:document,name:"securitypolicyviolation",handler:e=>{if(e.blockedURI!==m.src||"report"===e.disposition)return;v();let t=Error(`CSP violation of policy ${e.effectiveDirective} ${e.blockedURI}. Current policy is ${e.originalPolicy}`);f.q.UseFallbackTexture=!1,g(t),d&&m.src&&URL.revokeObjectURL(m.src),m.src=""}}),K))e.target.addEventListener(e.name,e.handler);let h="blob:"===c.substring(0,5),p="data:"===c.substring(0,5),P=()=>{h||p||!i.u.IsCustomRequestAvailable?m.src=c:E(c,(e,t,r)=>{let o=new Blob([e],{type:!a&&r?r:a}),i=URL.createObjectURL(o);d=!0,m.src=i},void 0,o||void 0,!0,(e,t)=>{g(t)})};if(!h&&!p&&o&&o.enableTexturesOffline)o.open(()=>{o&&o.loadImage(c,m)},P);else{if(-1!==c.indexOf("file:")){let e=decodeURIComponent(c.substring(5).toLowerCase());if(s.T.FilesToLoad[e]&&"undefined"!=typeof URL){try{let t;try{t=URL.createObjectURL(s.T.FilesToLoad[e])}catch(r){t=URL.createObjectURL(s.T.FilesToLoad[e])}m.src=t,d=!0}catch(e){m.src=""}return m}}P()}return m},T=(e,t,r,o,i)=>{let a=new FileReader,s={onCompleteObservable:new n.cP,abort:()=>a.abort()};return a.onloadend=()=>s.onCompleteObservable.notifyObservers(s),i&&(a.onerror=()=>{i(new U(`Unable to read ${e.name}`,e))}),a.onload=e=>{t(e.target.result)},r&&(a.onprogress=r),o?a.readAsArrayBuffer(e):a.readAsText(e),s},E=(e,t,r,o,i,a,l)=>{if(e.name)return T(e,t,r,i,a?e=>{a(void 0,e)}:void 0);if(-1!==e.indexOf("file:")){let o=decodeURIComponent(e.substring(5).toLowerCase());0===o.indexOf("./")&&(o=o.substring(2));let n=s.T.FilesToLoad[o];if(n)return T(n,t,r,i,a?e=>a(void 0,new p(e.message,e.file)):void 0)}let{match:c,type:u}=R(e);if(c){let r={onCompleteObservable:new n.cP,abort:()=>()=>{}};try{let r=i?x(e):j(e);t(r,void 0,u)}catch(e){a?a(void 0,e):g.V.Error(e.message||"Failed to parse the Data URL")}return m._.SetImmediate(()=>{r.onCompleteObservable.notifyObservers(r)}),r}return L(e,(e,r)=>{t(e,r?.responseURL,r?.getResponseHeader("content-type"))},r,o,i,a?e=>{a(e.request,new p(e.message,e.request))}:void 0,l)},L=(e,t,r,o,s,l,c)=>{null!==o&&(o??(o=f.q.LastCreatedScene?.offlineProvider)),e=A.CleanUrl(e),e=A.PreprocessUrl(e);let u=A.BaseUrl+e,d=!1,m={onCompleteObservable:new n.cP,abort:()=>d=!0},K=()=>{let e,o=new i.u,n=null,f=()=>{o&&(r&&o.removeEventListener("progress",r),e&&o.removeEventListener("readystatechange",e),o.removeEventListener("loadend",K))},K=()=>{f(),m.onCompleteObservable.notifyObservers(m),m.onCompleteObservable.clear(),r=void 0,e=null,K=null,l=void 0,c=void 0,t=void 0};m.abort=()=>{d=!0,K&&K(),o&&o.readyState!==(XMLHttpRequest.DONE||4)&&o.abort(),null!==n&&(clearTimeout(n),n=null),o=null};let v=e=>{let t=e.message||"Unknown error";l&&o?l(new P(t,o)):g.V.Error(t)},h=g=>{if(o){if(o.open("GET",u),c)try{c(o)}catch(e){v(e);return}s&&(o.responseType="arraybuffer"),r&&o.addEventListener("progress",r),K&&o.addEventListener("loadend",K),e=()=>{if(!d&&o&&o.readyState===(XMLHttpRequest.DONE||4)){if(e&&o.removeEventListener("readystatechange",e),o.status>=200&&o.status<300||0===o.status&&(!(0,a.BA)()||F())){let e=s?o.response:o.responseText;if(null!==e){try{t&&t(e,o)}catch(e){v(e)}return}}let r=A.DefaultRetryStrategy;if(r){let e=r(u,o,g);if(-1!==e){f(),o=new i.u,n=setTimeout(()=>h(g+1),e);return}}let c=new P("Error status: "+o.status+" "+o.statusText+" - Unable to load "+u,o);l&&l(c)}},o.addEventListener("readystatechange",e),o.send()}};h(0)};if(o&&o.enableSceneOffline&&!e.startsWith("blob:")){let i=e=>{e&&e.status>400?l&&l(e):K()};o.open(()=>{o&&o.loadFile(A.BaseUrl+e,e=>{!d&&t&&t(e),m.onCompleteObservable.notifyObservers(m)},r?e=>{!d&&r&&r(e)}:void 0,i,s)},i)}else K();return m},S=e=>{let{match:t,type:r}=R(e);if(t)return r||void 0;let o=e.lastIndexOf(".");switch(e.substring(o+1).toLowerCase()){case"glb":return"model/gltf-binary";case"bin":return"application/octet-stream";case"gltf":return"model/gltf+json";case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"webp":return"image/webp";case"ktx":return"image/ktx";case"ktx2":return"image/ktx2";case"avif":return"image/avif";default:return}},F=()=>"undefined"!=typeof location&&"file:"===location.protocol,y=e=>h.test(e),R=e=>{let t=h.exec(e);return null===t||0===t.length?{match:!1,type:""}:{match:!0,type:t[0].replace("data:","").replace(";base64,","")}};function x(e){return(0,u.yS)(e.split(",")[1])}let j=e=>(0,u.AV)(e.split(",")[1]);v.$._FileToolsLoadImage=B,K.sg.loadFile=E,d.Hd.loadFile=E;let w=(e,t,r,i,a,n,s,l,c,u)=>{Object.defineProperty(o={DecodeBase64UrlToBinary:e,DecodeBase64UrlToString:t,DefaultRetryStrategy:r.DefaultRetryStrategy,BaseUrl:r.BaseUrl,CorsBehavior:r.CorsBehavior,PreprocessUrl:r.PreprocessUrl,IsBase64DataUrl:i,IsFileURL:a,LoadFile:n,LoadImage:s,ReadFile:l,RequestFile:c,SetCorsBehavior:u},"DefaultRetryStrategy",{get:function(){return r.DefaultRetryStrategy},set:function(e){r.DefaultRetryStrategy=e}}),Object.defineProperty(o,"BaseUrl",{get:function(){return r.BaseUrl},set:function(e){r.BaseUrl=e}}),Object.defineProperty(o,"PreprocessUrl",{get:function(){return r.PreprocessUrl},set:function(e){r.PreprocessUrl=e}}),Object.defineProperty(o,"CorsBehavior",{get:function(){return r.CorsBehavior},set:function(e){r.CorsBehavior=e}})};w(x,j,A,y,F,E,B,T,L,C)},10686:function(e,t,r){r.d(t,{n:()=>a});var o=r(48766),i=r(79793);class a{static Instantiate(e){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[e])return this.RegisteredExternalClasses[e];let t=(0,i.n9)(e);if(t)return t;o.V.Warn(e+" not found, you may have missed an import.");let r=e.split("."),a=window||this;for(let e=0,t=r.length;e<t;e++)a=a[r[e]];return"function"!=typeof a?null:a}}a.RegisteredExternalClasses={}},11280:function(e,t,r){function o(e){let t=1;do t*=2;while(t<e);return t===e}function i(e,t,r){return e*(1-r)+t*r}function a(e){let t=n(e),r=s(e);return t-e>e-r?r:t}function n(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}function s(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)-(e>>1)}function l(e,t,r=2){let o;switch(r){case 1:o=s(e);break;case 2:o=a(e);break;default:o=n(e)}return Math.min(o,t)}r.d(t,{C4:()=>s,L8:()=>o,OG:()=>a,R:()=>l,zF:()=>i})},12299:function(e,t,r){r.d(t,{LV:()=>p,S0:()=>v,s7:()=>h});var o=r(97183),i=r(46703),a=r(48766),n=r(24234),s=r(29232),l=r(884),c=r(6497),u=r(63468),d=r(45981),f=r(24825),g=r(10686),m=r(31963),K=r(11280);class v{static get BaseUrl(){return d.eC.BaseUrl}static set BaseUrl(e){d.eC.BaseUrl=e}static get CleanUrl(){return d.eC.CleanUrl}static set CleanUrl(e){d.eC.CleanUrl=e}static IsAbsoluteUrl(e){return 0===e.indexOf("//")||!(-1===e.indexOf("://")||-1===e.indexOf(".")||-1===e.indexOf("/")||e.indexOf(":")>e.indexOf("/"))&&(!!(e.indexOf("://")<e.indexOf("."))||0===e.indexOf("data:")||0===e.indexOf("blob:"))}static set ScriptBaseUrl(e){d.eC.ScriptBaseUrl=e}static get ScriptBaseUrl(){return d.eC.ScriptBaseUrl}static set CDNBaseUrl(e){v.ScriptBaseUrl=e,v.AssetBaseUrl=e}static set ScriptPreprocessUrl(e){d.eC.ScriptPreprocessUrl=e}static get ScriptPreprocessUrl(){return d.eC.ScriptPreprocessUrl}static get DefaultRetryStrategy(){return d.eC.DefaultRetryStrategy}static set DefaultRetryStrategy(e){d.eC.DefaultRetryStrategy=e}static get CorsBehavior(){return d.eC.CorsBehavior}static set CorsBehavior(e){d.eC.CorsBehavior=e}static get UseFallbackTexture(){return u.q.UseFallbackTexture}static set UseFallbackTexture(e){u.q.UseFallbackTexture=e}static get RegisteredExternalClasses(){return g.n.RegisteredExternalClasses}static set RegisteredExternalClasses(e){g.n.RegisteredExternalClasses=e}static get fallbackTexture(){return u.q.FallbackTexture}static set fallbackTexture(e){u.q.FallbackTexture=e}static FetchToRef(e,t,r,o,i,a){let n=((Math.abs(e)*r%r|0)+(Math.abs(t)*o%o|0)*r)*4;a.r=i[n]/255,a.g=i[n+1]/255,a.b=i[n+2]/255,a.a=i[n+3]/255}static Mix(e,t,r){return 0}static Instantiate(e){return g.n.Instantiate(e)}static SetImmediate(e){f._.SetImmediate(e)}static IsExponentOfTwo(e){return!0}static FloatRound(e){return Math.fround(e)}static GetFilename(e){let t=e.lastIndexOf("/");return t<0?e:e.substring(t+1)}static GetFolderPath(e,t=!1){let r=e.lastIndexOf("/");return r<0?t?e:"":e.substring(0,r+1)}static ToDegrees(e){return 180*e/Math.PI}static ToRadians(e){return e*Math.PI/180}static SmoothAngleChange(e,t,r=.9){let o=this.ToRadians(e),i=this.ToRadians(t);return this.ToDegrees(Math.atan2((1-r)*Math.sin(i)+r*Math.sin(o),(1-r)*Math.cos(i)+r*Math.cos(o)))}static MakeArray(e,t){return!0!==t&&(void 0===e||null==e)?null:Array.isArray(e)?e:[e]}static GetPointerPrefix(e){return(0,i.BA)()&&!window.PointerEvent?"mouse":"pointer"}static SetCorsBehavior(e,t){(0,d.M1)(e,t)}static SetReferrerPolicyBehavior(e,t){t.referrerPolicy=e}static get PreprocessUrl(){return d.eC.PreprocessUrl}static set PreprocessUrl(e){d.eC.PreprocessUrl=e}static LoadImage(e,t,r,o,i,a){return(0,d.W$)(e,t,r,o,i,a)}static LoadFile(e,t,r,o,i,a){return(0,d.zU)(e,t,r,o,i,a)}static async LoadFileAsync(e,t=!0){return await new Promise((r,o)=>{(0,d.zU)(e,e=>{r(e)},void 0,void 0,t,(e,t)=>{o(t)})})}static GetAssetUrl(e){if(!e)return"";if(v.AssetBaseUrl&&e.startsWith(v._DefaultAssetsUrl)){let t="/"===v.AssetBaseUrl[v.AssetBaseUrl.length-1]?v.AssetBaseUrl.substring(0,v.AssetBaseUrl.length-1):v.AssetBaseUrl;return e.replace(v._DefaultAssetsUrl,t)}return e}static GetBabylonScriptURL(e,t){if(!e)return"";if(v.ScriptBaseUrl&&e.startsWith(v._DefaultCdnUrl)){let t="/"===v.ScriptBaseUrl[v.ScriptBaseUrl.length-1]?v.ScriptBaseUrl.substring(0,v.ScriptBaseUrl.length-1):v.ScriptBaseUrl;e=e.replace(v._DefaultCdnUrl,t)}return e=v.ScriptPreprocessUrl(e),t&&!v.IsAbsoluteUrl(e)&&(e=v.GetAbsoluteUrl(e)),e}static LoadBabylonScript(e,t,r,o){e=v.GetBabylonScriptURL(e),v.LoadScript(e,t,r)}static async LoadBabylonScriptAsync(e){return e=v.GetBabylonScriptURL(e),await v.LoadScriptAsync(e)}static LoadScript(e,t,r,o,a=!1){if("function"==typeof importScripts){try{importScripts(e),t&&t()}catch(t){r?.(`Unable to load script '${e}' in worker`,t)}return}if(!(0,i.BA)())return void r?.(`Cannot load script '${e}' outside of a window or a worker`);let n=document.getElementsByTagName("head")[0],s=document.createElement("script");a?(s.setAttribute("type","module"),s.innerText=e):(s.setAttribute("type","text/javascript"),s.setAttribute("src",e)),o&&(s.id=o),s.onload=()=>{t&&t()},s.onerror=t=>{r&&r(`Unable to load script '${e}'`,t)},n.appendChild(s)}static async LoadScriptAsync(e,t){return await new Promise((r,o)=>{this.LoadScript(e,()=>{r()},(e,t)=>{o(t||Error(e))},t)})}static ReadFileAsDataURL(e,t,r){let i=new FileReader,a={onCompleteObservable:new o.cP,abort:()=>i.abort()};return i.onloadend=()=>{a.onCompleteObservable.notifyObservers(a)},i.onload=e=>{t(e.target.result)},i.onprogress=r,i.readAsDataURL(e),a}static ReadFile(e,t,r,o,i){return(0,d.NJ)(e,t,r,o,i)}static FileAsURL(e){let t=new Blob([e]);return window.URL.createObjectURL(t)}static Format(e,t=2){return e.toFixed(t)}static DeepCopy(e,t,r,o){n.r.DeepCopy(e,t,r,o)}static IsEmpty(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}static RegisterTopRootEvents(e,t){for(let r=0;r<t.length;r++){let o=t[r];e.addEventListener(o.name,o.handler,!1);try{window.parent&&window.parent.addEventListener(o.name,o.handler,!1)}catch(e){}}}static UnregisterTopRootEvents(e,t){for(let r=0;r<t.length;r++){let o=t[r];e.removeEventListener(o.name,o.handler);try{e.parent&&e.parent.removeEventListener(o.name,o.handler)}catch(e){}}}static async DumpFramebuffer(e,t,r,o,i="image/png",a,n){throw(0,l.n)("DumpTools")}static DumpData(e,t,r,o,i="image/png",a,n=!1,s=!1,c){throw(0,l.n)("DumpTools")}static async DumpDataAsync(e,t,r,o="image/png",i,a=!1,n=!1,s){throw(0,l.n)("DumpTools")}static _IsOffScreenCanvas(e){return void 0!==e.convertToBlob}static ToBlob(e,t,r="image/png",o){v._IsOffScreenCanvas(e)||e.toBlob||(e.toBlob=function(e,t,r){setTimeout(()=>{let o=atob(this.toDataURL(t,r).split(",")[1]),i=o.length,a=new Uint8Array(i);for(let e=0;e<i;e++)a[e]=o.charCodeAt(e);e(new Blob([a]))})}),v._IsOffScreenCanvas(e)?e.convertToBlob({type:r,quality:o}).then(e=>t(e)):e.toBlob(function(e){t(e)},r,o)}static DownloadBlob(e,t){if("download"in document.createElement("a")){if(!t){let e=new Date;t="screenshot_"+((e.getFullYear()+"-"+(e.getMonth()+1)).slice(2)+"-"+e.getDate()+"_"+e.getHours()+"-")+("0"+e.getMinutes()).slice(-2)+".png"}v.Download(e,t)}else if(e&&"undefined"!=typeof URL){let t=URL.createObjectURL(e),r=window.open("");if(!r)return;let o=r.document.createElement("img");o.onload=function(){URL.revokeObjectURL(t)},o.src=t,r.document.body.appendChild(o)}}static EncodeScreenshotCanvasData(e,t,r="image/png",o,i){if("string"!=typeof o&&t){if(t){if(v._IsOffScreenCanvas(e))return void e.convertToBlob({type:r,quality:i}).then(e=>{let r=new FileReader;r.readAsDataURL(e),r.onloadend=()=>{t(r.result)}});t(e.toDataURL(r,i))}}else this.ToBlob(e,function(e){e&&v.DownloadBlob(e,o),t&&t("")},r,i)}static Download(e,t){if("undefined"==typeof URL)return;let r=window.URL.createObjectURL(e),o=document.createElement("a");document.body.appendChild(o),o.style.display="none",o.href=r,o.download=t,o.addEventListener("click",()=>{o.parentElement&&o.parentElement.removeChild(o)}),o.click(),window.URL.revokeObjectURL(r)}static BackCompatCameraNoPreventDefault(e){return"boolean"==typeof e[0]?e[0]:"boolean"==typeof e[1]&&e[1]}static CreateScreenshot(e,t,r,o,i="image/png",a=!1,n){throw(0,l.n)("ScreenshotTools")}static async CreateScreenshotAsync(e,t,r,o="image/png",i){throw(0,l.n)("ScreenshotTools")}static CreateScreenshotUsingRenderTarget(e,t,r,o,i="image/png",a=1,n=!1,s,c=!1,u=!1,d=!0,f,g){throw(0,l.n)("ScreenshotTools")}static async CreateScreenshotUsingRenderTargetAsync(e,t,r,o="image/png",i=1,a=!1,n,s=!1,c=!1,u=!0,d,f){throw(0,l.n)("ScreenshotTools")}static RandomId(){return(0,m.z)()}static IsBase64(e){return(0,d.f2)(e)}static DecodeBase64(e){return(0,d.rz)(e)}static get errorsCount(){return a.V.errorsCount}static Log(e){a.V.Log(e)}static Warn(e){a.V.Warn(e)}static Error(e){a.V.Error(e)}static get LogCache(){return a.V.LogCache}static ClearLogCache(){a.V.ClearLogCache()}static set LogLevels(e){a.V.LogLevels=e}static set PerformanceLogLevel(e){if((e&v.PerformanceUserMarkLogLevel)===v.PerformanceUserMarkLogLevel){v.StartPerformanceCounter=v._StartUserMark,v.EndPerformanceCounter=v._EndUserMark;return}if((e&v.PerformanceConsoleLogLevel)===v.PerformanceConsoleLogLevel){v.StartPerformanceCounter=v._StartPerformanceConsole,v.EndPerformanceCounter=v._EndPerformanceConsole;return}v.StartPerformanceCounter=v._StartPerformanceCounterDisabled,v.EndPerformanceCounter=v._EndPerformanceCounterDisabled}static _StartPerformanceCounterDisabled(e,t){}static _EndPerformanceCounterDisabled(e,t){}static _StartUserMark(e,t=!0){if(!v._Performance){if(!(0,i.BA)())return;v._Performance=window.performance}t&&v._Performance.mark&&v._Performance.mark(e+"-Begin")}static _EndUserMark(e,t=!0){t&&v._Performance.mark&&(v._Performance.mark(e+"-End"),v._Performance.measure(e,e+"-Begin",e+"-End"))}static _StartPerformanceConsole(e,t=!0){t&&(v._StartUserMark(e,t),console.time&&console.time(e))}static _EndPerformanceConsole(e,t=!0){t&&(v._EndUserMark(e,t),console.timeEnd(e))}static get Now(){return s.j.Now}static GetClassName(e,t=!1){let r=null;return!t&&e.getClassName?r=e.getClassName():(e instanceof Object&&(r=(t?e:Object.getPrototypeOf(e)).constructor.__bjsclassName__),r||(r=typeof e)),r}static First(e,t){for(let r of e)if(t(r))return r;return null}static getFullClassName(e,t=!1){let r=null,o=null;if(!t&&e.getClassName)r=e.getClassName();else{if(e instanceof Object){let i=t?e:Object.getPrototypeOf(e);r=i.constructor.__bjsclassName__,o=i.constructor.__bjsmoduleName__}r||(r=typeof e)}return r?(null!=o?o+".":"")+r:null}static async DelayAsync(e){await new Promise(t=>{setTimeout(()=>{t()},e)})}static IsSafari(){return!!(0,i.XD)()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}function h(e,t){return r=>{r.__bjsclassName__=e,r.__bjsmoduleName__=null!=t?t:null}}v.AssetBaseUrl="",v.UseCustomRequestHeaders=!1,v.CustomRequestHeaders=c.u.CustomRequestHeaders,v.GetDOMTextContent=i.Zl,v._DefaultCdnUrl="https://cdn.babylonjs.com",v._DefaultAssetsUrl="https://assets.babylonjs.com/core",v.GetAbsoluteUrl="object"==typeof document?e=>{let t=document.createElement("a");return t.href=e,t.href}:"function"==typeof URL&&"object"==typeof location?e=>new URL(e,location.origin).href:()=>{throw Error("Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.")},v.NoneLogLevel=a.V.NoneLogLevel,v.MessageLogLevel=a.V.MessageLogLevel,v.WarningLogLevel=a.V.WarningLogLevel,v.ErrorLogLevel=a.V.ErrorLogLevel,v.AllLogLevel=a.V.AllLogLevel,v.IsWindowObjectExist=i.BA,v.PerformanceNoneLogLevel=0,v.PerformanceUserMarkLogLevel=1,v.PerformanceConsoleLogLevel=2,v.StartPerformanceCounter=v._StartPerformanceCounterDisabled,v.EndPerformanceCounter=v._EndPerformanceCounterDisabled;class p{constructor(e,t,r,o=0){this.iterations=e,this.index=o-1,this._done=!1,this._fn=t,this._successCallback=r}executeNext(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())}breakLoop(){this._done=!0,this._successCallback()}static Run(e,t,r,o=0){let i=new p(e,t,r,o);return i.executeNext(),i}static SyncAsyncForLoop(e,t,r,o,i,a=0){return p.Run(Math.ceil(e/t),o=>{i&&i()?o.breakLoop():setTimeout(()=>{for(let a=0;a<t;++a){let n=o.index*t+a;if(n>=e)break;if(r(n),i&&i()){o.breakLoop();break}}o.executeNext()},a)},o)}}v.Mix=K.zF,v.IsExponentOfTwo=K.L8,u.q.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z"}}]);