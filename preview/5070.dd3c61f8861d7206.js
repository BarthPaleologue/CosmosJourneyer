/*
 *  This file is part of Cosmos Journeyer
 *
 *  Copyright (C) 2024 Barthélemy Paléologue <barth.paleologue@cosmosjourneyer.com>
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Affero General Public License for more details.
 *
 *  You should have received a copy of the GNU Affero General Public License
 *  along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */

"use strict";(globalThis.webpackChunk_cosmos_journeyer_game=globalThis.webpackChunk_cosmos_journeyer_game||[]).push([["5070"],{14620:function(e,t,n){e.exports=n.p+"e11ee3cdd6bf505e.webp"},74452:function(e,t,n){e.exports=n.p+"ceb0939a515e507b.webp"},41077:function(e,t,n){e.exports=n.p+"a818b763cab42c30.webp"},23684:function(e,t,n){e.exports=n.p+"2470ffe0b50b2171.webp"},14597:function(e,t,n){e.exports=n.p+"fd7997898bbeb1f1.wasm"},9098:function(e,t,n){e.exports=n.p+"869739fc3ede15e2.js"},95901:function(e,t,n){n.d(t,{QU:()=>d});var r=n(67902),a=n(32220),i=n(13679),o=(0,a.p)(i.w.POWER_PLAY_SEED),s=0,u=(0,r.makeNoise3D)(function(){return o(s++)}),c=(0,a.p)(i.w.POWER_PLAY_SEED+598),l=0,h=(0,r.makeNoise3D)(function(){return c(l++)});function d(e){var t,n;return{materialistSpiritualist:(t=e.x,.5*u(.2*t,.2*e.y,.2*e.z)+.5),capitalistCommunist:(n=e.x,.5*h(.2*n,.2*e.y,.2*e.z)+.5)}}},76448:function(e,t,n){function r(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{bk:()=>v,Wo:()=>p,Lr:()=>m});var s,u=function(){function e(t,n,a,i){r(this,e),o(this,"sound",void 0),o(this,"targetVolume",void 0),o(this,"volumeMultiplier",void 0),o(this,"playbackSpeedMultiplier",void 0),o(this,"maskFactor",1),o(this,"mask",void 0);var s=t.clone();if(null===s)throw Error("Cloned sound was null!");this.sound=s,this.mask=n,this.targetVolume=a,this.volumeMultiplier=t.getVolume(),this.playbackSpeedMultiplier=t.getPlaybackRate(),this.sound.updateOptions({playbackRate:this.playbackSpeedMultiplier,volume:this.targetVolume*this.volumeMultiplier*this.maskFactor,loop:!i})}return i(e,[{key:"play",value:function(){this.sound.play()}},{key:"setVolume",value:function(e){this.targetVolume=e,this.sound.setVolume(this.targetVolume*this.volumeMultiplier*this.maskFactor,.5)}},{key:"setMaskFactor",value:function(e){this.maskFactor=e,this.sound.setVolume(this.targetVolume*this.volumeMultiplier*this.maskFactor,.5)}},{key:"getMask",value:function(){return this.mask}},{key:"dispose",value:function(){this.sound.dispose()}}]),e}(),c=function(){function e(){r(this,e)}return i(e,[{key:"play",value:function(){}},{key:"setVolume",value:function(){}},{key:"setMaskFactor",value:function(){}},{key:"getMask",value:function(){return 0}},{key:"dispose",value:function(){}}]),e}();function l(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=((s={})[s.CLICK=0]="CLICK",s[s.HOVER=1]="HOVER",s[s.SUCCESS=2]="SUCCESS",s[s.ERROR=3]="ERROR",s[s.WARNING=4]="WARNING",s[s.INFO=5]="INFO",s[s.ENABLE_ORBIT_DISPLAY=6]="ENABLE_ORBIT_DISPLAY",s[s.DISABLE_ORBIT_DISPLAY=7]="DISABLE_ORBIT_DISPLAY",s[s.TARGET_LOCK=8]="TARGET_LOCK",s[s.TARGET_UNLOCK=9]="TARGET_UNLOCK",s[s.ITINERARY_COMPUTED=10]="ITINERARY_COMPUTED",s[s.OPEN_PAUSE_MENU=11]="OPEN_PAUSE_MENU",s[s.ENABLE_WARP_DRIVE=12]="ENABLE_WARP_DRIVE",s[s.DISABLE_WARP_DRIVE=13]="DISABLE_WARP_DRIVE",s[s.ACCELERATING_WARP_DRIVE=14]="ACCELERATING_WARP_DRIVE",s[s.DECELERATING_WARP_DRIVE=15]="DECELERATING_WARP_DRIVE",s[s.HYPER_SPACE=16]="HYPER_SPACE",s[s.THRUSTER=17]="THRUSTER",s),m=function(){function e(t){l(this,e),f(this,"sounds",void 0),f(this,"isPlaying",!1),f(this,"soundQueue",[]),f(this,"soundInstances",new Set),f(this,"soundInstanceMask",15),this.sounds=t}return d(e,[{key:"getSoundFromType",value:function(e){switch(e){case 0:case 4:case 5:return this.sounds.menuSelect;case 2:return this.sounds.success;case 3:return this.sounds.error;case 1:case 6:case 7:return this.sounds.menuHover;case 8:return this.sounds.targetLock;case 9:case 10:return this.sounds.targetUnlock;case 11:return this.sounds.openPauseMenu;case 12:return this.sounds.enableWarpDrive;case 13:return this.sounds.disableWarpDrive;case 14:return this.sounds.acceleratingWarpDrive;case 15:return this.sounds.deceleratingWarpDrive;case 16:return this.sounds.hyperSpace;case 17:return this.sounds.thruster}}},{key:"playNow",value:function(e){this.getSoundFromType(e).play()}},{key:"enqueuePlay",value:function(e){this.soundQueue.push(this.getSoundFromType(e))}},{key:"createInstance",value:function(e,t,n,r){var a=new u(this.getSoundFromType(e),t,n,r);return this.soundInstances.add(a),a.setMaskFactor(+((t&this.soundInstanceMask)!=0)),a}},{key:"freeInstance",value:function(e){this.soundInstances.delete(e),e.dispose()}},{key:"setInstanceMask",value:function(e){this.soundInstanceMask=e}},{key:"update",value:function(){var e=this,t=!0,n=!1,r=void 0;try{for(var a,i=this.soundInstances[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value,s=(o.getMask()&this.soundInstanceMask)!=0;o.setMaskFactor(+!!s)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}if(!this.isPlaying){var u=this.soundQueue.shift();void 0!==u&&(this.isPlaying=!0,u.play(),u.onEndedObservable.addOnce(function(){e.isPlaying=!1}))}}}]),e}(),v=function(){function e(){l(this,e)}return d(e,[{key:"playNow",value:function(){}},{key:"enqueuePlay",value:function(){}},{key:"createInstance",value:function(){return new c}},{key:"freeInstance",value:function(){}},{key:"setInstanceMask",value:function(){}},{key:"update",value:function(){}}]),e}()},13997:function(e,t,n){n.d(t,{_l:()=>u,bm:()=>s,yT:()=>o});function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a,i,o=((a={})[a.CHARLOTTE=0]="CHARLOTTE",a),s=((i={})[i.INITIATING_PLANETARY_LANDING=0]="INITIATING_PLANETARY_LANDING",i[i.LANDING_REQUEST_GRANTED=1]="LANDING_REQUEST_GRANTED",i[i.LANDING_COMPLETE=2]="LANDING_COMPLETE",i[i.MISSION_COMPLETE=3]="MISSION_COMPLETE",i[i.NEW_DISCOVERY=4]="NEW_DISCOVERY",i[i.CANNOT_ENGAGE_WARP_DRIVE=5]="CANNOT_ENGAGE_WARP_DRIVE",i[i.WARP_DRIVE_EMERGENCY_SHUT_DOWN=6]="WARP_DRIVE_EMERGENCY_SHUT_DOWN",i[i.WARP_DRIVE_DISENGAGED=7]="WARP_DRIVE_DISENGAGED",i[i.ENGAGING_WARP_DRIVE=8]="ENGAGING_WARP_DRIVE",i[i.FUEL_SCOOPING=9]="FUEL_SCOOPING",i[i.FUEL_SCOOPING_COMPLETE=10]="FUEL_SCOOPING_COMPLETE",i),u=function(){var e;function t(e){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");r(this,"voiceLines",void 0),r(this,"isPlaying",!1),r(this,"soundQueue",new Set),this.voiceLines=e}return e=[{key:"getLineFromVoiceLines",value:function(e,t){switch(t){case 0:return e.initiatingPlanetaryLanding;case 1:return e.landingRequestGranted;case 2:return e.landingComplete;case 3:return e.missionComplete;case 4:return e.newDiscovery;case 5:return e.cannotEngageWarpDrive;case 6:return e.warpDriveEmergencyShutDown;case 7:return e.warpDriveDisengaged;case 8:return e.engagingWarpDrive;case 9:return e.fuelScooping;case 10:return e.fuelScoopingComplete}}},{key:"getVoiceLinesFromSpeaker",value:function(e){if(0===e)return this.voiceLines.charlotte}},{key:"sayNow",value:function(e,t){this.getLineFromVoiceLines(this.getVoiceLinesFromSpeaker(e),t).play()}},{key:"enqueueSay",value:function(e,t){this.soundQueue.add(this.getLineFromVoiceLines(this.getVoiceLinesFromSpeaker(e),t))}},{key:"update",value:function(){var e=this;if(!this.isPlaying){var t=this.soundQueue.values().next().value;void 0!==t&&(this.soundQueue.delete(t),this.isPlaying=!0,t.play(),t.onEndedObservable.addOnce(function(){e.isPlaying=!1}))}}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}()},50554:function(e,t,n){n.d(t,{K:()=>tG}),n(46443),n(91503),n(10086);var r,a=n(62005),i=n(85307),o=n(31165),s=n(66144),u=n(23455),c=n(73889),l=n(46391),h=n(40317),d=n(70612),f=n(85303),p=n(89286),m=n(27266);function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function y(e){function t(e){if(Object(e)!==e)return Promise.reject(TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return(y=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new y(e)}function b(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function g(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){b(i,r,a,o,s,"next",e)}function s(e){b(i,r,a,o,s,"throw",e)}o(void 0)})}}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function P(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var c=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var k=function(){var e,t;function n(e){var t,r;if(!(this instanceof n))throw TypeError("Cannot call a class as a function");r=void 0,(t="rootHandle")in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[t]=r,this.rootHandle=e}return e=[{key:"getDirectoryHandle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return g(function(){var n,r,a,i,o,s,u,c,l,h;return P(this,function(d){switch(d.label){case 0:d.trys.push([0,9,,10]),n=e.split("/").filter(Boolean),r=this.rootHandle,a=!0,i=!1,o=void 0,d.label=1;case 1:d.trys.push([1,6,7,8]),s=n[Symbol.iterator](),d.label=2;case 2:if(a=(u=s.next()).done)return[3,5];return c=u.value,[4,r.getDirectoryHandle(c,{create:t})];case 3:r=d.sent(),d.label=4;case 4:return a=!0,[3,2];case 5:return[3,8];case 6:return l=d.sent(),i=!0,o=l,[3,8];case 7:try{a||null==s.return||s.return()}finally{if(i)throw o}return[7];case 8:return[2,r];case 9:if(S(h=d.sent(),DOMException)&&"NotFoundError"===h.name)return[2,null];throw h;case 10:return[2]}})}).call(this)}},{key:"getFileHandle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return g(function(){var n,r,a,i;return P(this,function(o){switch(o.label){case 0:if(o.trys.push([0,3,,4]),void 0===(r=(n=e.split("/").filter(Boolean)).pop()))throw Error("Invalid file path");return[4,this.getDirectoryHandle("/"+n.join("/"),t)];case 1:if(!(a=o.sent()))return[2,null];return[4,a.getFileHandle(r,{create:t})];case 2:return[2,o.sent()];case 3:if(S(i=o.sent(),DOMException)&&"NotFoundError"===i.name)return[2,null];throw i;case 4:return[2]}})}).call(this)}},{key:"createDirectory",value:function(e){return g(function(){var t;return P(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getDirectoryHandle(e,!0)];case 1:return n.sent(),[2,!0];case 2:return t=n.sent(),console.error("Failed to create directory: ".concat(e),t),[2,!1];case 3:return[2]}})}).call(this)}},{key:"deleteDirectory",value:function(e){return g(function(){var t,n,r,a;return P(this,function(i){switch(i.label){case 0:if(i.trys.push([0,3,,4]),void 0===(n=(t=e.split("/").filter(Boolean)).pop()))return[2,!1];return[4,this.getDirectoryHandle("/"+t.join("/"))];case 1:if(!(r=i.sent()))return[2,!1];return[4,r.removeEntry(n,{recursive:!0})];case 2:return i.sent(),[2,!0];case 3:return a=i.sent(),console.error("Failed to delete directory: ".concat(e),a),[2,!1];case 4:return[2]}})}).call(this)}},{key:"listDirectory",value:function(e){return g(function(){var t,n,r,a,i,o,s,u,c,l;return P(this,function(h){switch(h.label){case 0:return h.trys.push([0,14,,15]),[4,this.getDirectoryHandle(e)];case 1:if(!(t=h.sent()))return[2,null];n=[],r=!1,a=!1,h.label=2;case 2:h.trys.push([2,7,8,13]),o=function(e){var t,n,r,a=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);a--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new y(t.call(e));n="@@asyncIterator",r="@@iterator"}throw TypeError("Object is not async iterable")}(t.entries()),h.label=3;case 3:return[4,o.next()];case 4:var d;if(!(r=!(s=h.sent()).done))return[3,6];u=(function(e){if(Array.isArray(e))return e}(d=s.value)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var i=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),i.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw r}}return i}}(d,1)||function(e,t){if(e){if("string"==typeof e)return v(e,1);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}}(d,1)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],n.push(u),h.label=5;case 5:return r=!1,[3,3];case 6:return[3,13];case 7:return c=h.sent(),a=!0,i=c,[3,13];case 8:if(h.trys.push([8,,11,12]),!(r&&null!=o.return))return[3,10];return[4,o.return()];case 9:h.sent(),h.label=10;case 10:return[3,12];case 11:if(a)throw i;return[7];case 12:return[7];case 13:return[2,n.sort()];case 14:return l=h.sent(),console.error("Failed to list directory: ".concat(e),l),[2,null];case 15:return[2]}})}).call(this)}},{key:"directoryExists",value:function(e){return g(function(){return P(this,function(t){switch(t.label){case 0:return[4,this.getDirectoryHandle(e)];case 1:return[2,null!==t.sent()]}})}).call(this)}},{key:"writeFile",value:function(e,t){return g(function(){var n,r,a;return P(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),[4,this.getFileHandle(e,!0)];case 1:if(!(n=i.sent()))return[2,!1];return[4,n.createWritable()];case 2:return[4,(r=i.sent()).write(t)];case 3:return i.sent(),[4,r.close()];case 4:return i.sent(),[2,!0];case 5:return a=i.sent(),console.error("Failed to write file: ".concat(e),a),[2,!1];case 6:return[2]}})}).call(this)}},{key:"readFile",value:function(e){return g(function(){var t,n;return P(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,this.getFileHandle(e)];case 1:if(!(t=r.sent()))return[2,null];return[4,t.getFile()];case 2:return[4,r.sent().text()];case 3:return[2,r.sent()];case 4:return n=r.sent(),console.error("Failed to read file: ".concat(e),n),[2,null];case 5:return[2]}})}).call(this)}},{key:"deleteFile",value:function(e){return g(function(){var t,n,r,a;return P(this,function(i){switch(i.label){case 0:if(i.trys.push([0,3,,4]),void 0===(n=(t=e.split("/").filter(Boolean)).pop()))return[2,!1];return[4,this.getDirectoryHandle("/"+t.join("/"))];case 1:if(!(r=i.sent()))return[2,!1];return[4,r.removeEntry(n)];case 2:return i.sent(),[2,!0];case 3:return a=i.sent(),console.error("Failed to delete file: ".concat(e),a),[2,!1];case 4:return[2]}})}).call(this)}},{key:"fileExists",value:function(e){return g(function(){return P(this,function(t){switch(t.label){case 0:return[4,this.getFileHandle(e)];case 1:return[2,null!==t.sent()]}})}).call(this)}}],t=[{key:"CreateAsync",value:function(){return g(function(){var e,t;return P(this,function(r){switch(r.label){case 0:if(!n.IsSupported())return[2,(0,f._q)(Error("OPFS is not supported in this browser"))];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,navigator.storage.getDirectory()];case 2:return e=r.sent(),[2,(0,f.ok)(new n(e))];case 3:return console.error("Failed to create OPFSFileSystem:",t=r.sent()),[2,(0,f._q)(t)];case 4:return[2]}})})()}},{key:"IsSupported",value:function(){return"storage"in navigator&&"getDirectory"in navigator.storage}}],e&&w(n.prototype,e),t&&w(n,t),n}(),E=n(44710),C=n(13679),A=n(65617),T=n(26070);function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function I(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function M(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){I(i,r,a,o,s,"next",e)}function s(e){I(i,r,a,o,s,"throw",e)}o(void 0)})}}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}}function x(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var c=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var D=function(){var e,t;function n(e,t){if(!(this instanceof n))throw TypeError("Cannot call a class as a function");R(this,"fileSystem",void 0),R(this,"starSystemDatabase",void 0),R(this,"corruptedSaves",[]),this.fileSystem=e,this.starSystemDatabase=t}return e=[{key:"getCorruptedSaves",value:function(){var e;return function(e){if(Array.isArray(e))return L(e)}(e=this.corruptedSaves)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},{key:"loadSaveFile",value:function(e){return M(function(){var t,n,r,a,i;return x(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,5]),[4,this.fileSystem.readFile(e)];case 1:if(null===(t=o.sent()))return[2,null];if(!(n=(0,E.z)(t)))throw Error("Invalid JSON");if(!(r=(0,A.c_)(n,this.starSystemDatabase)).success)throw Error("Save validation failed: ".concat((0,T.k)(r.error)));return[2,r.value];case 2:return a=o.sent(),[4,this.fileSystem.readFile(e)];case 3:return i=o.sent(),this.corruptedSaves.push({filePath:e,error:a,rawContent:null!=i?i:""}),console.error("Corrupted save file: ".concat(e),a),[4,this.quarantineCorruptedSave(e)];case 4:return o.sent(),[2,null];case 5:return[2]}})}).call(this)}},{key:"quarantineCorruptedSave",value:function(e){return M(function(){var t,n,r,a;return x(this,function(i){switch(i.label){case 0:return i.trys.push([0,6,,7]),[4,this.fileSystem.readFile(e)];case 1:if(null===(t=i.sent()))return[3,4];return r=(n=e.replace("/saves/","/corrupted/")).substring(0,n.lastIndexOf("/")),[4,this.fileSystem.createDirectory(r)];case 2:return i.sent(),[4,this.fileSystem.writeFile(n,t)];case 3:i.sent(),i.label=4;case 4:return[4,this.fileSystem.deleteFile(e)];case 5:return i.sent(),[3,7];case 6:return a=i.sent(),console.error("Failed to quarantine corrupted save: ".concat(e),a),[3,7];case 7:return[2]}})}).call(this)}},{key:"getSavesForCmdr",value:function(e){return M(function(){var t,r,a,i,o,s,u,c,l,h,d,f,p,m,v,y,b,g,w,S,P,k;return x(this,function(E){switch(E.label){case 0:return t="".concat(n.SAVES_DIR,"/").concat(e),[4,this.fileSystem.directoryExists(t)];case 1:if(!E.sent())return[2,void 0];return r=[],a=[],i="".concat(t,"/manual"),[4,this.fileSystem.listDirectory(i)];case 2:if(null===(o=E.sent()))return[3,10];s=!0,u=!1,c=void 0,E.label=3;case 3:E.trys.push([3,8,9,10]),l=o[Symbol.iterator](),E.label=4;case 4:if(s=(h=l.next()).done)return[3,7];return d=h.value,[4,this.loadSaveFile("".concat(i,"/").concat(d))];case 5:if(null===(f=E.sent()))return[3,6];r.push(f),E.label=6;case 6:return s=!0,[3,4];case 7:return[3,10];case 8:return p=E.sent(),u=!0,c=p,[3,10];case 9:try{s||null==l.return||l.return()}finally{if(u)throw c}return[7];case 10:return m="".concat(t,"/auto"),[4,this.fileSystem.listDirectory(m)];case 11:if(null===(v=E.sent()))return[3,19];y=!0,b=!1,g=void 0,E.label=12;case 12:E.trys.push([12,17,18,19]),w=v[Symbol.iterator](),E.label=13;case 13:if(y=(S=w.next()).done)return[3,16];return P=S.value,[4,this.loadSaveFile("".concat(m,"/").concat(P))];case 14:if(null===(k=E.sent()))return[3,15];a.push(k),E.label=15;case 15:return y=!0,[3,13];case 16:return[3,19];case 17:return p=E.sent(),b=!0,g=p,[3,19];case 18:try{y||null==w.return||w.return()}finally{if(b)throw g}return[7];case 19:return r.sort(function(e,t){return t.timestamp-e.timestamp}),a.sort(function(e,t){return t.timestamp-e.timestamp}),[2,{manual:r,auto:a}]}})}).call(this)}},{key:"deleteSaveForCmdr",value:function(e,t){return M(function(){var r,a,i;return x(this,function(o){switch(o.label){case 0:return r="".concat(n.SAVES_DIR,"/").concat(e),a="".concat(r,"/manual/").concat(t,".json"),[4,this.fileSystem.fileExists(a)];case 1:if(!o.sent())return[3,3];return[4,this.fileSystem.deleteFile(a)];case 2:case 5:return[2,o.sent()];case 3:return i="".concat(r,"/auto/").concat(t,".json"),[4,this.fileSystem.fileExists(i)];case 4:if(!o.sent())return[3,6];return[4,this.fileSystem.deleteFile(i)];case 6:return[2,!1]}})}).call(this)}},{key:"deleteCmdr",value:function(e){return M(function(){var t;return x(this,function(r){switch(r.label){case 0:return t="".concat(n.SAVES_DIR,"/").concat(e),[4,this.fileSystem.deleteDirectory(t)];case 1:return[2,r.sent()]}})}).call(this)}},{key:"getCmdrUuids",value:function(){return M(function(){var e,t;return x(this,function(r){switch(r.label){case 0:return e=n.SAVES_DIR,[4,this.fileSystem.directoryExists(e)];case 1:if(!r.sent())return[2,[]];return[4,this.fileSystem.listDirectory(e)];case 2:return[2,null!=(t=r.sent())?t:[]]}})}).call(this)}},{key:"addManualSave",value:function(e,t){return M(function(){var r,a,i;return x(this,function(o){switch(o.label){case 0:return r="".concat(n.SAVES_DIR,"/").concat(e),a="".concat(r,"/manual"),[4,this.fileSystem.createDirectory(r)];case 1:return o.sent(),[4,this.fileSystem.createDirectory(a)];case 2:return o.sent(),i="".concat(a,"/").concat(t.uuid,".json"),[4,this.fileSystem.fileExists(i)];case 3:if(o.sent())return[2,!1];return[4,this.fileSystem.writeFile(i,JSON.stringify(t))];case 4:return[2,o.sent()]}})}).call(this)}},{key:"addAutoSave",value:function(e,t){return M(function(){var r,a,i;return x(this,function(o){switch(o.label){case 0:return r="".concat(n.SAVES_DIR,"/").concat(e),a="".concat(r,"/auto"),[4,this.fileSystem.createDirectory(r)];case 1:return o.sent(),[4,this.fileSystem.createDirectory(a)];case 2:return o.sent(),i="".concat(a,"/").concat(t.uuid,".json"),[4,this.fileSystem.fileExists(i)];case 3:if(o.sent())return[2,!1];return[4,this.fileSystem.writeFile(i,JSON.stringify(t))];case 4:if(!o.sent())return[2,!1];return[4,this.cleanupAutoSaves(e)];case 5:return o.sent(),[2,!0]}})}).call(this)}},{key:"cleanupAutoSaves",value:function(e){return M(function(){var t,r,a,i,o,s,u,c,l,h,d,f;return x(this,function(p){switch(p.label){case 0:return t="".concat(n.SAVES_DIR,"/").concat(e,"/auto"),[4,this.fileSystem.listDirectory(t)];case 1:if(!(r=p.sent()))return[2];a=[],i=!0,o=!1,s=void 0,p.label=2;case 2:p.trys.push([2,7,8,9]),u=r[Symbol.iterator](),p.label=3;case 3:if(i=(c=u.next()).done)return[3,6];return l=c.value,[4,this.loadSaveFile("".concat(t,"/").concat(l))];case 4:null!==(h=p.sent())&&a.push({uuid:h.uuid,timestamp:h.timestamp}),p.label=5;case 5:return i=!0,[3,3];case 6:return[3,9];case 7:return d=p.sent(),o=!0,s=d,[3,9];case 8:try{i||null==u.return||u.return()}finally{if(o)throw s}return[7];case 9:a.sort(function(e,t){return t.timestamp-e.timestamp}),p.label=10;case 10:if(!(a.length>C.w.MAX_AUTO_SAVES))return[3,13];if(void 0===(f=a.pop()))return[3,12];return[4,this.fileSystem.deleteFile("".concat(t,"/").concat(f.uuid,".json"))];case 11:p.sent(),p.label=12;case 12:return[3,10];case 13:return[2]}})}).call(this)}},{key:"importSaves",value:function(e){return M(function(){var t,n,r,a,i,o,s,u,c,l,h,d,f,p,m,v,y,b,g,w,S;return x(this,function(P){switch(P.label){case 0:t=[],n=!0,r=!1,a=void 0;try{for(i=Object.entries(e)[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var k;k=o.value,u=(s=function(e){if(Array.isArray(e))return e}(k)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var i=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),i.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw r}}return i}}(k,2)||_(k,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],c=s[1],l=!0,h=!1,d=void 0;try{for(f=c.manual[Symbol.iterator]();!(l=(p=f.next()).done);l=!0)m=p.value,t.push(this.addManualSave(u,m))}catch(e){h=!0,d=e}finally{try{l||null==f.return||f.return()}finally{if(h)throw d}}v=!0,y=!1,b=void 0;try{for(g=c.auto[Symbol.iterator]();!(v=(w=g.next()).done);v=!0)S=w.value,t.push(this.addAutoSave(u,S))}catch(e){y=!0,b=e}finally{try{v||null==g.return||g.return()}finally{if(y)throw b}}}}catch(e){r=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}return[4,Promise.all(t)];case 1:return[2,P.sent().every(function(e){return e})]}})}).call(this)}},{key:"exportSaves",value:function(){return M(function(){var e,t,n,r,a,i,o,s,u,c;return x(this,function(l){switch(l.label){case 0:return e={},[4,this.getCmdrUuids()];case 1:t=l.sent(),n=!0,r=!1,a=void 0,l.label=2;case 2:l.trys.push([2,7,8,9]),i=t[Symbol.iterator](),l.label=3;case 3:if(n=(o=i.next()).done)return[3,6];return s=o.value,[4,this.getSavesForCmdr(s)];case 4:void 0!==(u=l.sent())&&(e[s]=u),l.label=5;case 5:return n=!0,[3,3];case 6:return[3,9];case 7:return c=l.sent(),r=!0,a=c,[3,9];case 8:try{n||null==i.return||i.return()}finally{if(r)throw a}return[7];case 9:return[2,e]}})}).call(this)}}],t=[{key:"CreateAsync",value:function(e,t){return M(function(){return x(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e.createDirectory(n.SAVES_DIR)];case 1:return r.sent(),[2,(0,f.ok)(new n(e,t))];case 2:return console.error("Failed to create SaveBackendMultiFile:",r.sent()),[2,(0,f._q)({type:T.G.INVALID_JSON})];case 3:return[2]}})})()}}],e&&O(n.prototype,e),t&&O(n,t),n}();R(D,"SAVES_DIR","/saves");var V=n(31704),N=n(80456),B=n(49007),F=n(6408),j=n(65646);function U(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var G=function(){var e;function t(e,n,r){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");W(this,"save",void 0),W(this,"encyclopaedia",void 0),W(this,"universe",void 0),this.save=e,this.encyclopaedia=n,this.universe=r}return e=[{key:"New",value:function(){var e;return(e=function(){var e,n,r,a,i,o,s;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var c=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(u){switch(u.label){case 0:return e=new j.h((0,B.u)()),e.registerGeneralPlugin(function(e){return(0,d.g)([e.coordinates.starSectorX,e.coordinates.starSectorY,e.coordinates.starSectorZ,e.coordinates.localX,e.coordinates.localY,e.coordinates.localZ])>.5},function(e){var t=e.stellarObjects.map(function(e){return e.id});return e.anomalies.push((0,F.S)(t)),e}),(n=new m.k).backends.push(new p.A(e)),[4,V.E.CreateAsync(new N.m(N.m.SAVES_KEY),new N.m(N.m.BACKUP_SAVE_KEY),e)];case 1:return r=u.sent(),a=void 0,[4,k.CreateAsync()];case 2:if(!(i=u.sent()).success)return[3,8];return[4,D.CreateAsync(i.value,e)];case 3:if(!(o=u.sent()).success)return[3,7];if(!r.success)return[3,6];return[4,r.value.exportSaves()];case 4:return s=u.sent(),[4,o.value.importSaves(s)];case 5:u.sent(),u.label=6;case 6:return a=o.value,[3,8];case 7:r.success&&(a=r.value),u.label=8;case 8:if(void 0===a)return[2,(0,f._q)(Error("Failed to initialize save backend: OPFS not supported and legacy save backend failed"))];return[2,(0,f.ok)(new t(a,n,e))]}})},function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){U(i,r,a,o,s,"next",e)}function s(e){U(i,r,a,o,s,"throw",e)}o(void 0)})})()}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t,e),t}(),H=n(26274);n(34690),n(56247);var q=n(29389);let z=n.p+"17af999e7b7ad57f.mp3",Q=n.p+"041ff9a253ed825d.mp3",K=n.p+"1549759e283bd206.ogg",Y=n.p+"31e17b20ef567c2c.ogg",X=n.p+"39989db1f505d453.ogg",J=n.p+"d0fafb23c7d554d6.mp3",Z=n.p+"e681fd4fea79fa37.ogg",$=n.p+"2a8bc67628c05fba.ogg",ee=n.p+"1814b3aace9cf589.ogg",et=n.p+"bf4b326c5ffca2bb.mp3",en=n.p+"368a319571c58001.ogg",er=n.p+"c1c5397b26a6c809.ogg",ea=n.p+"920dd9f7b92185e2.ogg";function ei(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}let eo=n.p+"a77f60b1dade8fb8.mp3",es=n.p+"2344fdde5c5a6410.mp3",eu=n.p+"a5a4982c205e1a77.mp3",ec=n.p+"452710f264d2ba19.mp3",el=n.p+"305475735c5d3c0e.mp3",eh=n.p+"65ceacf6bbb524ce.mp3",ed=n.p+"5f6f5bf7bfca113e.mp3",ef=n.p+"4884a61f606c46b6.mp3",ep=n.p+"414af932bdf1a85c.mp3",em=n.p+"9bbc526876e8d7f3.mp3",ev=n.p+"4c543ebfed7579a0.mp3",ey=n.p+"dea0682c68132870.mp3";function eb(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}let eg=n.p+"d03a87f2075d6f53.mp3",ew=n.p+"02b9b418f00b21c6.mp3",eS=n.p+"cd82c2ed886f9749.mp3",eP=n.p+"5d862e8381583459.mp3",ek=n.p+"c83251e2246e7d88.mp3",eE=n.p+"64c7906a8f900679.mp3",eC=n.p+"2da6813008740281.mp3",eA=n.p+"b3ce59bafdbe5a25.mp3",eT=n.p+"cb1faa14ee3af51b.mp3",eL=n.p+"398d2c8156e90ba6.mp3",eI=n.p+"03f6eca0cfdf0539.mp3";function eM(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function eO(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}var eR=n(62978);function e_(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}var ex=n(7661),eD=n(59307);function eV(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eN=function(){var e;function t(e,n){var r=this;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");eV(this,"currentMusic",null),eV(this,"silenceSeconds",0),eV(this,"volume",1),eV(this,"fadeSeconds",3),eV(this,"pauseMusicWhenPaused",!1),eV(this,"starSystemView",void 0),eV(this,"musics",void 0),this.musics=e,this.starSystemView=n;var a=eD.$.audioEngine;if(null===a)throw Error("Audio context is null");a.onAudioUnlockedObservable.addOnce(function(){if(null!==r.currentMusic){var e=r.currentMusic;r.currentMusic=null,r.setMusic(e)}})}return e=[{key:"setMusicFromSelection",value:function(e){if(!(null!==this.currentMusic&&e.includes(this.currentMusic))){var t=e[Math.floor(Math.random()*e.length)];void 0!==t&&this.setMusic(t)}}},{key:"setMusic",value:function(e){if(this.currentMusic!==e){if(null!==this.currentMusic){this.currentMusic.setVolume(0,this.fadeSeconds),this.currentMusic=null,this.silenceSeconds=this.fadeSeconds;return}null!==e&&(this.currentMusic=e,this.currentMusic.stop(),this.currentMusic.setVolume(0),this.currentMusic.play(),this.currentMusic.setVolume(this.volume,this.fadeSeconds),console.log("currently playing",this.currentMusic.name))}}},{key:"setSoundtrackVolume",value:function(e){this.volume=e,null!==this.currentMusic&&this.currentMusic.setVolume(e)}},{key:"getVolume",value:function(){return this.volume}},{key:"update",value:function(e,t,n,r){if(null!==this.currentMusic){if(e&&this.pauseMusicWhenPaused&&this.currentMusic.isPlaying)return void this.currentMusic.pause();if(!e&&this.currentMusic.isPaused)return void this.currentMusic.play();e||this.currentMusic.isPlaying||(this.currentMusic=null,this.silenceSeconds=30+(Math.random()-.5)*20)}if(this.silenceSeconds>0){this.silenceSeconds-=r;return}if(!this.starSystemView.isLoadingSystem()){var a=this.starSystemView.getSpaceshipControls().getSpaceship(),i=this.starSystemView.scene.getActiveControls()===this.starSystemView.getCharacterControls(),o=this.starSystemView.scene.getActiveControls().getTransform().getAbsolutePosition(),u=this.starSystemView.getStarSystem().getNearestOrbitalObject(o),c=s.Pq.Distance(o,u.getTransform().getAbsolutePosition());if(!t||n)return void this.setMusic(this.musics.wandering);if(!a.isLanded()&&null!==a.getTargetLandingPad())return void this.setMusic(this.musics.straussBlueDanube);var l=a.getInternals().getWarpDrive();switch(u.model.type){case"blackHole":this.setMusicFromSelection([this.musics.soaring]);return;case"mandelbulb":case"juliaSet":case"mandelbox":case"sierpinskiPyramid":case"mengerSponge":case"darkKnight":if(c<100*u.getBoundingRadius())return void this.setMusicFromSelection([this.musics.spacialWinds,this.musics.echoesOfTime]);break;case"star":case"neutronStar":case"telluricPlanet":case"telluricSatellite":case"gasPlanet":case"custom":break;case"spaceStation":case"spaceElevator":if((null===l||l.isDisabled())&&c<10*u.getBoundingRadius())return void this.setMusic(this.musics.equatorialComplex)}if(null!==l&&l.isEnabled()){var h=[this.musics.atlanteanTwilight,this.musics.infinitePerspective,this.musics.mesmerize];this.setMusicFromSelection(h);return}if(!a.isLanded()&&(null===l||l.isDisabled())){var d=[this.musics.thatZenMoment,this.musics.deepRelaxation,this.musics.peaceOfMind];this.setMusicFromSelection(d);return}if(i||a.isLanded()){var f=[this.musics.thatZenMoment,this.musics.deepRelaxation,this.musics.peaceOfMind,this.musics.mesmerize,this.musics.reawakening];this.setMusicFromSelection(f);return}this.setMusic(null)}}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),eB=n(76448),eF=n(13997),ej=n(54571),eU=n(90141),eW=n(94311),eG=n(3818),eH=n(61094),eq=n(21080),ez=n(25187),eQ=n(81629),eK=n(51091),eY=n(34041),eX=n(43548),eJ=n(78706),eZ=n(88996),e$=function(){var e;function t(){var e,n;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");n=void 0,(e="htmlRoot")in this?Object.defineProperty(this,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[e]=n,this.htmlRoot=this.createPanelHTML()}return e=[{key:"createPanelHTML",value:function(){var e=document.createElement("div");e.className="sidePanel";var t=document.createElement("h2");t.textContent=eJ.A.t("sidePanel:about"),e.appendChild(t);var n=document.createElement("p");n.className="aboutText",n.style.whiteSpace="pre-line",n.textContent=eJ.A.t("sidePanel:aboutText"),e.appendChild(n);var r=document.createElement("p");r.className="signature",r.textContent="Barth\xe9lemy Pal\xe9ologue",e.appendChild(r);var a=document.createElement("p");a.className="aboutText",a.style.whiteSpace="pre-line",a.innerHTML=eJ.A.t("sidePanel:emailContact"),e.appendChild(a);var i=document.createElement("h3");return i.textContent=eJ.A.t("sidePanel:specialThanks"),e.appendChild(i),["In\xe8s Varhol, my partner, for her unwavering love and support","Christine Lombez, my mother, for her trust and for shaping the person I am today","Victor Pal\xe9ologue, my brother, for inspiring my journey into programming","Eric Lombez, my uncle, for giving me my first capable computer, paving the way for my passion for computer graphics","Martin Molli and Malo Lereste, my friends and Elite Dangerous squadmates, for their invaluable feedback and camaraderie that enriched this project."].forEach(function(t){var n=document.createElement("p");n.textContent=t,e.appendChild(n)}),e}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),e0=function(){var e;function t(){var e,n;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");n=void 0,(e="htmlRoot")in this?Object.defineProperty(this,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[e]=n,this.htmlRoot=this.createPanelHTML()}return e=[{key:"createPanelHTML",value:function(){var e=document.createElement("div");e.className="sidePanel";var t=document.createElement("h2");t.textContent=eJ.A.t("sidePanel:contribute"),e.appendChild(t);var n=document.createElement("h3");n.textContent=eJ.A.t("sidePanel:bugReports"),e.appendChild(n);var r=document.createElement("p");r.innerHTML=eJ.A.t("sidePanel:bugReportsText"),e.appendChild(r);var a=document.createElement("h3");a.textContent=eJ.A.t("sidePanel:translation"),e.appendChild(a);var i=document.createElement("p");i.innerHTML=eJ.A.t("sidePanel:translationText"),e.appendChild(i);var o=document.createElement("h3");o.textContent=eJ.A.t("sidePanel:knowHowToCode"),e.appendChild(o);var s=document.createElement("p");s.innerHTML=eJ.A.t("sidePanel:knowHowToCodeText"),e.appendChild(s);var u=document.createElement("h3");u.textContent=eJ.A.t("sidePanel:supportFinancially"),e.appendChild(u);var c=document.createElement("p");return c.innerHTML=eJ.A.t("sidePanel:supportFinanciallyText"),e.appendChild(c),e}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),e1=function(){var e;function t(){var e,n;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");n=void 0,(e="htmlRoot")in this?Object.defineProperty(this,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[e]=n,this.htmlRoot=this.createPanelHTML()}return e=[{key:"createPanelHTML",value:function(){var e=document.createElement("div");e.className="sidePanel";var t=document.createElement("h2");t.textContent=eJ.A.t("sidePanel:credits"),e.appendChild(t);var n=document.createElement("h3");n.textContent=eJ.A.t("sidePanel:contributors"),e.appendChild(n);var r=document.createElement("div");r.className="contributors-section";var a=document.createElement("img");a.src="https://contrib.rocks/image?repo=BarthPaleologue/CosmosJourneyer",a.alt="Contributors",a.className="contributors-image",r.appendChild(a),e.appendChild(r);var i=document.createElement("h3");i.textContent=eJ.A.t("sidePanel:programming"),e.appendChild(i),['Created by <a target="_blank" href="https://barth.paleologue.fr">Barth\xe9lemy Pal\xe9ologue</a>','Webpack configuration & Refactorings by <a target="_blank" href="https://github.com/happy44300">Martin Molli</a>','Built with <a target="_blank" href="https://www.babylonjs.com/">BabylonJS</a> and its awesome forum','Planet surface rendering based on <a target="_blank" href="https://www.youtube.com/watch?v=hHGshzIXFWY&list=PLRL3Z3lpLmH3PNGZuDNf2WXnLTHpN9hXy">SimonDev\'s 3D World Generation video series</a>','Star colors made using <a target="_blank" href="https://www.fourmilab.ch/documents/specrend/">John Walker\'s "Colour Rendering of Spectra"</a>','Black hole shader based on <a target="_blank" href="https://www.shadertoy.com/view/tsBXW3">set111 implementation on shadertoy</a>','Lens flare shader based on <a target="_blank" href="https://www.shadertoy.com/view/wlcyzj">TheNosiriN implementation on shadertoy</a>','Fractal raymarching based on <a target="_blank" href="https://www.shadertoy.com/view/tsc3Rj">Nazlbit\'s implementation</a> and <a target="_blank" href="https://www.shadertoy.com/view/wdjGWR">Myro\'s implementation</a> on shadertoy','Mandelbox raymarching based on <a target="_blank" href="https://www.shadertoy.com/view/llGXDR">geoff\'s implementation</a> on shadertoy','Sierpinski raymarching based on <a target="_blank" href="https://www.shadertoy.com/view/4dl3Wl">Inigo Quilez\'s implementation</a> on shadertoy','Menger Sponge raymarching based on <a target="_blank" href="https://www.shadertoy.com/view/XttfRN">reinder\'s implementation</a> on shadertoy'].forEach(function(t){var n=document.createElement("p");n.innerHTML=t,e.appendChild(n)});var o=document.createElement("h3");o.textContent=eJ.A.t("sidePanel:materials"),e.appendChild(o),['Awesome PBR materials from <a target="_blank" href="https://freepbr.com">freepbr.com</a>','Solar panel material from <a target="_blank" href="https://ambientCG.com">ambientCG.com</a>, licensed under the Creative Commons CC0 1.0 Universal License.','Jupiter texture from <a target="_blank" href="https://www.solarsystemscope.com/textures/">Solar System Scope</a>, licensed under Attribution 4.0 International license','Saturn texture from <a target="_blank" href="https://www.solarsystemscope.com/textures/">Solar System Scope</a>, licensed under Attribution 4.0 International license','Uranus texture from <a target="_blank" href="https://www.solarsystemscope.com/textures/">Solar System Scope</a>, licensed under Attribution 4.0 International license','Neptune texture from <a target="_blank" href="https://www.solarsystemscope.com/textures/">Solar System Scope</a>, licensed under Attribution 4.0 International license','Saturn rings from <a target="_blank" href="https://www.solarsystemscope.com/textures/">Solar System Scope</a>, licensed under Attribution 4.0 International license','Uranus rings from <a target="_blank" href="https://planetpixelemporium.com/uranus.html">Planet Pixel Emporium</a>, licensed under the terms specified <a target="_blank" href="https://planetpixelemporium.com/planets.html">here</a>'].forEach(function(t){var n=document.createElement("p");n.innerHTML=t,e.appendChild(n)});var s=document.createElement("h3");s.textContent=eJ.A.t("sidePanel:icons"),e.appendChild(s),['Gasoline icon created by <a target="_blank" href="https://www.flaticon.com/free-icons/gasoline" title="gasoline icons">Freepik - Flaticon</a>','Astronomy icons created by <a target="_blank" href="https://www.flaticon.com/free-icons/astronomay" title="astronomy icons">3ab2ou - Flaticon</a>','Space-station icons created by <a target="_blank" href="https://www.flaticon.com/free-icons/space-station" title="space-station icons">Freepik - Flaticon</a>','Space-exploration icons created by <a target="_blank" href="https://www.flaticon.com/free-icons/space-exploration" title="space-exploration icons">Dewi Sari - Flaticon</a>','Expand icons created by <a target="_blank" href="https://www.flaticon.com/free-icons/expand" title="expand icons">Google - Flaticon</a>','Play icons created by <a target="_blank" href="https://www.flaticon.com/free-icons/play" title="play icons">Freepik - Flaticon</a>','Download icons created by <a target="_blank" href="https://www.flaticon.com/free-icons/download" title="download icons">Debi Alpa Nugraha - Flaticon</a>','Delete icons created by <a target="_blank" href="https://www.flaticon.com/free-icons/delete" title="delete icons">bqlqn - Flaticon</a>','Edit icons created by <a target="_blank" href="https://www.flaticon.com/free-icons/edit" title="edit icons">Kiranshastry - Flaticon</a>','Information icons created by <a target="_blank" href="https://www.flaticon.com/free-icons/information" title="information icons">Freepik - Flaticon</a>','Link icons created by <a target="_blank" href="https://www.flaticon.com/free-icons/link" title="link icons">Creaticca Creative Agency - Flaticon</a>','Exploration icons created by <a target="_blank" href="https://www.flaticon.com/free-icons/exploration" title="exploration icons">SprSprK - Flaticon</a>','Launch icons created by <a target="_blank" href="https://www.flaticon.com/free-icons/launch" title="launch icons">Freepik - Flaticon</a>','Barter icons created by <a target="_blank" href="https://www.flaticon.com/free-icons/barter" title="barter icons">Ahmad Roaayala - Flaticon</a>'].forEach(function(t){var n=document.createElement("p");n.innerHTML=t,e.appendChild(n)});var u=document.createElement("h3");u.textContent=eJ.A.t("sidePanel:font"),e.appendChild(u);var c=document.createElement("p");c.innerHTML='<a target="_blank" href="https://typodermicfonts.com/nasalization/">Nasalization font</a> by Typodermic Fonts',e.appendChild(c);var l=document.createElement("h3");l.textContent=eJ.A.t("sidePanel:music"),e.appendChild(l),['<a target="_blank" href="https://freesound.org/people/Andrewkn/sounds/455855/">Wandering</a> by Andrewkn','"Deep Relaxation" <a target="_blank" href="https://incompetech.com">Kevin MacLeod (incompetech.com)</a> Licensed under Creative Commons: By <a target="_blank" href="http://creativecommons.org/licenses/by/4.0/">Attribution 4.0 License</a>','"Atlantean Twilight" <a target="_blank" href="https://incompetech.com">Kevin MacLeod (incompetech.com)</a> Licensed under Creative Commons: By <a target="_blank" href="http://creativecommons.org/licenses/by/4.0/">Attribution 4.0 License</a>','"That Zen Moment" <a target="_blank" href="https://incompetech.com">Kevin MacLeod (incompetech.com)</a> Licensed under Creative Commons: By <a target="_blank" href="http://creativecommons.org/licenses/by/4.0/">Attribution 4.0 License</a>','"Echoes of Time v2" <a target="_blank" href="https://incompetech.com">Kevin MacLeod (incompetech.com)</a> Licensed under Creative Commons: By <a target="_blank" href="http://creativecommons.org/licenses/by/4.0/">Attribution 4.0 License</a>','"Infinite Perspective" <a target="_blank" href="https://incompetech.com">Kevin MacLeod (incompetech.com)</a> Licensed under Creative Commons: By <a target="_blank" href="http://creativecommons.org/licenses/by/4.0/">Attribution 4.0 License</a>','"Peace of Mind" <a target="_blank" href="https://incompetech.com">Kevin MacLeod (incompetech.com)</a> Licensed under Creative Commons: By <a target="_blank" href="http://creativecommons.org/licenses/by/4.0/">Attribution 4.0 License</a>','"Spacial Winds" <a target="_blank" href="https://incompetech.com">Kevin MacLeod (incompetech.com)</a> Licensed under Creative Commons: By <a target="_blank" href="http://creativecommons.org/licenses/by/4.0/">Attribution 4.0 License</a>','"Mesmerize" <a target="_blank" href="https://incompetech.com">Kevin MacLeod (incompetech.com)</a> Licensed under Creative Commons: By <a target="_blank" href="http://creativecommons.org/licenses/by/4.0/">Attribution 4.0 License</a>','"Reawakening" <a target="_blank" href="https://incompetech.com">Kevin MacLeod (incompetech.com)</a> Licensed under Creative Commons: By <a target="_blank" href="http://creativecommons.org/licenses/by/4.0/">Attribution 4.0 License</a>','"Equatorial Complex" <a target="_blank" href="https://incompetech.com">Kevin MacLeod (incompetech.com)</a> Licensed under Creative Commons: By <a target="_blank" href="http://creativecommons.org/licenses/by/4.0/">Attribution 4.0 License</a>','"Soaring" <a target="_blank" href="https://incompetech.com">Kevin MacLeod (incompetech.com)</a> Licensed under Creative Commons: By <a target="_blank" href="http://creativecommons.org/licenses/by/4.0/">Attribution 4.0 License</a>'].forEach(function(t){var n=document.createElement("p");n.innerHTML=t,e.appendChild(n)});var h=document.createElement("h3");return h.textContent=eJ.A.t("sidePanel:soundEffects"),e.appendChild(h),['<a target="_blank" href="https://freesound.org/people/DrMinky/sounds/166186/">Menu screen mouse over</a> by <a target="_blank" href="https://freesound.org/people/DrMinky/">DrMinky</a> | License: <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">Attribution 4.0</a>','<a target="_blank" href="https://freesound.org/people/lollosound/sounds/386992/">17 DISTORZIONE.WAV</a> by <a target="_blank" href="https://freesound.org/people/lollosound/">lollosound</a> | License: <a target="_blank" href="http://creativecommons.org/publicdomain/zero/1.0/">Creative Commons 0</a>','<a target="_blank" href="https://freesound.org/people/NHumphrey/sounds/204418/">Large Engine.wav</a> by <a target="_blank" href="https://freesound.org/people/NHumphrey/">NHumphrey</a> | License: <a target="_blank" href="http://creativecommons.org/publicdomain/zero/1.0/">Creative Commons 0</a>','<a target="_blank" href="https://freesound.org/people/MATRIXXX_/sounds/702805/">Futuristic Inspect Sound, UI, or In-Game Notification.wav</a> by <a target="_blank" href="https://freesound.org/people/MATRIXXX_/">MATRIXXX_</a> | License: <a target="_blank" href="http://creativecommons.org/publicdomain/zero/1.0/">Creative Commons 0</a>','<a target="_blank" href="https://freesound.org/people/Timbre/sounds/539503/">endless acceleration.flac</a> by <a target="_blank" href="https://freesound.org/people/Timbre/">Timbre</a> | License: <a target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/">Attribution NonCommercial 4.0</a>','<a target="_blank" href="https://freesound.org/people/LimitSnap_Creations/sounds/318688/">Rocket Thrust effect.wav</a> by <a target="_blank" href="https://freesound.org/people/LimitSnap_Creations/">LimitSnap_Creations</a> | License: <a target="_blank" href="http://creativecommons.org/publicdomain/zero/1.0/">Creative Commons 0</a>','<a target="_blank" href="https://freesound.org/people/original_sound/sounds/372197/">Error Bleep 4</a> by <a target="_blank" href="https://freesound.org/people/original_sound/">original_sound</a> | License: <a target="_blank" href="http://creativecommons.org/licenses/by/3.0/">Attribution 3.0</a>','<a target="_blank" href="https://freesound.org/people/copyc4t/sounds/554089/">Echoed Blip</a> by <a target="_blank" href="https://freesound.org/people/copyc4t/">copyc4t</a> | License: <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">Attribution 4.0</a>','<a target="_blank" href="https://youtu.be/cKkDMiGUbUw?si=dHDqjFx57tgOfNeL">The Blue Danube Waltz</a> from Johann Strauss','Spaceship voice generated using <a target="_blank" href="https://elevenlabs.io">ElevenLabs</a>'].forEach(function(t){var n=document.createElement("p");n.innerHTML=t,e.appendChild(n)}),e}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),e2=n(74459);function e4(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var e3=function(){var e;function t(e,n){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");e4(this,"htmlRoot",void 0),e4(this,"content",void 0),this.content=new e2.X(e,n),this.htmlRoot=this.createPanelHTML()}return e=[{key:"createPanelHTML",value:function(){var e=document.createElement("div");e.className="sidePanel";var t=document.createElement("h2");return t.textContent=eJ.A.t("sidePanel:loadSave"),e.appendChild(t),e.appendChild(this.content.htmlRoot),e}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),e5=n(93039),e6=n(92985),e7=n(36960),e8=n(90160),e9=n(82886),te=n(17966),tt=n(84369),tn=n(34547),tr=n(35789),ta=n(3211),ti=[eG.i,ta.n,tn.S,tt._,e9.b,te.Z,tr.I],to=n(95369);function ts(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function tu(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function tc(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function tl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var i=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ts(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ts(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var th=function(){var e;function t(e){var n,r;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");r=void 0,(n="htmlRoot")in this?Object.defineProperty(this,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[n]=r,this.htmlRoot=this.createPanelHTML(e)}return e=[{key:"createPanelHTML",value:function(e){var t=document.createElement("div");t.className="sidePanel";var n=document.createElement("h2");n.textContent=eJ.A.t("sidePanel:settings"),t.appendChild(n);var r=document.createElement("div");r.classList.add("settings-section");var a=document.createElement("h3");a.textContent=eJ.A.t("sidePanel:audioSettings"),a.style.fontFamily="Nasalization, sans-serif",r.appendChild(a);var i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.gap="10px",i.style.fontFamily="Nasalization, sans-serif";var o=document.createElement("label");o.textContent=eJ.A.t("sidePanel:musicVolume"),o.style.fontFamily="Nasalization, sans-serif",o.style.minWidth="80px",o.style.flexGrow="1",o.style.color="#fff",o.style.fontWeight="bold",o.style.letterSpacing="1px",o.style.fontSize="1.1em",i.appendChild(o);var s=document.createElement("input");s.type="range",s.min="0",s.max="1",s.step="0.05",s.value=e.getVolume().toString(),s.style.margin="0 10px",s.style.accentColor="#ffffff";var u=document.createElement("span");return u.textContent=(100*parseFloat(s.value)).toFixed(0)+"%",u.style.fontFamily="Nasalization, sans-serif",u.style.color="#fff",u.style.backgroundColor="#1a1a1a",u.style.padding="2px 8px",u.style.borderRadius="4px",u.style.fontWeight="bold",u.style.fontSize="1em",u.style.marginLeft="4px",u.style.minWidth="50px",u.style.textAlign="center",s.addEventListener("input",function(){var t=parseFloat(s.value);u.textContent=(100*t).toFixed(0)+"%",e.setSoundtrackVolume(t)}),i.appendChild(s),i.appendChild(u),r.appendChild(i),t.appendChild(r),this.initializeInputControls(t),t}},{key:"initializeInputControls",value:function(e){var t;return(t=function(){var t;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var c=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(n){switch(n.label){case 0:return[4,(0,to.t)()];case 1:return t=n.sent(),ti.forEach(function(n){var r=document.createElement("div");r.classList.add("map");var a=document.createElement("h3");a.textContent=n.name.replace(/([A-Z])/g," $1").trim(),r.appendChild(a);var i=!0,o=!1,s=void 0;try{for(var u,c=Object.entries(n.map)[Symbol.iterator]();!(i=(u=c.next()).done);i=!0)!function(){var e=tl(u.value,2),n=e[0],a=e[1],i=new Map;(tc(a,e5.A)?a.bindings:a.action.bindings).forEach(function(e){if(tc(e.control,e7.A))(0,e8.Fd)(e.control,t).forEach(function(e){var t,n=tl(e,2),r=n[0],a=n[1];i.has(r)||i.set(r,[]),null==(t=i.get(r))||t.push(a)});else if(tc(e.control,e6.OG)){var n,r=(0,e8.Xi)(e.control,t);i.has("BUTTON")||i.set("BUTTON",[]),null==(n=i.get("BUTTON"))||n.push(r)}else if(tc(e.control,e6.hn))(0,e8.Lc)(e.control,t).forEach(function(e){var t,n=tl(e,2),r=n[0],a=n[1];i.has(r)||i.set(r,[]),null==(t=i.get(r))||t.push(a)});else if(tc(e.control,e6.mD))(0,e8.Jc)(e.control).forEach(function(e){var t,n=tl(e,2),r=n[0],a=n[1];i.has(r)||i.set(r,[]),null==(t=i.get(r))||t.push(a)});else if(tc(e.control,e6.fX))(0,e8.qA)().forEach(function(e){var t,n=tl(e,2),r=n[0],a=n[1];i.has(r)||i.set(r,[]),null==(t=i.get(r))||t.push(a)});else throw Error("Unknown control type")});var o=document.createElement("div"),s=document.createElement("p");if(s.textContent=n.replace(/([A-Z])/g," $1").trim(),o.appendChild(s),1===i.size){o.classList.add("actionSingle");var c=document.createElement("div");c.classList.add("valuesContainer");var l=!0,h=!1,d=void 0;try{for(var f,p=i.values()[Symbol.iterator]();!(l=(f=p.next()).done);l=!0)f.value.forEach(function(e){var t=document.createElement("p");t.innerText=e,c.appendChild(t)})}catch(e){h=!0,d=e}finally{try{l||null==p.return||p.return()}finally{if(h)throw d}}o.appendChild(c)}else o.classList.add("actionMultiple"),i.forEach(function(e,t){var n=document.createElement("div");n.classList.add("subAction");var r=document.createElement("p");r.textContent=t;var a=document.createElement("div");a.classList.add("valuesContainer"),e.forEach(function(e){var t=document.createElement("p");t.innerText=e,a.appendChild(t)}),n.appendChild(r),n.appendChild(a),o.appendChild(n)});r.appendChild(o)}()}catch(e){o=!0,s=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw s}}e.appendChild(r)}),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,a){var i=t.apply(e,n);function o(e){tu(i,r,a,o,s,"next",e)}function s(e){tu(i,r,a,o,s,"throw",e)}o(void 0)})})()}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),td=n(69121),tf=n(55721),tp=n(44124),tm=n(80617);function tv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ty=function e(){var t=this;if(!(this instanceof e))throw TypeError("Cannot call a class as a function");tv(this,"htmlRoot",void 0),tv(this,"onTutorialSelected",new eK.cP),tv(this,"availableTutorials",void 0),this.htmlRoot=document.createElement("div"),this.htmlRoot.classList.add("tutorialsMenuContainer"),this.availableTutorials=[new td.$,new tm.M,new tp.r,new tf.F],this.availableTutorials.forEach(function(e){var n=document.createElement("div");n.classList.add("tutorial");var r=document.createElement("h2");r.textContent=e.getTitle(),n.appendChild(r);var a=document.createElement("img");a.src=e.coverImageSrc,a.alt=e.getTitle(),n.appendChild(a);var i=document.createElement("p");i.textContent=e.getDescription(),n.appendChild(i),t.htmlRoot.appendChild(n),n.addEventListener("click",function(){t.onTutorialSelected.notifyObservers(e)})});var n=document.createElement("p");n.classList.add("moreWillCome"),n.textContent=eJ.A.t("tutorials:common:moreWillComeSoon"),this.htmlRoot.appendChild(n)};function tb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tg=function(){var e;function t(){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");tb(this,"htmlRoot",void 0),tb(this,"content",void 0),this.content=new ty,this.htmlRoot=this.createPanelHTML()}return e=[{key:"createPanelHTML",value:function(){var e=document.createElement("div");e.classList.add("sidePanel","tutorials");var t=document.createElement("h2");t.textContent=eJ.A.t("sidePanel:tutorials"),e.appendChild(t);var n=document.createElement("p");return n.setAttribute("align","center"),n.textContent=eJ.A.t("sidePanel:tutorialsWarning"),e.appendChild(n),e.appendChild(this.content.htmlRoot),e}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}();function tw(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function tS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tP=((r={})[r.LOAD_SAVE=0]="LOAD_SAVE",r[r.SETTINGS=1]="SETTINGS",r[r.TUTORIALS=2]="TUTORIALS",r[r.CONTRIBUTE=3]="CONTRIBUTE",r[r.CREDITS=4]="CREDITS",r[r.ABOUT=5]="ABOUT",r),tk=function(){var e;function t(e,n,r,a){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");tS(this,"activeRightPanel",null),tS(this,"loadSavePanel",void 0),tS(this,"settingsPanel",void 0),tS(this,"tutorialsPanel",void 0),tS(this,"contributePanel",void 0),tS(this,"creditsPanel",void 0),tS(this,"aboutPanel",void 0),tS(this,"starSystemDatabase",void 0),tS(this,"saveBackend",void 0),this.starSystemDatabase=e,this.saveBackend=n,this.loadSavePanel=new e3(e,r),this.attachCloseButton(this.loadSavePanel.htmlRoot),document.body.appendChild(this.loadSavePanel.htmlRoot),this.settingsPanel=new th(a),this.attachCloseButton(this.settingsPanel.htmlRoot),document.body.appendChild(this.settingsPanel.htmlRoot),this.tutorialsPanel=new tg,this.attachCloseButton(this.tutorialsPanel.htmlRoot),document.body.appendChild(this.tutorialsPanel.htmlRoot),this.contributePanel=new e0,this.attachCloseButton(this.contributePanel.htmlRoot),document.body.appendChild(this.contributePanel.htmlRoot),this.creditsPanel=new e1,this.attachCloseButton(this.creditsPanel.htmlRoot),document.body.appendChild(this.creditsPanel.htmlRoot),this.aboutPanel=new e$,this.attachCloseButton(this.aboutPanel.htmlRoot),document.body.appendChild(this.aboutPanel.htmlRoot)}return e=[{key:"panelFromType",value:function(e){switch(e){case 0:return this.loadSavePanel.htmlRoot;case 1:return this.settingsPanel.htmlRoot;case 2:return this.tutorialsPanel.htmlRoot;case 3:return this.contributePanel.htmlRoot;case 4:return this.creditsPanel.htmlRoot;case 5:return this.aboutPanel.htmlRoot;default:return(0,f.dr)(e)}}},{key:"attachCloseButton",value:function(e){var t=this;if(!e.querySelector(".close-button")){var n=document.createElement("button");n.innerText="X",n.className="close-button",n.addEventListener("click",function(){t.hideActivePanel()}),e.appendChild(n)}}},{key:"toggleActivePanel",value:function(e){var t;return(t=function(){var t;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var c=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(n){switch(n.label){case 0:if(t=this.panelFromType(e),this.activeRightPanel===t)return[2];if(0!==e)return[3,2];return[4,this.loadSavePanel.content.populateCmdrList(this.starSystemDatabase,this.saveBackend)];case 1:n.sent(),n.label=2;case 2:return null!==this.activeRightPanel&&this.hideActivePanel(),this.activeRightPanel=t,t.classList.add("visible"),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,a){var i=t.apply(e,n);function o(e){tw(i,r,a,o,s,"next",e)}function s(e){tw(i,r,a,o,s,"throw",e)}o(void 0)})}).call(this)}},{key:"hideActivePanel",value:function(){null!==this.activeRightPanel&&(this.activeRightPanel.classList.remove("visible"),this.activeRightPanel=null)}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}();function tE(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function tC(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){tE(i,r,a,o,s,"next",e)}function s(e){tE(i,r,a,o,s,"throw",e)}o(void 0)})}}function tA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tT(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var c=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var tL=function(){var e;function t(e,n,r,a){var i=this;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");tA(this,"scene",void 0),tA(this,"controls",void 0),tA(this,"starSystemView",void 0),tA(this,"starSystemModel",void 0),tA(this,"onStartObservable",new eK.cP),tA(this,"onContributeObservable",new eK.cP),tA(this,"onCreditsObservable",new eK.cP),tA(this,"onAboutObservable",new eK.cP),tA(this,"htmlRoot",void 0),tA(this,"title",void 0),tA(this,"version",void 0),tA(this,"startButton",void 0),tA(this,"loadSaveButton",void 0),tA(this,"settingsButton",void 0),tA(this,"tutorialsButton",void 0),tA(this,"contributeButton",void 0),tA(this,"creditsButton",void 0),tA(this,"aboutButton",void 0),tA(this,"menuItems",void 0),tA(this,"sidePanels",void 0),tA(this,"universeObjectId",void 0),tA(this,"startAnimationDurationSeconds",5),this.sidePanels=e,this.starSystemView=n,this.scene=this.starSystemView.scene,this.controls=this.starSystemView.getDefaultControls(),this.starSystemView.setUIEnabled(!1);var o=r.getSystemModelFromCoordinates({localX:.49137314641446483,localY:.48043087077347135,localZ:.38353311777279386,starSectorX:0,starSectorY:0,starSectorZ:0});if(null===o)throw Error("Cannot find system");var s=o.planets.at(1);if(void 0===s)throw Error("Cannot find planet with index 2");this.universeObjectId=(0,H.Ei)(s,o),this.starSystemModel=o;var u=this.createMainMenuHTML();this.htmlRoot=u.htmlRoot,this.title=u.title,this.version=u.version,this.startButton=u.startButton,this.loadSaveButton=u.loadSaveButton,this.settingsButton=u.settingsButton,this.tutorialsButton=u.tutorialsButton,this.contributeButton=u.contributeButton,this.creditsButton=u.creditsButton,this.aboutButton=u.aboutButton,this.menuItems=u.menuItems,this.htmlRoot.style.display="none",document.body.appendChild(this.htmlRoot);var c=this.version.querySelector("a");if(null===c)throw Error("version link does not exist!");c.textContent="Alpha ".concat(eZ.rE),[this.startButton,this.loadSaveButton,this.settingsButton,this.tutorialsButton,this.contributeButton,this.creditsButton,this.aboutButton].forEach(function(e){e.addEventListener("mouseenter",function(){a.playNow(eB.Wo.HOVER)}),e.addEventListener("click",function(){a.playNow(eB.Wo.CLICK)})}),this.startButton.addEventListener("click",function(){i.startAnimation(function(){return i.onStartObservable.notifyObservers()})}),this.loadSaveButton.addEventListener("click",function(){return tC(function(){return tT(this,function(e){switch(e.label){case 0:return[4,this.sidePanels.toggleActivePanel(tP.LOAD_SAVE)];case 1:return e.sent(),[2]}})}).call(i)}),this.sidePanels.loadSavePanel.content.onLoadSaveObservable.add(function(){i.hide()}),this.settingsButton.addEventListener("click",function(){return tC(function(){return tT(this,function(e){switch(e.label){case 0:return[4,this.sidePanels.toggleActivePanel(tP.SETTINGS)];case 1:return e.sent(),[2]}})}).call(i)}),this.tutorialsButton.addEventListener("click",function(){return tC(function(){return tT(this,function(e){switch(e.label){case 0:return[4,this.sidePanels.toggleActivePanel(tP.TUTORIALS)];case 1:return e.sent(),[2]}})}).call(i)}),this.contributeButton.addEventListener("click",function(){return tC(function(){return tT(this,function(e){switch(e.label){case 0:return[4,this.sidePanels.toggleActivePanel(tP.CONTRIBUTE)];case 1:return e.sent(),this.onContributeObservable.notifyObservers(),[2]}})}).call(i)}),this.creditsButton.addEventListener("click",function(){return tC(function(){return tT(this,function(e){switch(e.label){case 0:return[4,this.sidePanels.toggleActivePanel(tP.CREDITS)];case 1:return e.sent(),this.onCreditsObservable.notifyObservers(),[2]}})}).call(i)}),this.aboutButton.addEventListener("click",function(){return tC(function(){return tT(this,function(e){switch(e.label){case 0:return[4,this.sidePanels.toggleActivePanel(tP.ABOUT)];case 1:return e.sent(),this.onAboutObservable.notifyObservers(),[2]}})}).call(i)})}return e=[{key:"createMainMenuHTML",value:function(){var e=document.createElement("div");e.className="mainMenu";var t=document.createElement("h1");t.textContent="Cosmos Journeyer",e.appendChild(t);var n=document.createElement("p");n.className="version";var r=document.createElement("a");r.target="_blank",r.href="https://github.com/BarthPaleologue/CosmosJourneyer/releases",n.appendChild(r),e.appendChild(n);var a=document.createElement("ul");a.className="leftSideMenu";var i=document.createElement("li");i.textContent=eJ.A.t("mainMenu:newJourney"),a.appendChild(i);var o=document.createElement("li");o.textContent=eJ.A.t("mainMenu:loadSave"),a.appendChild(o);var s=document.createElement("li");s.textContent=eJ.A.t("mainMenu:settings"),a.appendChild(s);var u=document.createElement("li");u.textContent=eJ.A.t("mainMenu:tutorials"),a.appendChild(u);var c=document.createElement("li");c.textContent=eJ.A.t("mainMenu:contribute"),a.appendChild(c);var l=document.createElement("li");l.textContent=eJ.A.t("mainMenu:credits"),a.appendChild(l);var h=document.createElement("li");return h.textContent=eJ.A.t("mainMenu:about"),a.appendChild(h),e.appendChild(a),{htmlRoot:e,title:t,version:n,startButton:i,loadSaveButton:o,settingsButton:s,tutorialsButton:u,contributeButton:c,creditsButton:l,aboutButton:h,menuItems:a}}},{key:"init",value:function(){return tC(function(){var e;return tT(this,function(t){switch(t.label){case 0:return e=this,[4,this.starSystemView.loadStarSystem(this.starSystemModel)];case 1:return t.sent(),this.starSystemView.onInitStarSystem.addOnce(function(){return tC(function(){var e,t;return tT(this,function(n){switch(n.label){case 0:return[4,this.starSystemView.switchToDefaultControls(!1)];case 1:if(n.sent(),e="blackHole"===this.starSystemModel.stellarObjects[0].type?8:2,void 0===(t=this.starSystemView.getStarSystem().getOrbitalObjectById(this.universeObjectId.idInSystem)))throw Error("Could not find object with ID ".concat(JSON.stringify(this.universeObjectId)));return(0,eU.$Q)(this.controls,t,this.starSystemView.getStarSystem(),e),[2]}})}).call(e)}),this.starSystemView.targetCursorLayer.setEnabled(!1),this.htmlRoot.style.display="block",[2]}})}).call(this)}},{key:"startAnimation",value:function(e){var t=this;this.sidePanels.hideActivePanel();var n=this.starSystemView.getStarSystem(),r=this.controls.getTransform().forward,a=n.getOrbitalObjectById(this.universeObjectId.idInSystem),i=n.getCelestialBodies().find(function(e){return e===a});if(void 0===i)throw Error("No corresponding celestial body found");var o=i.getTransform().getAbsolutePosition().subtract(this.controls.getTransform().getAbsolutePosition()).normalize(),u=s.Pq.Cross(r,o),c=s.Pq.GetAngleBetweenVectors(r,o,u),l=(0,eU.og)(i,n,.9),h=new eY.J(this.controls.getTransform(),u,c,this.startAnimationDurationSeconds),d=new eX.k(this.controls.getTransform(),l,this.startAnimationDurationSeconds);this.title.animate([{marginTop:this.title.style.marginTop,opacity:1},{marginTop:"30vh",opacity:0}],{duration:1e3*this.startAnimationDurationSeconds,easing:"ease-in-out",fill:"forwards"});var f=function(){var r=t.scene.getEngine().getDeltaTime()/1e3;if(d.isFinished()||d.update(r),h.isFinished()){t.scene.onBeforePhysicsObservable.removeCallback(f),t.htmlRoot.style.display="none",t.starSystemView.setUIEnabled(!0),e();return}h.update(r),t.controls.getActiveCamera().getViewMatrix(),n.applyFloatingOrigin(),t.starSystemView.postProcessManager.update(0),n.updateShaders(0)};this.scene.onBeforePhysicsObservable.add(f),this.hideMenu(),this.hideVersion()}},{key:"hideVersion",value:function(){this.version.style.transform="translateY(100%)"}},{key:"hideMenu",value:function(){this.menuItems.style.left="-20%"}},{key:"hide",value:function(){this.hideVersion(),this.hideMenu(),this.sidePanels.hideActivePanel(),this.htmlRoot.style.display="none"}},{key:"isVisible",value:function(){return"none"!==this.htmlRoot.style.display}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),tI=n(12577);function tM(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function tO(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){tM(i,r,a,o,s,"next",e)}function s(e){tM(i,r,a,o,s,"throw",e)}o(void 0)})}}function tR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t_(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var c=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var tx=function(){var e;function t(e,n){var r=this;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");tR(this,"rootNode",void 0),tR(this,"mask",void 0),tR(this,"screenshotButton",void 0),tR(this,"shareButton",void 0),tR(this,"contributeButton",void 0),tR(this,"tutorialsButton",void 0),tR(this,"settingsButton",void 0),tR(this,"loadButton",void 0),tR(this,"saveButton",void 0),tR(this,"resumeButton",void 0),tR(this,"sidePanels",void 0),tR(this,"onScreenshot",new eK.cP),tR(this,"onShare",new eK.cP),tR(this,"onSave",new eK.cP),tR(this,"onResume",new eK.cP),this.sidePanels=e,this.mask=document.createElement("div"),this.mask.id="pauseMask",this.rootNode=document.createElement("ul"),this.rootNode.id="pauseMenu",this.rootNode.classList.add("leftSideMenu");var a=function(e,t){var n=document.createElement("li");return n.id=e,n.classList.add("button"),n.innerText=eJ.A.t(t),r.rootNode.appendChild(n),n};this.resumeButton=a("resumeButton","pauseMenu:resume"),this.saveButton=a("saveButton","pauseMenu:save"),this.loadButton=a("loadButton","pauseMenu:load"),this.tutorialsButton=a("pauseTutorialsButton","pauseMenu:tutorials"),this.settingsButton=a("pauseSettingsButton","pauseMenu:settings"),this.contributeButton=a("pauseContributeButton","pauseMenu:contribute"),this.screenshotButton=a("screenshotButton","pauseMenu:screenshot"),this.shareButton=a("shareButton","pauseMenu:share"),this.mask.appendChild(this.rootNode),document.body.appendChild(this.mask),this.screenshotButton.addEventListener("click",function(){return r.onScreenshot.notifyObservers()}),this.shareButton.addEventListener("click",function(){return r.onShare.notifyObservers()}),this.contributeButton.addEventListener("click",function(){return tO(function(){return t_(this,function(e){switch(e.label){case 0:return n.playNow(eB.Wo.CLICK),[4,this.sidePanels.toggleActivePanel(tP.CONTRIBUTE)];case 1:return e.sent(),[2]}})}).call(r)}),this.tutorialsButton.addEventListener("click",function(){return tO(function(){return t_(this,function(e){switch(e.label){case 0:return n.playNow(eB.Wo.CLICK),[4,this.sidePanels.toggleActivePanel(tP.TUTORIALS)];case 1:return e.sent(),[2]}})}).call(r)}),this.settingsButton.addEventListener("click",function(){return tO(function(){return t_(this,function(e){switch(e.label){case 0:return n.playNow(eB.Wo.CLICK),[4,this.sidePanels.toggleActivePanel(tP.SETTINGS)];case 1:return e.sent(),[2]}})}).call(r)}),this.loadButton.addEventListener("click",function(){return tO(function(){return t_(this,function(e){switch(e.label){case 0:return n.playNow(eB.Wo.CLICK),[4,this.sidePanels.toggleActivePanel(tP.LOAD_SAVE)];case 1:return e.sent(),[2]}})}).call(r)}),this.saveButton.addEventListener("click",function(){return r.onSave.notifyObservers()}),this.resumeButton.addEventListener("click",function(){return r.onResume.notifyObservers()}),this.rootNode.querySelectorAll("li").forEach(function(e){e.addEventListener("mouseenter",function(){n.playNow(eB.Wo.HOVER)}),e.addEventListener("click",function(){n.playNow(eB.Wo.CLICK)})}),this.setVisibility(!1)}return e=[{key:"setVisibility",value:function(e){this.rootNode.style.display=e?"grid":"none",this.mask.style.display=e?"block":"none",e||this.sidePanels.hideActivePanel()}},{key:"isVisible",value:function(){return"none"!==this.rootNode.style.display}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),tD=n(58168),tV=n(18076),tN=n(9323);function tB(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function tF(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){tB(i,r,a,o,s,"next",e)}function s(e){tB(i,r,a,o,s,"throw",e)}o(void 0)})}}function tj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tU(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tW(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var c=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var tG=function(){var e,t;function r(e,t,n,a,i,o,u){var c=this;if(!(this instanceof r))throw TypeError("Cannot call a class as a function");tU(this,"engine",void 0),tU(this,"assets",void 0),tU(this,"starSystemView",void 0),tU(this,"starMap",void 0),tU(this,"musicConductor",void 0),tU(this,"soundPlayer",void 0),tU(this,"tts",void 0),tU(this,"mainMenu",void 0),tU(this,"pauseMenu",void 0),tU(this,"sidePanels",void 0),tU(this,"tutorialLayer",void 0),tU(this,"activeView",void 0),tU(this,"state",0),tU(this,"videoRecorder",null),tU(this,"player",void 0),tU(this,"backend",void 0),tU(this,"elapsedSeconds",0),tU(this,"autoSavePeriodSeconds",300),tU(this,"autoSaveTimerSeconds",0),tU(this,"isAutoSaveEnabled",!0),this.engine=t,this.assets=n,this.player=e,this.player.onNameChangedObservable.add(function(){return tF(function(){return tW(this,function(e){switch(e.label){case 0:return[4,this.createManualSave()];case 1:return e.sent(),[2]}})}).call(c)}),this.backend=i,this.player.discoveries.uploaded.forEach(function(e){return tF(function(){return tW(this,function(t){switch(t.label){case 0:return[4,this.backend.encyclopaedia.contributeDiscoveryIfNew(e)];case 1:return t.sent(),[2]}})}).call(c)}),this.starSystemView=a,this.starSystemView.onBeforeJump.add(function(){return tF(function(){return tW(this,function(e){switch(e.label){case 0:return[4,this.createAutoSave()];case 1:return e.sent(),[2]}})}).call(c)}),this.starSystemView.onAfterJump.add(function(){return tF(function(){var e;return tW(this,function(t){switch(t.label){case 0:return e=this,[4,this.createAutoSave()];case 1:if(t.sent(),this.player.tutorials.fuelScoopingCompleted)return[3,3];return[4,this.tutorialLayer.setTutorial(new tf.F)];case 2:t.sent(),this.tutorialLayer.onQuitTutorial.addOnce(function(){e.player.tutorials.fuelScoopingCompleted=!0}),t.label=3;case 3:return[2]}})}).call(c)}),this.starSystemView.onNewDiscovery.add(function(){return tF(function(){return tW(this,function(e){switch(e.label){case 0:return[4,this.createAutoSave()];case 1:return e.sent(),[2]}})}).call(c)}),this.musicConductor=new eN(this.assets.audio.musics,this.starSystemView),this.soundPlayer=o,this.tts=u,this.starMap=new eq.b(this.player,this.engine,this.backend.encyclopaedia,this.backend.universe,this.soundPlayer),this.starMap.onTargetSetObservable.add(function(e){c.starSystemView.setSystemAsTarget(e)}),this.starMap.detachControl(),this.starSystemView.attachControl(),this.activeView=this.starSystemView,o.setInstanceMask(ex.U.STAR_SYSTEM_VIEW),this.tutorialLayer=new tD.O(this.soundPlayer),document.body.appendChild(this.tutorialLayer.root),this.sidePanels=new tk(this.backend.universe,this.backend.save,this.soundPlayer,this.musicConductor),this.sidePanels.loadSavePanel.content.onLoadSaveObservable.add(function(e){t.onEndFrameObservable.addOnce(function(){return tF(function(){return tW(this,function(t){switch(t.label){case 0:if(!this.isPaused())return[3,2];return[4,this.createAutoSave()];case 1:t.sent(),t.label=2;case 2:return[4,this.resume()];case 3:return t.sent(),this.starSystemView.setUIEnabled(!0),[4,this.loadSave(e)];case 4:return t.sent(),[2]}})}).call(c)})}),this.mainMenu=new tL(this.sidePanels,this.starSystemView,this.backend.universe,this.soundPlayer),this.mainMenu.onStartObservable.add(function(){return tF(function(){var e,t,n;return tW(this,function(r){switch(r.label){case 0:return e=this,[4,this.tutorialLayer.setTutorial(new td.$)];case 1:return r.sent(),this.tutorialLayer.onQuitTutorial.addOnce(function(){e.player.tutorials.flightCompleted=!0}),[4,this.starSystemView.switchToSpaceshipControls()];case 2:return r.sent(),t=this.starSystemView.getSpaceshipControls().getTransform().getAbsolutePosition(),n=this.starSystemView.getStarSystem().getOrbitalFacilities().reduce(function(e,n){return s.Pq.DistanceSquared(t,n.getTransform().getAbsolutePosition())<s.Pq.DistanceSquared(t,e.getTransform().getAbsolutePosition())?n:e}),this.starSystemView.setTarget(n),[4,this.createAutoSave()];case 3:return r.sent(),[2]}})}).call(c)}),this.sidePanels.tutorialsPanel.content.onTutorialSelected.add(function(e){return tF(function(){return tW(this,function(t){switch(t.label){case 0:if(this.mainMenu.isVisible())return[3,3];return[4,this.createAutoSave()];case 1:return t.sent(),[4,(0,eQ.QD)(eJ.A.t("tutorials:common:loadTutorialWillLeaveGame"),this.soundPlayer)];case 2:if(!t.sent())return[2];t.label=3;case 3:return this.sidePanels.hideActivePanel(),this.loadTutorial(e),[2]}})}).call(c)}),this.starSystemView.getSpaceshipControls().onToggleWarpDrive.add(function(e){return tF(function(){var t,n,r,a,i,o;return tW(this,function(u){switch(u.label){case 0:if(t=this,e||this.player.tutorials.stationLandingCompleted||null===(r=(n=this.starSystemView.getSpaceshipControls()).getClosestLandableFacility())||(a=n.getTransform().getAbsolutePosition(),i=r.getTransform().position,o=10*r.getBoundingRadius(),s.Pq.DistanceSquared(a,i)>Math.pow(o,2)))return[2];return[4,this.tutorialLayer.setTutorial(new tm.M)];case 1:return u.sent(),this.tutorialLayer.onQuitTutorial.addOnce(function(){t.player.tutorials.stationLandingCompleted=!0}),[2]}})}).call(c)}),this.starSystemView.getSpaceshipControls().onCompleteLanding.add(function(){return tF(function(){return tW(this,function(e){switch(e.label){case 0:return[4,this.createAutoSave()];case 1:return e.sent(),[2]}})}).call(c)}),this.starSystemView.onInitStarSystem.add(function(){var e=c.starSystemView.getStarSystem().model;c.starMap.setCurrentStarSystem(e.coordinates)}),this.starSystemView.spaceStationLayer.onTakeOffObservable.add(function(){return tF(function(){var e;return tW(this,function(t){switch(t.label){case 0:if(e=this,this.player.tutorials.starMapCompleted)return[2];return[4,this.tutorialLayer.setTutorial(new tp.r)];case 1:return t.sent(),this.tutorialLayer.onQuitTutorial.addOnce(function(){e.player.tutorials.starMapCompleted=!0}),[2]}})}).call(c)}),this.pauseMenu=new tx(this.sidePanels,this.soundPlayer),this.pauseMenu.onResume.add(function(){return c.resume()}),this.pauseMenu.onScreenshot.add(function(){return c.takeScreenshot()}),this.pauseMenu.onShare.add(function(){c.engine.onEndFrameObservable.addOnce(function(){return tF(function(){var e,t,n;return tW(this,function(r){switch(r.label){case 0:return e=this,[4,this.generateSaveData()];case 1:if((t=r.sent()).player.uuid=C.w.SHARED_POSITION_SAVE_UUID,null!==(n=(0,A.fe)(t)))return[3,3];return[4,(0,eQ.sQ)("Could not create a shareable link.",this.soundPlayer)];case 2:case 4:return r.sent(),[2];case 3:return[4,navigator.clipboard.writeText(n.toString()).then(function(){(0,tI.UI)(tI.I9.GENERAL,tI.yg.INFO,eJ.A.t("notifications:copiedToClipboard"),2e3,e.soundPlayer)})]}})}).call(c)})}),this.pauseMenu.onSave.add(function(){return tF(function(){return tW(this,function(e){switch(e.label){case 0:return[4,this.createManualSave()];case 1:return e.sent()?(0,tI.UI)(tI.I9.GENERAL,tI.yg.SUCCESS,eJ.A.t("notifications:saveOk"),2e3,this.soundPlayer):(0,tI.UI)(tI.I9.GENERAL,tI.yg.ERROR,eJ.A.t("notifications:cantSaveTutorial"),2e3,this.soundPlayer),[2]}})}).call(c)}),window.addEventListener("blur",function(){c.mainMenu.isVisible()||c.starSystemView.isLoadingSystem()||c.pause()}),window.addEventListener("mouseleave",function(){c.mainMenu.isVisible()||c.starSystemView.isLoadingSystem()||c.pause()}),window.addEventListener("resize",function(){c.engine.resize(!0)}),window.addEventListener("beforeunload",function(){return tF(function(){return tW(this,function(e){switch(e.label){case 0:if(this.mainMenu.isVisible())return[2];return[4,this.createAutoSave()];case 1:return e.sent(),[2]}})}).call(c)}),eG.i.map.toggleStarMap.on("complete",function(){return tF(function(){return tW(this,function(e){switch(e.label){case 0:if(this.mainMenu.isVisible())return[2];return[4,this.toggleStarMap()];case 1:return e.sent(),[2]}})}).call(c)}),eG.i.map.screenshot.on("complete",function(){return tF(function(){return tW(this,function(e){switch(e.label){case 0:if(this.mainMenu.isVisible())return[2];return[4,this.takeScreenshot()];case 1:return e.sent(),[2]}})}).call(c)}),eG.i.map.videoCapture.on("complete",function(){return tF(function(){return tW(this,function(e){switch(e.label){case 0:if(this.mainMenu.isVisible())return[2];return[4,this.takeVideoCapture()];case 1:return e.sent(),[2]}})}).call(c)}),eG.i.map.togglePause.on("complete",function(){!c.mainMenu.isVisible()&&(c.isPaused()||c.pause())}),window.CosmosJourneyer=this}return e=[{key:"pause",value:function(){this.isPaused()||this.mainMenu.isVisible()||(this.state=2,document.exitPointerLock(),this.activeView===this.starSystemView&&this.starSystemView.stopBackgroundSounds(),this.soundPlayer.playNow(eB.Wo.OPEN_PAUSE_MENU),this.pauseMenu.setVisibility(!0))}},{key:"resume",value:function(){return tF(function(){var e;return tW(this,function(t){switch(t.label){case 0:if(!this.isPaused())return[2];if(this.state=1,this.soundPlayer.playNow(eB.Wo.CLICK),this.pauseMenu.setVisibility(!1),!(this.activeView===this.starSystemView&&this.starSystemView.scene.getActiveControls().shouldLockPointer()))return[3,2];return[4,null==(e=this.engine.getRenderingCanvas())?void 0:e.requestPointerLock()];case 1:t.sent(),t.label=2;case 2:return[2]}})}).call(this)}},{key:"isPaused",value:function(){return 2===this.state}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return tF(function(){var t;return tW(this,function(n){switch(n.label){case 0:if(t=this,e)return[3,2];return[4,this.mainMenu.init()];case 1:n.sent(),n.label=2;case 2:return this.starSystemView.initStarSystem(),this.engine.runRenderLoop(function(){var e=t.engine.getDeltaTime()/1e3;t.elapsedSeconds+=e,t.player.timePlayedSeconds+=e,t.autoSaveTimerSeconds+=e,t.autoSaveTimerSeconds>=t.autoSavePeriodSeconds&&(t.autoSaveTimerSeconds%=t.autoSavePeriodSeconds,t.mainMenu.isVisible()||t.starSystemView.isJumpingBetweenSystems()||t.createAutoSave()),(0,tI.E$)(e),t.musicConductor.update(t.isPaused(),t.activeView===t.starSystemView,t.mainMenu.isVisible(),e),t.soundPlayer.update(),t.tts.update(),t.isPaused()||t.activeView.render()}),this.state=1,[2]}})}).call(this)}},{key:"toggleStarMap",value:function(){return tF(function(){var e,t;return tW(this,function(n){switch(n.label){case 0:if(this.activeView!==this.starSystemView)return[3,1];return this.soundPlayer.setInstanceMask(ex.U.STAR_MAP_VIEW),this.starSystemView.targetCursorLayer.setEnabled(!1),document.exitPointerLock(),this.starSystemView.detachControl(),this.starMap.attachControl(),e=this.starMap,this.activeView=e,e.focusOnCurrentSystem(),[3,3];case 1:if(this.starMap.detachControl(),this.starSystemView.attachControl(),this.soundPlayer.setInstanceMask(ex.U.STAR_SYSTEM_VIEW),this.activeView=this.starSystemView,!this.starSystemView.scene.getActiveControls().shouldLockPointer())return[3,3];return[4,null==(t=this.engine.getRenderingCanvas())?void 0:t.requestPointerLock()];case 2:n.sent(),n.label=3;case 3:return[2]}})}).call(this)}},{key:"takeScreenshot",value:function(){return tF(function(){var e;return tW(this,function(t){switch(t.label){case 0:if(null!==(e=this.activeView.getMainScene().activeCamera))return[3,2];return[4,(0,eQ.sQ)("Cannot take screenshot: camera is null",this.soundPlayer)];case 1:return t.sent(),[2,!1];case 2:return u.S0.CreateScreenshot(this.engine,e,{precision:1}),[2,!0]}})}).call(this)}},{key:"takeVideoCapture",value:function(){return tF(function(){return tW(this,function(e){switch(e.label){case 0:if(!c.g.IsSupported(this.engine))return console.warn("Your browser does not support video recording!"),[2];if(null===this.videoRecorder&&(this.videoRecorder=new c.g(this.engine,{fps:60,recordChunckSize:3e6,mimeType:"video/webm;codecs=h264"})),!this.videoRecorder.isRecording)return[3,1];return this.videoRecorder.stopRecording(),[3,3];case 1:return[4,this.videoRecorder.startRecording("planetEngine.webm",Number(prompt("Enter video duration in seconds","10"))).then()];case 2:e.sent(),e.label=3;case 3:return[2]}})}).call(this)}},{key:"getCurrentUniverseCoordinates",value:function(e){var t=this.starSystemView.getStarSystem(),n=e.getAbsolutePosition(),r=t.getNearestOrbitalObject(n),a=(0,H.Ei)(r.model,t.model),i=r.getTransform().computeWorldMatrix(!0).clone().invert(),o=s.Pq.TransformCoordinates(n,i);o.length()<1.1*r.getBoundingRadius()&&o.copyFromFloats(0,0,5*r.getBoundingRadius());var u=e.absoluteRotationQuaternion,c=r.getTransform().absoluteRotationQuaternion.clone().invert(),l=u.multiply(c);return{type:"relative",universeObjectId:a,position:{x:o.x,y:o.y,z:o.z},rotation:{x:l.x,y:l.y,z:l.z,w:l.w}}}},{key:"generateSaveData",value:function(){return tF(function(){var e,t,n,r,a,i;return tW(this,function(o){switch(o.label){case 0:if(t=(e=this.starSystemView.getSpaceshipControls()).getSpaceship(),n=this.getCurrentUniverseCoordinates(e.getTransform()),r=t.isLandedAtFacility()?{type:"atStation",universeObjectId:n.universeObjectId}:n,a=this.activeView.getMainScene().activeCamera,i="",!a)return[3,2];return[4,u.S0.CreateScreenshotAsync(this.engine,a,{width:320,height:180,precision:.8})];case 1:i=o.sent(),o.label=2;case 2:return[2,{uuid:crypto.randomUUID(),timestamp:Date.now(),player:eH.a.Serialize(this.player),playerLocation:{type:"inSpaceship",shipId:t.id},shipLocations:tU({},t.id,r),thumbnail:i}]}})}).call(this)}},{key:"createManualSave",value:function(){return tF(function(){var e,t,n,r,a;return tW(this,function(i){switch(i.label){case 0:if(this.player.uuid===C.w.TUTORIAL_SAVE_UUID)return[2,!1];if(this.player.uuid!==C.w.SHARED_POSITION_SAVE_UUID)return[3,2];return this.player.uuid=crypto.randomUUID(),n=(t=this.player).setName,[4,(0,eQ.TF)(eJ.A.t("spaceStation:cmdrNameChangePrompt"),this.player.getName(),this.soundPlayer)];case 1:n.apply(t,[null!=(e=i.sent())?e:"Python"]),i.label=2;case 2:return[4,this.generateSaveData()];case 3:return a=(r=i.sent()).player.uuid,[2,this.backend.save.addManualSave(a,r)]}})}).call(this)}},{key:"setAutoSaveEnabled",value:function(e){this.isAutoSaveEnabled=e}},{key:"createAutoSave",value:function(){return tF(function(){var e,t;return tW(this,function(n){switch(n.label){case 0:if(!this.isAutoSaveEnabled)return[2];return[4,this.generateSaveData()];case 1:if((t=(e=n.sent()).player.uuid)===C.w.SHARED_POSITION_SAVE_UUID||t===C.w.TUTORIAL_SAVE_UUID)return[2];return[4,this.backend.save.addAutoSave(t,e)];case 2:return n.sent(),this.autoSaveTimerSeconds=0,[2]}})}).call(this)}},{key:"downloadSaveFile",value:function(){var e=this;this.engine.onEndFrameObservable.addOnce(function(){return tF(function(){var e,t,n,r;return tW(this,function(a){switch(a.label){case 0:return[4,this.generateSaveData()];case 1:return e=new Blob([JSON.stringify(a.sent())],{type:"application/json"}),t=URL.createObjectURL(e),(n=document.createElement("a")).href=t,r=new Date().toLocaleString().replace(/[^0-9a-zA-Z]/g,"_"),n.download="CMDR_".concat(this.player.getName(),"_").concat(r,".json"),n.click(),[2]}})}).call(e)})}},{key:"loadTutorial",value:function(e){var t=this;this.engine.onEndFrameObservable.addOnce(function(){return tF(function(){var t,n;return tW(this,function(r){switch(r.label){case 0:if(this.mainMenu.hide(),this.mainMenu.isVisible())return[3,2];return[4,this.createAutoSave()];case 1:r.sent(),r.label=2;case 2:if((t=e.getSaveData(this.backend.universe)).success)return[3,4];return console.error(t.error),[4,(0,eQ.sQ)(eJ.A.t("The tutorial save has errors and could not be loaded! Check the console for more information."),this.soundPlayer)];case 3:return r.sent(),[2];case 4:return[4,this.loadSave(t.value)];case 5:return r.sent(),this.player.uuid=C.w.TUTORIAL_SAVE_UUID,[4,this.resume()];case 6:return r.sent(),[4,this.tutorialLayer.setTutorial(e)];case 7:return r.sent(),this.starSystemView.setUIEnabled(!0),n=this.starSystemView.getStarSystem().getNearestOrbitalObject(this.starSystemView.scene.getActiveControls().getTransform().getAbsolutePosition()),(0,tN.t5)(this.starSystemView.getSpaceshipControls().getTransform(),n.getTransform().getAbsolutePosition(),this.starSystemView.scene.useRightHandedSystem),[2]}})}).call(t)})}},{key:"loadSave",value:function(e){return tF(function(){var t,n,r,a,i,o;return tW(this,function(s){switch(s.label){case 0:if(t=this,"inSpaceship"===(n=e.playerLocation).type)return[3,1];return r=n,[3,6];case 1:if(void 0!==(a=e.shipLocations[n.shipId]))return[3,3];return[4,(0,eQ.sQ)("Player is in spaceship, but said spaceship does not exist. The loading procedure has been aborted.",this.soundPlayer)];case 2:case 4:return s.sent(),[2];case 3:if("inSpaceship"!==a.type)return[3,5];return[4,(0,eQ.sQ)("Spaceship inside spaceships is not yet supported. The loading procedure has been aborted.",this.soundPlayer)];case 5:r=a,s.label=6;case 6:if(null!==(i=this.backend.universe.getSystemModelFromCoordinates(r.universeObjectId.systemCoordinates)))return[3,8];return[4,(0,eQ.sQ)("Cannot load universe coordinates: system model not found. The loading procedure has been aborted.",this.soundPlayer)];case 7:return s.sent(),[2];case 8:return o=eH.a.Deserialize(e.player,this.backend.universe),this.player.copyFrom(o,this.backend.universe),this.player.discoveries.uploaded.forEach(function(e){return tF(function(){return tW(this,function(t){switch(t.label){case 0:return[4,this.backend.encyclopaedia.contributeDiscoveryIfNew(e)];case 1:return t.sent(),[2]}})}).call(t)}),[4,this.starSystemView.resetPlayer()];case 9:return s.sent(),this.engine.loadingScreen.displayLoadingUI(),[4,this.starSystemView.loadStarSystem(i)];case 10:if(s.sent(),0!==this.state)return[3,12];return[4,this.init(!0)];case 11:return s.sent(),[3,13];case 12:this.starSystemView.initStarSystem(),s.label=13;case 13:if("inSpaceship"!==n.type)return[3,15];return[4,this.starSystemView.switchToSpaceshipControls()];case 14:return s.sent(),[3,17];case 15:return[4,this.starSystemView.switchToCharacterControls()];case 16:s.sent(),s.label=17;case 17:return[4,this.loadLocation(r)];case 18:return s.sent(),this.starSystemView.getSpaceshipControls().getActiveCamera().getViewMatrix(!0),this.starSystemView.getStarSystem().applyFloatingOrigin(),this.engine.loadingScreen.hideLoadingUI(),null!==this.player.currentItinerary&&this.starSystemView.setSystemAsTarget(this.player.currentItinerary[1]),[2]}})}).call(this)}},{key:"loadLocation",value:function(e){return tF(function(){return tW(this,function(t){switch(t.label){case 0:if("relative"!==e.type)return[3,2];return[4,this.loadRelativeLocation(e)];case 1:return t.sent(),[3,4];case 2:if("atStation"!==e.type)return[3,4];return[4,this.loadAtStationLocation(e)];case 3:t.sent(),t.label=4;case 4:return[2]}})}).call(this)}},{key:"loadRelativeLocation",value:function(e){return tF(function(){var t,n,r,a,i,u;return tW(this,function(c){switch(c.label){case 0:if(t=this.starSystemView.scene.getActiveControls().getTransform(),void 0!==(r=(n=this.starSystemView.getStarSystem()).getOrbitalObjectById(e.universeObjectId.idInSystem)))return[3,2];return a=n.getStellarObjects()[0],(0,eU.fE)(a,new s.Pq(0,0,4*a.getBoundingRadius()),new o.PT(0,0,0,1),t),[4,(0,eQ.sQ)("The object you are trying to spawn near to could not be found. You will spawn around the first stellar object of the system instead.",this.soundPlayer)];case 1:return c.sent(),[2];case 2:return(0,eU.fE)(r,new s.Pq(e.position.x,e.position.y,e.position.z),new o.PT(e.rotation.x,e.rotation.y,e.rotation.z,e.rotation.w),t),(i=s.Pq.Distance(t.getAbsolutePosition(),r.getTransform().getAbsolutePosition()))<1.1*(u=r.getBoundingRadius())&&(i<.1?t.position.addInPlace(new s.Pq(0,0,5*u)):t.position.scaleInPlace(1.1*u/i)),this.starSystemView.targetCursorLayer.setTarget(r),this.starSystemView.spaceShipLayer.setTarget(r.getTransform()),[2]}})}).call(this)}},{key:"loadAtStationLocation",value:function(e){return tF(function(){var t,n,r,a,i,u;return tW(this,function(c){switch(c.label){case 0:if(t=this.starSystemView.scene.getActiveControls().getTransform(),void 0!==(r=(n=this.starSystemView.getStarSystem()).getOrbitalObjectById(e.universeObjectId.idInSystem))&&("spaceStation"===r.type||"spaceElevator"===r.type))return[3,2];return a=n.getStellarObjects()[0],(0,eU.fE)(a,new s.Pq(0,0,4*a.getBoundingRadius()),new o.PT(0,0,0,1),t),[4,(0,eQ.sQ)("The space station you are trying to spawn at could not be found. You will spawn around the first stellar object of the system instead.",this.soundPlayer)];case 1:case 3:return c.sent(),[2];case 2:if(void 0!==(i=r.getLandingPadManager().getAvailableLandingPads().at(0)))return[3,4];return u=r,(0,eU.fE)(u,new s.Pq(0,0,4*u.getBoundingRadius()),new o.PT(0,0,0,1),t),[4,(0,eQ.sQ)("There are no available pads at the space station you are trying to spawn at. You have been moved outside of the station instead.",this.soundPlayer)];case 4:return this.starSystemView.getSpaceshipControls().getSpaceship().spawnOnPad(i),[2]}})}).call(this)}}],t=[{key:"CreateAsync",value:function(){return tF(function(){var e,t,o,u,c,d,f,p,m,v,y,b,g,w,S;return tW(this,function(P){switch(P.label){case 0:return e=document.createElement("canvas"),document.body.prepend(e),e.width=window.innerWidth,e.height=window.innerHeight,t=new ej.x(e),[4,G.New()];case 1:if((o=P.sent()).success)return[3,3];return[4,(0,eQ.sQ)(o.error.message,new eB.bk)];case 2:throw P.sent(),o.error;case 3:if(u=o.value,!window.location.search.includes("webgpu"))return[3,5];return[4,i.J.CreateAsync(e,{twgslOptions:{wasmPath:new URL(n(14597),n.b).href,jsPath:new URL(n(9098),n.b).href},audioEngine:!0})];case 4:return d=P.sent(),[3,6];case 5:d=new a.N(e,!0,{preserveDrawingBuffer:!0,useHighPrecisionMatrix:!0,doNotHandleContextLost:!0,audioEngine:!0}),P.label=6;case 6:return(c=d).useReverseDepthBuffer=!0,c.loadingScreen=t,c.loadingScreen.displayLoadingUI(),window.addEventListener("resize",function(){e.width=window.innerWidth,e.height=window.innerHeight,c.resize(!0)}),[4,(0,eJ.L)()];case 7:return P.sent(),console.log("API: ".concat(c.isWebGPU?"WebGPU":"WebGL")),console.log("GPU detected: ".concat(c.extractDriverInfo())),[4,(0,h.A)()];case 8:var k,E;return f=P.sent(),console.log("Havok initialized"),p=eH.a.Default(u.universe),(m=new eW.B(c)).useRightHandedSystem=!0,(v=new l.P(!0,f)).setVelocityLimits(1e4,1e4),m.enablePhysics(s.Pq.Zero(),v),(y=new tV.C).addProgressCallback(function(e,n){t.setProgress(e,n)}),[4,(k=m,(E=function(){var e,t,n;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var c=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:var a;return e=(a=function(){var e,t,n,r;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var c=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(a){switch(a.label){case 0:var i,o,s;return e=(i=function(){var e,t,n,r,a,i,o,s,u,c,l,h,d,f,p,m,v;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var c=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(b){switch(b.label){case 0:return t=(e=function(e,t,n){return null==y||y.startTask(),new Promise(function(r){var a=new q.A(e,t,null,function(){r(a)},n)}).then(function(e){return null==y||y.completeTask(),e})})("OuchSound",ey),n=e("EngineRunningSound",ev,{loop:!0}),r=e("MenuHoverSound",eo,{playbackRate:.5}),a=e("MenuSelectSound",eo),i=e("OpenPauseMenuSound",eo,{playbackRate:.75}),o=e("TargetLockSound",em),s=e("TargetUnlockSound",em,{playbackRate:.5}),u=e("EnableWarpDriveSound",el,{playbackRate:2}),c=e("DisableWarpDriveSound",es),l=e("AcceleratingWarpDriveSound",eh,{playbackRate:1,volume:.3,loop:!0}),h=e("DeceleratingWarpDriveSound",ef,{playbackRate:1,volume:.3,loop:!0}),d=e("HyperSpaceSound",ed,{playbackRate:1.5,volume:.25,loop:!0}),f=e("ThrusterSound",eu,{playbackRate:1,volume:.5,loop:!0}),p=e("Success",ep),m=e("Error",ec),v={},[4,t];case 1:return v.ouch=b.sent(),[4,n];case 2:return v.engineRunning=b.sent(),[4,r];case 3:return v.menuHover=b.sent(),[4,a];case 4:return v.menuSelect=b.sent(),[4,i];case 5:return v.openPauseMenu=b.sent(),[4,o];case 6:return v.targetLock=b.sent(),[4,s];case 7:return v.targetUnlock=b.sent(),[4,u];case 8:return v.enableWarpDrive=b.sent(),[4,c];case 9:return v.disableWarpDrive=b.sent(),[4,l];case 10:return v.acceleratingWarpDrive=b.sent(),[4,h];case 11:return v.deceleratingWarpDrive=b.sent(),[4,d];case 12:return v.hyperSpace=b.sent(),[4,f];case 13:return v.thruster=b.sent(),[4,p];case 14:return v.success=b.sent(),[4,m];case 15:return[2,(v.error=b.sent(),v)]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var a=i.apply(e,t);function o(e){eb(a,n,r,o,s,"next",e)}function s(e){eb(a,n,r,o,s,"throw",e)}o(void 0)})})(),t=(o=function(){var e,t,n,r,a,i,o,s,u,c,l,h,d,f,p;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var c=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(m){switch(m.label){case 0:return t=(e=function(e,t,n){return null==y||y.startTask(),new Promise(function(r){var a=new q.A(e,t,null,function(){r(a)},n)}).then(function(e){return null==y||y.completeTask(),e})})("Wandering",z,{loop:!0,streaming:!0}),n=e("StraussBlueDanube",er,{streaming:!0}),r=e("DeepRelaxation",K,{streaming:!0}),a=e("AtlanteanTwilight",Q,{streaming:!0}),i=e("InfinitePerspective",Z,{streaming:!0}),o=e("ThatZenMoment",ea,{streaming:!0}),s=e("EchoesOfTime",Y,{streaming:!0}),u=e("PeaceOfMind",ee,{streaming:!0}),c=e("SpacialWinds",J,{streaming:!0}),l=e("Mesmerize",$,{streaming:!0}),h=e("Reawakening",et,{streaming:!0}),d=e("EquatorialComplex",X,{streaming:!0}),f=e("Soaring",en,{streaming:!0}),p={},[4,t];case 1:return p.wandering=m.sent(),[4,n];case 2:return p.straussBlueDanube=m.sent(),[4,r];case 3:return p.deepRelaxation=m.sent(),[4,a];case 4:return p.atlanteanTwilight=m.sent(),[4,i];case 5:return p.infinitePerspective=m.sent(),[4,o];case 6:return p.thatZenMoment=m.sent(),[4,s];case 7:return p.echoesOfTime=m.sent(),[4,u];case 8:return p.peaceOfMind=m.sent(),[4,c];case 9:return p.spacialWinds=m.sent(),[4,l];case 10:return p.mesmerize=m.sent(),[4,h];case 11:return p.reawakening=m.sent(),[4,d];case 12:return p.equatorialComplex=m.sent(),[4,f];case 13:return[2,(p.soaring=m.sent(),p)]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var a=o.apply(e,t);function i(e){ei(a,n,r,i,s,"next",e)}function s(e){ei(a,n,r,i,s,"throw",e)}i(void 0)})})(),n=(s=function(){var e,t,n,r,a,i,o,s,u,c,l,h,d,f;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var c=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(p){switch(p.label){case 0:return t=(e=function(e,t,n){return null==y||y.startTask(),new Promise(function(r){var a=new q.A(e,t,null,function(){r(a)},n)}).then(function(e){return null==y||y.completeTask(),e})})("InitiatingPlanetaryLanding",ek),n=e("LandingRequestGranted",eC),r=e("LandingComplete",eE),a=e("MissionComplete",eA),i=e("NewDiscovery",eT),o=e("CannotEngageWarpDrive",eg),s=e("WarpDriveEmergencyShutDown",eI),u=e("WarpDriveDisengaged",eL),c=e("EngagingWarpDrive",ew),l=e("FuelScoopingVoice",eS),h=e("FuelScoopingCompleteVoice",eP),d={},f={},[4,t];case 1:return f.initiatingPlanetaryLanding=p.sent(),[4,n];case 2:return f.landingRequestGranted=p.sent(),[4,r];case 3:return f.landingComplete=p.sent(),[4,a];case 4:return f.missionComplete=p.sent(),[4,i];case 5:return f.newDiscovery=p.sent(),[4,o];case 6:return f.cannotEngageWarpDrive=p.sent(),[4,s];case 7:return f.warpDriveEmergencyShutDown=p.sent(),[4,u];case 8:return f.warpDriveDisengaged=p.sent(),[4,c];case 9:return f.engagingWarpDrive=p.sent(),[4,l];case 10:return f.fuelScooping=p.sent(),[4,h];case 11:return[2,(d.charlotte=(f.fuelScoopingComplete=p.sent(),f),d)]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var a=s.apply(e,t);function i(e){eM(a,n,r,i,o,"next",e)}function o(e){eM(a,n,r,i,o,"throw",e)}i(void 0)})})(),r={},[4,e];case 1:return r.sounds=a.sent(),[4,t];case 2:return r.musics=a.sent(),[4,n];case 3:return[2,(r.speakerVoiceLines=a.sent(),r)]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var i=a.apply(e,t);function o(e){eO(i,n,r,o,s,"next",e)}function s(e){eO(i,n,r,o,s,"throw",e)}o(void 0)})})(),t=(0,eR.Q)(k,y),n={},[4,e];case 1:return n.audio=r.sent(),[4,t];case 2:return[2,(n.rendering=r.sent(),n)]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var a=E.apply(e,t);function i(e){e_(a,n,r,i,o,"next",e)}function o(e){e_(a,n,r,i,o,"throw",e)}i(void 0)})})())];case 9:return b=P.sent(),g=new eB.Lr(b.audio.sounds),w=new eF._l(b.audio.speakerVoiceLines),[4,(S=new ez.l(m,p,c,v,u.encyclopaedia,u.universe,g,w,b.rendering)).resetPlayer()];case 10:return P.sent(),[4,(0,to.t)()];case 11:if(null!==P.sent())return[3,13];return[4,(0,eQ.sQ)(eJ.A.t("notifications:unknownKeyboardLayout"),g)];case 12:P.sent(),P.label=13;case 13:return[2,new r(p,c,b,S,u,g,w)]}})})()}}],e&&tj(r.prototype,e),t&&tj(r,t),r}()},90160:function(e,t,n){function r(e){var t=[];return e.children.forEach(function(n,r){"x"===r||"y"===r||t.push([r,e.name])}),t}function a(e,t){var n=[];if(e.children.forEach(function(e,r){if("x"!==r&&"y"!==r){var a,i,o=e.name;o=o.replace("key:",""),o=null!=(i=null==t||null==(a=t.get(o))?void 0:a.toUpperCase())?i:o,n.push([r,o])}}),void 0===n[0]||void 0===n[1]||void 0===n[2]||void 0===n[3])throw Error("DPadComposite keys are undefined");return[n[2],n[0],n[3],n[1]]}function i(){return[["x","pointerX"],["y","pointerY"]]}function o(e,t){var n,r,a=e.name;return a=a.replace("key:",""),a=null!=(r=null==t||null==(n=t.get(a))?void 0:n.toUpperCase())?r:a}function s(e,t){var n=[];return e.children.forEach(function(e,r){var a,i,o=e.name;o=o.replace("key:",""),o=null!=(i=null==t||null==(a=t.get(o))?void 0:a.toUpperCase())?i:o,n.push([r,o])}),n}function u(e,t){return e.action.bindings.map(function(e){return o(e.control,t)})}n.d(t,{Fd:()=>a,Jc:()=>r,Lc:()=>s,Xi:()=>o,hg:()=>u,qA:()=>i})},90141:function(e,t,n){n.d(t,{$Q:()=>c,Ez:()=>u,fE:()=>s,og:()=>l});var r=n(74468),a=n(66144),i=n(9323);function o(e,t){var n=-1,r=t[0];if(void 0===r)throw Error("no bodieees !");var a=!0,i=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var c=s.value,l=e.subtract(c.getTransform().getAbsolutePosition()).length();(-1===n||l<n)&&(r=c,n=l)}}catch(e){i=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(i)throw o}}return r}function s(e,t,n,r){var o=e.getBoundingRadius(),s=t.length(),u=Math.max(2*o,s),c=e.getTransform().getWorldMatrix(),l=a.Pq.TransformCoordinates(t.scale(u/(s+1e-4)),c);r.setAbsolutePosition(l);var h=e.getTransform().absoluteRotationQuaternion,d=n.multiply(h);(0,i.rD)(r,d)}function u(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,s=o(t.getTransform().getAbsolutePosition(),n.getStellarObjects());if(s===t)e.getTransform().setAbsolutePosition(t.getTransform().getAbsolutePosition().add(new a.Pq(0,.2,1).scaleInPlace(t.getBoundingRadius()*r)));else{var u=t.getTransform().getAbsolutePosition().subtract(s.getTransform().getAbsolutePosition()),c=u.length();u.scaleInPlace(1/c);var l=s.getTransform().getAbsolutePosition().add(u.scale(c-r*t.getBoundingRadius()));e.getTransform().setAbsolutePosition(l)}n.translateEverythingNow(e.getTransform().getAbsolutePosition().negate()),e.getTransform().setAbsolutePosition(a.Pq.Zero()),(0,i.t5)(e.getTransform(),t.getTransform().getAbsolutePosition(),e.getTransform().getScene().useRightHandedSystem)}function c(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,s=o(t.getTransform().getAbsolutePosition(),n.getStellarObjects());if(s===t)e.getTransform().setAbsolutePosition(t.getTransform().getAbsolutePosition().add(new a.Pq(0,.2,1).scaleInPlace(t.getBoundingRadius()*r)));else{var u=t.getTransform().getAbsolutePosition().subtract(s.getTransform().getAbsolutePosition()),c=u.length();u.scaleInPlace(1/c);var l=t.getTransform().up,h=a.Pq.Cross(u,l),d=s.getTransform().getAbsolutePosition().add(u.scale(c+1.5*t.getBoundingRadius())).add(h.scale(4*t.getBoundingRadius()));e.getTransform().setAbsolutePosition(d),(0,i.lB)(e.getTransform(),t.getTransform().getAbsolutePosition(),u,-Math.PI/16)}n.translateEverythingNow(e.getTransform().getAbsolutePosition().negate()),e.getTransform().setAbsolutePosition(a.Pq.Zero());var f=s.getTransform().getAbsolutePosition().subtract(t.getTransform().getAbsolutePosition()).normalize(),p=t.getTransform().getAbsolutePosition().add(f.scale(4*t.getBoundingRadius()));(0,i.t5)(e.getTransform(),p,e.getTransform().getScene().useRightHandedSystem),e.getTransform().computeWorldMatrix(!0),(0,i.CL)(e.getTransform(),-Math.PI/8),e.getActiveCamera().getViewMatrix(!0),e.getActiveCamera().getProjectionMatrix(!0)}function l(e,t,n){var i=e.asteroidField;if(null===i)throw Error("The body does not have an asteroid field");var s=e.getTransform().getAbsolutePosition(),u=(0,r.Lerp)(i.innerRadius,i.outerRadius,n),c=o(s,t.getStellarObjects()),l=s.subtract(c.getTransform().getAbsolutePosition()).normalize(),h=e.getTransform().up,d=a.Pq.Cross(l,h).normalize();return s.add(d.scale(u)).add(h.scale(i.patchThickness))}},9323:function(e,t,n){n.d(t,{CL:()=>d,H7:()=>f,Pf:()=>h,Tl:()=>o,e$:()=>u,hQ:()=>c,lB:()=>s,oh:()=>p,rD:()=>l,t5:()=>i});var r=n(76990),a=n(66144);function i(e,t,n){e.lookAt(t),n&&e.rotate(r._0.Y,Math.PI)}function o(e,t){e.setAbsolutePosition(e.getAbsolutePosition().add(t)),e.computeWorldMatrix(!0)}function s(e,t,n,r){e.rotateAround(t,n,r),e.computeWorldMatrix(!0)}function u(e,t,n){e.rotate(t,n,r.$x.WORLD)}function c(e){if(null===e.rotationQuaternion)throw Error("Null quaternion for ".concat(e.name));return e.rotationQuaternion}function l(e,t){e.rotationQuaternion=t,e.computeWorldMatrix(!0)}function h(e,t){if(!t.equalsWithEpsilon(e.up,1e-7)){var n=e.up;u(e,a.Pq.Cross(t,n),-Math.acos(a.Pq.Dot(t,n)))}}function d(e,t){u(e,e.forward,t)}function f(e,t){u(e,e.right,t)}function p(e,t){u(e,e.up,t)}},50551:function(e,t,n){n.d(t,{h:()=>o}),n(67060);var r=n(20088);n(52002);var a=n(72322);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var o=function(e,t,n,o){var s=new r.ov(n.r,n.g,n.b,1),u=t.map(function(){return s});return(0,a.sh)(e,{points:function(e){if(Array.isArray(e))return i(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return i(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),colors:u,updatable:!1},o)}},35743:function(e,t,n){n.d(t,{_I:()=>a,ck:()=>i});var r=n(66144);function a(e,t){for(var n=Math.floor(e.length/16),r=Math.floor(n/t),a=new Float32Array(16*r),i=0;i<r;i++){var o=16*Math.floor(Math.random()*n);a.set(e.subarray(o,o+16),16*i)}return a}function i(e,t,n,a){if(void 0===e[0]||void 0===e[1]||void 0===e[2]||void 0===e[3]||void 0===e[4]||void 0===e[5]||void 0===e[6]||void 0===e[7]||void 0===e[8]||void 0===e[9]||void 0===e[10]||void 0===e[11]||void 0===e[12]||void 0===e[13]||void 0===e[14]||void 0===e[15])throw Error("Matrix is not defined");t.set(e[12],e[13],e[14]);var i=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);a.set(i,i,i);var o=r.uq.Identity();o.setRowFromFloats(0,e[0]/i,e[1]/i,e[2]/i,0),o.setRowFromFloats(1,e[4]/i,e[5]/i,e[6]/i,0),o.setRowFromFloats(2,e[8]/i,e[9]/i,e[10]/i,0),o.setRowFromFloats(3,0,0,0,1),n.copyFrom(r.PT.FromRotationMatrix(o))}},70612:function(e,t,n){function r(e,t,n){return(0x466f45d*e^0x127409f*t^0x4f9ffb7*n)%1e9}function a(e){var t=0x811c9dc5,n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value;t^=s,t=Math.imul(t,0x1000193)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return(t>>>=0)/0xffffffff}n.d(t,{E:()=>r,g:()=>a})},56367:function(e,t,n){n.d(t,{E1:()=>i,F1:()=>s,GI:()=>a,N9:()=>o,kK:()=>u,tR:()=>c});var r=n(19461);function a(e){return e/r.fM}function i(e){return e*r.fM}function o(e){return e/r.C}function s(e){return e+273.15}function u(e){return e*r.AU}function c(e){return Math.PI/180*e}}}]);