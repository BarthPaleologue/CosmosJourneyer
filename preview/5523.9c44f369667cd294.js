/*
 *  This file is part of Cosmos Journeyer
 *
 *  Copyright (C) 2024 Barthélemy Paléologue <barth.paleologue@cosmosjourneyer.com>
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Affero General Public License for more details.
 *
 *  You should have received a copy of the GNU Affero General Public License
 *  along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */

"use strict";(globalThis.webpackChunkcosmos_journeyer=globalThis.webpackChunkcosmos_journeyer||[]).push([["5523"],{15386:function(e,t,i){i.d(t,{$6:()=>_,DG:()=>f,Es:()=>p,Qq:()=>g,W:()=>T,kt:()=>d,vU:()=>m});var s=i(61834),r=i(57423),o=i(51577),n=i(91149),l=i(85296),a=i(70541),h=i(65098),u=i(49087),c=i(5902);function d(e){let t,i,r=[],o=[],l=[],a=[],h=e.width||e.size||1,u=e.height||e.size||1,d=0|(e.subdivisionsX||e.subdivisions||1),p=0|(e.subdivisionsY||e.subdivisions||1);for(t=0;t<=p;t++)for(i=0;i<=d;i++){let e=new s.P(i*h/d-h/2,0,(p-t)*u/p-u/2),r=new s.P(0,1,0);o.push(e.x,e.y,e.z),l.push(r.x,r.y,r.z),a.push(i/d,c.VJ?t/p:1-t/p)}for(t=0;t<p;t++)for(i=0;i<d;i++)r.push(i+1+(t+1)*(d+1)),r.push(i+1+t*(d+1)),r.push(i+t*(d+1)),r.push(i+(t+1)*(d+1)),r.push(i+1+(t+1)*(d+1)),r.push(i+t*(d+1));let g=new n.x;return g.indices=r,g.positions=o,g.normals=l,g.uvs=a,g}function p(e){let t,i,r,o,l=void 0!==e.xmin&&null!==e.xmin?e.xmin:-1,a=void 0!==e.zmin&&null!==e.zmin?e.zmin:-1,h=void 0!==e.xmax&&null!==e.xmax?e.xmax:1,u=void 0!==e.zmax&&null!==e.zmax?e.zmax:1,c=e.subdivisions||{w:1,h:1},d=e.precision||{w:1,h:1},p=[],g=[],_=[],f=[];c.h=c.h<1?1:c.h,c.w=c.w<1?1:c.w,d.w=d.w<1?1:d.w,d.h=d.h<1?1:d.h;let T={w:(h-l)/c.w,h:(u-a)/c.h};for(r=0;r<c.h;r++)for(o=0;o<c.w;o++)!function(e,r,o,n){let l=g.length/3,a=d.w+1;for(t=0;t<d.h;t++)for(i=0;i<d.w;i++){let e=[l+i+t*a,l+(i+1)+t*a,l+(i+1)+(t+1)*a,l+i+(t+1)*a];p.push(e[1]),p.push(e[2]),p.push(e[3]),p.push(e[0]),p.push(e[1]),p.push(e[3])}let h=s.P.Zero(),u=new s.P(0,1,0);for(t=0;t<=d.h;t++)for(i=0,h.z=t*(n-r)/d.h+r;i<=d.w;i++)h.x=i*(o-e)/d.w+e,h.y=0,g.push(h.x,h.y,h.z),_.push(u.x,u.y,u.z),f.push(i/d.w,t/d.h)}(l+o*T.w,a+r*T.h,l+(o+1)*T.w,a+(r+1)*T.h);let m=new n.x;return m.indices=p,m.positions=g,m.normals=_,m.uvs=f,m}function g(e){let t,i,o=[],l=[],a=[],h=[],c=e.colorFilter||new r.Wo(.3,.59,.11),d=e.alphaFilter||0,p=!1;if(e.minHeight>e.maxHeight){p=!0;let t=e.maxHeight;e.maxHeight=e.minHeight,e.minHeight=t}for(t=0;t<=e.subdivisions;t++)for(i=0;i<=e.subdivisions;i++){let r=new s.P(i*e.width/e.subdivisions-e.width/2,0,(e.subdivisions-t)*e.height/e.subdivisions-e.height/2),o=(((r.x+e.width/2)/e.width*(e.bufferWidth-1)|0)+((1-(r.z+e.height/2)/e.height)*(e.bufferHeight-1)|0)*e.bufferWidth)*4,n=e.buffer[o]/255,g=e.buffer[o+1]/255,_=e.buffer[o+2]/255,f=e.buffer[o+3]/255;p&&(n=1-n,g=1-g,_=1-_);let T=n*c.r+g*c.g+_*c.b;f>=d?r.y=e.minHeight+(e.maxHeight-e.minHeight)*T:r.y=e.minHeight-u.kn,e.heightBuffer&&(e.heightBuffer[t*(e.subdivisions+1)+i]=r.y),l.push(r.x,r.y,r.z),a.push(0,0,0),h.push(i/e.subdivisions,1-t/e.subdivisions)}for(t=0;t<e.subdivisions;t++)for(i=0;i<e.subdivisions;i++){let s=i+1+(t+1)*(e.subdivisions+1),r=i+1+t*(e.subdivisions+1),n=i+t*(e.subdivisions+1),a=i+(t+1)*(e.subdivisions+1),h=l[3*s+1]>=e.minHeight,u=l[3*r+1]>=e.minHeight,c=l[3*n+1]>=e.minHeight;h&&u&&c&&(o.push(s),o.push(r),o.push(n)),l[3*a+1]>=e.minHeight&&h&&c&&(o.push(a),o.push(s),o.push(n))}n.x.ComputeNormals(l,o,a);let g=new n.x;return g.indices=o,g.positions=l,g.normals=a,g.uvs=h,g}function _(e,t={},i){let s=new l.E(e,i);return s._setReady(!1),s._subdivisionsX=t.subdivisionsX||t.subdivisions||1,s._subdivisionsY=t.subdivisionsY||t.subdivisions||1,s._width=t.width||1,s._height=t.height||1,s._maxX=s._width/2,s._maxZ=s._height/2,s._minX=-s._maxX,s._minZ=-s._maxZ,d(t).applyToMesh(s,t.updatable),s._setReady(!0),s}function f(e,t,i=null){let s=new o.Kj(e,i);return p(t).applyToMesh(s,t.updatable),s}function T(e,t,i={},s=null){let o,n=i.width||10,u=i.height||10,c=i.subdivisions||1,d=i.minHeight||0,p=i.maxHeight||1,_=i.colorFilter||new r.Wo(.3,.59,.11),f=i.alphaFilter||0,m=i.updatable,y=i.onReady;s=s||h.l.LastCreatedScene;let A=new l.E(e,s);A._subdivisionsX=c,A._subdivisionsY=c,A._width=n,A._height=u,A._maxX=A._width/2,A._maxZ=A._height/2,A._minX=-A._maxX,A._minZ=-A._maxZ,A._setReady(!1),i.passHeightBufferInCallback&&(o=new Float32Array((c+1)*(c+1)));let b=(e,t,i)=>{g({width:n,height:u,subdivisions:c,minHeight:d,maxHeight:p,colorFilter:_,buffer:e,bufferWidth:t,bufferHeight:i,alphaFilter:f,heightBuffer:o}).applyToMesh(A,m),y&&y(A,o),A._setReady(!0)};return"string"==typeof t?a.w1.LoadImage(t,e=>{let t=e.width,i=e.height;s.isDisposed||b(s?.getEngine().resizeImageBitmap(e,t,i),t,i)},i.onError?i.onError:()=>{},s.offlineProvider):b(t.data,t.width,t.height),A}let m={CreateGround:_,CreateGroundFromHeightMap:T,CreateTiledGround:f};n.x.CreateGround=d,n.x.CreateTiledGround=p,n.x.CreateGroundFromHeightMap=g,o.Kj.CreateGround=(e,t,i,s,r,o)=>_(e,{width:t,height:i,subdivisions:s,updatable:o},r),o.Kj.CreateTiledGround=(e,t,i,s,r,o,n,l,a)=>f(e,{xmin:t,zmin:i,xmax:s,zmax:r,subdivisions:o,precision:n,updatable:a},l),o.Kj.CreateGroundFromHeightMap=(e,t,i,s,r,o,n,l,a,h,u)=>T(e,t,{width:i,height:s,subdivisions:r,minHeight:o,maxHeight:n,updatable:a,onReady:h,alphaFilter:u},l)},16091:function(e,t,i){i.d(t,{x:()=>o});var s=i(46363),r=i(99151);class o extends r.c{constructor(e){super(e)}getClassName(){return"DivideBlock"}_buildBlock(e){super._buildBlock(e);let t=this._outputs[0];return e.compilationString+=e._declareOutput(t)+` = ${this.left.associatedVariableName} / ${this.right.associatedVariableName};
`,this}}(0,s.H7)("BABYLON.DivideBlock",o)},1725:function(e,t,i){i.d(t,{S:()=>o});var s=i(46363),r=i(99151);class o extends r.c{constructor(e){super(e)}getClassName(){return"AddBlock"}_buildBlock(e){super._buildBlock(e);let t=this._outputs[0];return e.compilationString+=e._declareOutput(t)+` = ${this.left.associatedVariableName} + ${this.right.associatedVariableName};
`,this}}(0,s.H7)("BABYLON.AddBlock",o)},1793:function(e,t,i){i.d(t,{R:()=>d,m:()=>p});var s=i(21483),r=i(90314),o=i(61834),n=i(35038),l=i(46363),a=i(57645),h=i(40952),u=i(27736),c=i(28465);class d extends n.H{constructor(){super(...arguments),this.GREASED_LINE_HAS_COLOR=!1,this.GREASED_LINE_SIZE_ATTENUATION=!1,this.GREASED_LINE_COLOR_DISTRIBUTION_TYPE_LINE=!1,this.GREASED_LINE_RIGHT_HANDED_COORDINATE_SYSTEM=!1,this.GREASED_LINE_CAMERA_FACING=!0,this.GREASED_LINE_USE_OFFSETS=!1}}class p extends r.n{isCompatible(e){return!0}constructor(e,t,i){i=i||{color:a.Y.DEFAULT_COLOR};let r=new d;r.GREASED_LINE_HAS_COLOR=!!i.color&&!i.useColors,r.GREASED_LINE_SIZE_ATTENUATION=i.sizeAttenuation??!1,r.GREASED_LINE_COLOR_DISTRIBUTION_TYPE_LINE=1===i.colorDistributionType,r.GREASED_LINE_RIGHT_HANDED_COORDINATE_SYSTEM=(t??e.getScene()).useRightHandedSystem,r.GREASED_LINE_CAMERA_FACING=i.cameraFacing??!0,super(e,p.GREASED_LINE_MATERIAL_NAME,200,r,!0,!0),this.colorsTexture=null,this._forceGLSL=!1,this._forceGLSL=i?.forceGLSL||p.ForceGLSL,this._scene=t??e.getScene(),this._engine=this._scene.getEngine(),this._cameraFacing=i.cameraFacing??!0,this.visibility=i.visibility??1,this.useDash=i.useDash??!1,this.dashRatio=i.dashRatio??.5,this.dashOffset=i.dashOffset??0,this.width=i.width?i.width:i.sizeAttenuation?a.Y.DEFAULT_WIDTH_ATTENUATED:a.Y.DEFAULT_WIDTH,this._sizeAttenuation=i.sizeAttenuation??!1,this.colorMode=i.colorMode??0,this._color=i.color??null,this.useColors=i.useColors??!1,this._colorsDistributionType=i.colorDistributionType??0,this.colorsSampling=i.colorsSampling??s.l.NEAREST_NEAREST,this._colors=i.colors??null,this.dashCount=i.dashCount??1,this.resolution=i.resolution??new o.FM(this._engine.getRenderWidth(),this._engine.getRenderHeight()),i.colorsTexture?this.colorsTexture=i.colorsTexture:this._colors?this.colorsTexture=h.u.CreateColorsTexture(`${e.name}-colors-texture`,this._colors,this.colorsSampling,this._scene):(this._color=this._color??a.Y.DEFAULT_COLOR,h.u.PrepareEmptyColorsTexture(this._scene)),this._engine.onDisposeObservable.add(()=>{h.u.DisposeEmptyColorsTexture()})}getAttributes(e){e.push("grl_offsets"),e.push("grl_widths"),e.push("grl_colorPointers"),e.push("grl_counters"),this._cameraFacing?(e.push("grl_previousAndSide"),e.push("grl_nextAndCounters")):e.push("grl_slopes")}getSamplers(e){e.push("grl_colors")}getActiveTextures(e){this.colorsTexture&&e.push(this.colorsTexture)}getUniforms(e=0){let t=[{name:"grl_singleColor",size:3,type:"vec3"},{name:"grl_textureSize",size:2,type:"vec2"},{name:"grl_dashOptions",size:4,type:"vec4"},{name:"grl_colorMode_visibility_colorsWidth_useColors",size:4,type:"vec4"}];return this._cameraFacing&&t.push({name:"grl_projection",size:16,type:"mat4"},{name:"grl_aspect_resolution_lineWidth",size:4,type:"vec4"}),1===e&&t.push({name:"viewProjection",size:16,type:"mat4"}),{ubo:t,vertex:this._cameraFacing&&this._isGLSL(e)?`
                    uniform vec4 grl_aspect_resolution_lineWidth;
                    uniform mat4 grl_projection;
    `:"",fragment:this._isGLSL(e)?`
                    uniform vec4 grl_dashOptions;
                    uniform vec2 grl_textureSize;
                    uniform vec4 grl_colorMode_visibility_colorsWidth_useColors;
                    uniform vec3 grl_singleColor;
    `:""}}get isEnabled(){return!0}bindForSubMesh(e){if(this._cameraFacing){e.updateMatrix("grl_projection",this._scene.getProjectionMatrix()),this._isGLSL(this._material.shaderLanguage)||e.updateMatrix("viewProjection",this._scene.getTransformMatrix());let t=o.jp.Vector4["0"];t.x=this._aspect,t.y=this._resolution.x,t.z=this._resolution.y,t.w=this.width,e.updateVector4("grl_aspect_resolution_lineWidth",t)}let t=o.jp.Vector4["0"];t.x=h.u.BooleanToNumber(this.useDash),t.y=this._dashArray,t.z=this.dashOffset,t.w=this.dashRatio,e.updateVector4("grl_dashOptions",t);let i=o.jp.Vector4["1"];i.x=this.colorMode,i.y=this.visibility,i.z=this.colorsTexture?this.colorsTexture.getSize().width:0,i.w=h.u.BooleanToNumber(this.useColors),e.updateVector4("grl_colorMode_visibility_colorsWidth_useColors",i),this._color&&e.updateColor3("grl_singleColor",this._color);let s=this.colorsTexture??a.Y.EmptyColorsTexture;e.setTexture("grl_colors",s),e.updateFloat2("grl_textureSize",s?.getSize().width??1,s?.getSize().height??1)}prepareDefines(e,t,i){e.GREASED_LINE_HAS_COLOR=!!this.color&&!this.useColors,e.GREASED_LINE_SIZE_ATTENUATION=this._sizeAttenuation,e.GREASED_LINE_COLOR_DISTRIBUTION_TYPE_LINE=1===this._colorsDistributionType,e.GREASED_LINE_RIGHT_HANDED_COORDINATE_SYSTEM=t.useRightHandedSystem,e.GREASED_LINE_CAMERA_FACING=this._cameraFacing,e.GREASED_LINE_USE_OFFSETS=!!i.offsets}getClassName(){return p.GREASED_LINE_MATERIAL_NAME}getCustomCode(e,t=0){return this._isGLSL(t)?(0,u.k)(e,this._cameraFacing):(0,c.k)(e,this._cameraFacing)}dispose(){this.colorsTexture?.dispose(),super.dispose()}get colors(){return this._colors}set colors(e){this.setColors(e)}setColors(e,t=!1,i=!1){let s=this._colors?.length??0;if(this._colors=e,null===e||0===e.length)return void this.colorsTexture?.dispose();if(!t||i)if(this.colorsTexture&&s===e.length&&!i){let t=h.u.Color3toRGBAUint8(e);this.colorsTexture.update(t)}else this.colorsTexture?.dispose(),this.colorsTexture=h.u.CreateColorsTexture(`${this._material.name}-colors-texture`,e,this.colorsSampling,this._scene)}updateLazy(){this._colors&&this.setColors(this._colors,!1,!0)}get dashCount(){return this._dashCount}set dashCount(e){this._dashCount=e,this._dashArray=1/e}get sizeAttenuation(){return this._sizeAttenuation}set sizeAttenuation(e){this._sizeAttenuation=e,this.markAllDefinesAsDirty()}get color(){return this._color}set color(e){this.setColor(e)}setColor(e,t=!1){null===this._color&&null!==e||null!==this._color&&null===e?(this._color=e,t||this.markAllDefinesAsDirty()):this._color=e}get colorsDistributionType(){return this._colorsDistributionType}set colorsDistributionType(e){this._colorsDistributionType=e,this.markAllDefinesAsDirty()}get resolution(){return this._resolution}set resolution(e){this._aspect=e.x/e.y,this._resolution=e}serialize(){let e=super.serialize(),t={colorDistributionType:this._colorsDistributionType,colorsSampling:this.colorsSampling,colorMode:this.colorMode,dashCount:this._dashCount,dashOffset:this.dashOffset,dashRatio:this.dashRatio,resolution:this._resolution,sizeAttenuation:this._sizeAttenuation,useColors:this.useColors,useDash:this.useDash,visibility:this.visibility,width:this.width};return this._colors&&(t.colors=this._colors),this._color&&(t.color=this._color),e.greasedLineMaterialOptions=t,e}parse(e,t,i){super.parse(e,t,i);let s=e.greasedLineMaterialOptions;this.colorsTexture?.dispose(),s.color&&this.setColor(s.color,!0),s.colorDistributionType&&(this.colorsDistributionType=s.colorDistributionType),s.colors&&(this.colors=s.colors),s.colorsSampling&&(this.colorsSampling=s.colorsSampling),s.colorMode&&(this.colorMode=s.colorMode),s.useColors&&(this.useColors=s.useColors),s.visibility&&(this.visibility=s.visibility),s.useDash&&(this.useDash=s.useDash),s.dashCount&&(this.dashCount=s.dashCount),s.dashRatio&&(this.dashRatio=s.dashRatio),s.dashOffset&&(this.dashOffset=s.dashOffset),s.width&&(this.width=s.width),s.sizeAttenuation&&(this.sizeAttenuation=s.sizeAttenuation),s.resolution&&(this.resolution=s.resolution),this.colors?this.colorsTexture=h.u.CreateColorsTexture(`${this._material.name}-colors-texture`,this.colors,this.colorsSampling,t):h.u.PrepareEmptyColorsTexture(t),this.markAllDefinesAsDirty()}copyTo(e){e.colorsTexture?.dispose(),this._colors&&(e.colorsTexture=h.u.CreateColorsTexture(`${e._material.name}-colors-texture`,this._colors,e.colorsSampling,this._scene)),e.setColor(this.color,!0),e.colorsDistributionType=this.colorsDistributionType,e.colorsSampling=this.colorsSampling,e.colorMode=this.colorMode,e.useColors=this.useColors,e.visibility=this.visibility,e.useDash=this.useDash,e.dashCount=this.dashCount,e.dashRatio=this.dashRatio,e.dashOffset=this.dashOffset,e.width=this.width,e.sizeAttenuation=this.sizeAttenuation,e.resolution=this.resolution,e.markAllDefinesAsDirty()}_isGLSL(e){return 0===e||this._forceGLSL}}p.GREASED_LINE_MATERIAL_NAME="GreasedLinePluginMaterial",p.ForceGLSL=!1,(0,l.H7)(`BABYLON.${p.GREASED_LINE_MATERIAL_NAME}`,p)},2607:function(e,t,i){i.d(t,{LV:()=>s.Z,N3:()=>r.Z,Z9:()=>o.Z,xE:()=>n.Z}),i(65002),i(75208),i(50195),i(1812),i(89309),i(10645);var s=i(6331);i(44976);var r=i(96368);i(58237);var o=i(2043),n=i(81997)},39596:function(e,t,i){i.d(t,{NK:()=>T,SI:()=>o,Sy:()=>m,b9:()=>n,sl:()=>y,yB:()=>f,zN:()=>A});var s,r,o,n,l=i(46658),a=i(92731),h=i(51276),u=i(65098),c=i(55171),d=i(40952),p=i(4557),g=i(1793),_=i(57645);function f(e,t,i){let s;switch(i=i??u.l.LastCreatedScene,t.materialType){case 1:s=new a.Y(e,i,t.forceGLSL),new g.m(s,i,t);break;case 2:s=new c.o(e,i,t);break;default:s=new l.K(e,i,t.forceGLSL),new g.m(s,i,t)}return s}function T(e,t,i,s){let r;s=s??u.l.LastCreatedScene;let o=d.u.ConvertPoints(t.points,t.pointsOptions);t.widthDistribution=t.widthDistribution??3,t.ribbonOptions&&(t.ribbonOptions.facesMode=t.ribbonOptions.facesMode??1,t.ribbonOptions.pointsMode=t.ribbonOptions.pointsMode??0,t.ribbonOptions.directionsAutoMode=t.ribbonOptions.directionsAutoMode??99*!!t.ribbonOptions.directions),(i=i??{color:_.Y.DEFAULT_COLOR}).createAndAssignMaterial=i.createAndAssignMaterial??!0,i.colorDistribution=i?.colorDistribution??3,i.materialType=i.materialType??0;let n=m(o),l=y(n,t.widths??[],t.widthDistribution),a=i?.colors?A(n,i.colors,i.colorDistribution,i.color??_.Y.DEFAULT_COLOR):void 0,c={points:o,updatable:t.updatable,widths:l,lazy:t.lazy,ribbonOptions:t.ribbonOptions,uvs:t.uvs,colorPointers:t.colorPointers};if(c.ribbonOptions&&0===c.ribbonOptions.pointsMode&&(c.ribbonOptions.width=i.width??c.ribbonOptions.width??_.Y.DEFAULT_WIDTH),t.instance)if((r=t.instance)instanceof p.K)r.addPoints(o,c);else{let e=r.widths;if(e){let t=e.slice();for(let e of l)t.push(e);r.widths=t}else r.widths=l;if(r.addPoints(o),t.uvs){let e=r.uvs;if(e){let i=new Float32Array(e.length+t.uvs.length);i.set(e,0),i.set(t.uvs,e.length),r.uvs=i}else r.uvs=t.uvs}}else if(r=c.ribbonOptions?new p.K(e,s,c):new h.R(e,s,c),i){let o={materialType:i.materialType,dashCount:i.dashCount,dashOffset:i.dashOffset,dashRatio:i.dashRatio,resolution:i.resolution,sizeAttenuation:i.sizeAttenuation,useColors:i.useColors,useDash:i.useDash,visibility:i.visibility,width:i.width,color:i.color,colorMode:i.colorMode,colorsSampling:i.colorsSampling,colorDistributionType:i.colorDistributionType,colors:a,cameraFacing:!t.ribbonOptions,colorsTexture:i.colorsTexture};if(i.createAndAssignMaterial){let i=f(e,o,s);r.material=i,t.ribbonOptions?.facesMode===1&&(i.backFaceCulling=!1)}}if(a&&t.instance&&t.instance.greasedLineMaterial){let e=t.instance.greasedLineMaterial.colors;if(e){let i=e.concat(a);t.instance.greasedLineMaterial.setColors(i,r.isLazy())}}return r}function m(e){let t=0;for(let i of e)t+=i.length/3;return t}function y(e,t,i,s=1,r=1){let o=e-t.length/2,n=[];if(o<0)return t.slice(0,2*e);if(o>0){if(t.length%2!=0&&t.push(s),5===i){let e=Math.floor(t.length/2);for(let i=0,s=0;i<e-1;i++)n.push(t[s++]),n.push(t[s++]);let i=t[e/2],s=t[e/2+1];for(let e=0;e<o;e++)n.push(s),n.push(i);for(let i=e;i<t.length;i+=2)n.push(t[i]),n.push(t[i+1])}else if(3===i){for(let e=0;e<t.length;e+=2)n.push(t[e]),n.push(t[e+1]);for(let e=0;e<o;e++)n.push(s),n.push(r)}else if(4===i){for(let e=0;e<o;e++)n.push(s),n.push(r);for(let e=0;e<t.length;e+=2)n.push(t[e]),n.push(t[e+1])}else if(1===i){let i=0;for(let s=0;s<e;s++)n.push(t[i++]),n.push(t[i++]),i===t.length&&(i=0)}else if(2===i){let i=0,s=t.length/((e-1)*2);for(let r=0;r<e;r++){let e=Math.floor(i);n.push(t[e]),n.push(t[e+1]),i+=s}}}else for(let e=0;e<t.length;e++)n.push(t[e]);return n}function A(e,t,i,s){let r=(e=Math.max(t.length,e))-t.length;if(r<0)return t.slice(0,e);let o=[];if(r>0){if(5===i){let e=Math.floor(t.length/2);for(let i=0;i<e;i++)o.push(t[i]);for(let e=0;e<r-1;e++)o.push(s);for(let i=e;i<t.length;i++)o.push(t[i])}else if(3===i){for(let e=0;e<t.length;e++)o.push(t[e]);for(let e=0;e<r;e++)o.push(s)}else if(4===i){for(let e=0;e<r-1;e++)o.push(s);for(let e=0;e<t.length;e++)o.push(t[e])}else if(1===i){let i=0;for(let s=0;s<e;s++)o.push(t[i]),++i===t.length&&(i=0)}else if(2===i){let i=0,s=t.length/(e-1);for(let r=0;r<e-1;r++){let e=Math.floor(i);o.push(t[e]),i+=s}}else if(0===i)for(let e=0;e<t.length;e++)o.push(t[e])}else for(let i=0;i<e;i++)o.push(t[i]);return o}(s=o||(o={}))[s.COLOR_DISTRIBUTION_NONE=0]="COLOR_DISTRIBUTION_NONE",s[s.COLOR_DISTRIBUTION_REPEAT=1]="COLOR_DISTRIBUTION_REPEAT",s[s.COLOR_DISTRIBUTION_EVEN=2]="COLOR_DISTRIBUTION_EVEN",s[s.COLOR_DISTRIBUTION_START=3]="COLOR_DISTRIBUTION_START",s[s.COLOR_DISTRIBUTION_END=4]="COLOR_DISTRIBUTION_END",s[s.COLOR_DISTRIBUTION_START_END=5]="COLOR_DISTRIBUTION_START_END",(r=n||(n={}))[r.WIDTH_DISTRIBUTION_NONE=0]="WIDTH_DISTRIBUTION_NONE",r[r.WIDTH_DISTRIBUTION_REPEAT=1]="WIDTH_DISTRIBUTION_REPEAT",r[r.WIDTH_DISTRIBUTION_EVEN=2]="WIDTH_DISTRIBUTION_EVEN",r[r.WIDTH_DISTRIBUTION_START=3]="WIDTH_DISTRIBUTION_START",r[r.WIDTH_DISTRIBUTION_END=4]="WIDTH_DISTRIBUTION_END",r[r.WIDTH_DISTRIBUTION_START_END=5]="WIDTH_DISTRIBUTION_START_END"},4046:function(e,t,i){var s,r,o,n,l,a;i.d(t,{VL:()=>r,Vw:()=>s,qG:()=>o}),(n=s||(s={}))[n.MATERIAL_TYPE_STANDARD=0]="MATERIAL_TYPE_STANDARD",n[n.MATERIAL_TYPE_PBR=1]="MATERIAL_TYPE_PBR",n[n.MATERIAL_TYPE_SIMPLE=2]="MATERIAL_TYPE_SIMPLE",(l=r||(r={}))[l.COLOR_MODE_SET=0]="COLOR_MODE_SET",l[l.COLOR_MODE_ADD=1]="COLOR_MODE_ADD",l[l.COLOR_MODE_MULTIPLY=2]="COLOR_MODE_MULTIPLY",(a=o||(o={}))[a.COLOR_DISTRIBUTION_TYPE_SEGMENT=0]="COLOR_DISTRIBUTION_TYPE_SEGMENT",a[a.COLOR_DISTRIBUTION_TYPE_LINE=1]="COLOR_DISTRIBUTION_TYPE_LINE"},40952:function(e,t,i){i.d(t,{u:()=>u});var s=i(47888),r=i(31913),o=i(61834),n=i(91546),l=i(21483),a=i(20534),h=i(57645);class u{static ConvertPoints(e,t){if(e.length&&Array.isArray(e)&&"number"==typeof e[0])return[e];if(e.length&&Array.isArray(e[0])&&"number"==typeof e[0][0])return e;if(e.length&&!Array.isArray(e[0])&&e[0]instanceof o.P){let t=[];for(let i=0;i<e.length;i++){let s=e[i];t.push(s.x,s.y,s.z)}return[t]}if(e.length>0&&Array.isArray(e[0])&&e[0].length>0&&e[0][0]instanceof o.P){let t=[];for(let i of e)t.push(i.flatMap(e=>[e.x,e.y,e.z]));return t}if(e instanceof Float32Array)if(!t?.floatArrayStride)return[Array.from(e)];else{let i=[],s=3*t.floatArrayStride;for(let t=0;t<e.length;t+=s){let r=Array(s);for(let i=0;i<s;i++)r[i]=e[t+i];i.push(r)}return i}else if(e.length&&e[0]instanceof Float32Array){let t=[];for(let i of e)t.push(Array.from(i));return t}return[]}static OmitZeroLengthPredicate(e,t,i){let s=[];return t.subtract(e).lengthSquared()>0&&s.push([e,t]),i.subtract(t).lengthSquared()>0&&s.push([t,i]),e.subtract(i).lengthSquared()>0&&s.push([i,e]),0===s.length?null:s}static OmitDuplicatesPredicate(e,t,i,s){let r=[];return u._SearchInPoints(e,t,s)||r.push([e,t]),u._SearchInPoints(t,i,s)||r.push([t,i]),u._SearchInPoints(i,e,s)||r.push([i,e]),0===r.length?null:r}static _SearchInPoints(e,t,i){for(let s of i)for(let i=0;i<s.length;i++)if(s[i]?.equals(e)&&(s[i+1]?.equals(t)||s[i-1]?.equals(t)))return!0;return!1}static MeshesToLines(e,t){let i=[];for(let s=0;s<e.length;s++){let n=e[s],l=n.getVerticesData(r.o.PositionKind),a=n.getIndices();if(l&&a)for(let e=0,r=0;e<a.length;e++){let h=3*a[r++],u=3*a[r++],c=3*a[r++],d=new o.P(l[h],l[h+1],l[h+2]),p=new o.P(l[u],l[u+1],l[u+2]),g=new o.P(l[c],l[c+1],l[c+2]);if(t){let r=t(d,p,g,i,e,h,n,s,l,a);if(r)for(let e of r)i.push(e)}else i.push([d,p],[p,g],[g,d])}}return i}static ToVector3Array(e){if(Array.isArray(e[0])){let t=[];for(let i of e){let e=[];for(let t=0;t<i.length;t+=3)e.push(new o.P(i[t],i[t+1],i[t+2]));t.push(e)}return t}let t=[];for(let i=0;i<e.length;i+=3)t.push(new o.P(e[i],e[i+1],e[i+2]));return t}static ToNumberArray(e){return e.flatMap(e=>[e.x,e.y,e.z])}static GetPointsCountInfo(e){let t=Array(e.length),i=0;for(let s=e.length;s--;)t[s]=e[s].length/3,i+=t[s];return{total:i,counts:t}}static GetLineLength(e){let t;if(0===e.length)return 0;t="number"==typeof e[0]?u.ToVector3Array(e):e;let i=o.jp.Vector3["0"],s=0;for(let e=0;e<t.length-1;e++){let r=t[e];s+=t[e+1].subtractToRef(r,i).length()}return s}static GetLineLengthArray(e){let t=new Float32Array(e.length/3),i=0;for(let s=0,r=e.length/3-1;s<r;s++){let r=e[3*s+0],o=e[3*s+1],n=e[3*s+2];r-=e[3*s+3],o-=e[3*s+4],i+=Math.sqrt(r*r+o*o+(n-=e[3*s+5])*n),t[s+1]=i}return t}static SegmentizeSegmentByCount(e,t,i){let s=[],r=t.subtract(e),n=o.jp.Vector3["0"];n.setAll(i);let l=o.jp.Vector3["1"];r.divideToRef(n,l);let a=e.clone();s.push(a);for(let e=0;e<i;e++)s.push((a=a.clone()).addInPlace(l));return s}static SegmentizeLineBySegmentLength(e,t){let i=e[0]instanceof o.P?u.GetLineSegments(e):"number"==typeof e[0]?u.GetLineSegments(u.ToVector3Array(e)):e,s=[];for(let e of i)if(e.length>t)for(let i of u.SegmentizeSegmentByCount(e.point1,e.point2,Math.ceil(e.length/t)))s.push(i);else s.push(e.point1),s.push(e.point2);return s}static SegmentizeLineBySegmentCount(e,t){let i="number"==typeof e[0]?u.ToVector3Array(e):e,s=u.GetLineLength(i)/t;return u.SegmentizeLineBySegmentLength(i,s)}static GetLineSegments(e){let t=[];for(let i=0;i<e.length-1;i++){let s=e[i],r=e[i+1],o=r.subtract(s).length();t.push({point1:s,point2:r,length:o})}return t}static GetMinMaxSegmentLength(e){let t=u.GetLineSegments(e).sort(e=>e.length);return{min:t[0].length,max:t[t.length-1].length}}static GetPositionOnLineByVisibility(e,t,i,s=!1){let r=t*i,n=0,l=0,a=e.length;for(let t=0;t<a;t++){if(r<=n+e[t].length){l=t;break}n+=e[t].length}let h=(r-n)/e[l].length;return e[l].point2.subtractToRef(e[l].point1,o.jp.Vector3["0"]),o.jp.Vector3["1"]=o.jp.Vector3["0"].multiplyByFloats(h,h,h),s||o.jp.Vector3["1"].addInPlace(e[l].point1),o.jp.Vector3["1"].clone()}static GetCircleLinePoints(e,t,i=0,s=e,r=2*Math.PI/t){let n=[];for(let l=0;l<=t;l++)n.push(new o.P(Math.cos(l*r)*e,Math.sin(l*r)*s,i));return n}static GetBezierLinePoints(e,t,i,r){return s.j_.CreateQuadraticBezier(e,t,i,r).getPoints().flatMap(e=>[e.x,e.y,e.z])}static GetArrowCap(e,t,i,s,r,o=0,n=0){return{points:[e.clone(),e.add(t.multiplyByFloats(i,i,i))],widths:[s,r,o,n]}}static GetPointsFromText(e,t,i,s,r=0,o=!0){let l=[];for(let a of(0,n.v)(e,t,i,s)){for(let e of a.paths){let t=[];for(let i of e.getPoints())t.push(i.x,i.y,r);l.push(t)}if(o)for(let e of a.holes){let t=[];for(let i of e.getPoints())t.push(i.x,i.y,r);l.push(t)}}return l}static Color3toRGBAUint8(e){let t=new Uint8Array(4*e.length);for(let i=0,s=0;i<e.length;i++)t[s++]=255*e[i].r,t[s++]=255*e[i].g,t[s++]=255*e[i].b,t[s++]=255;return t}static CreateColorsTexture(e,t,i,s){let r=s.getEngine().getCaps().maxTextureSize??1,o=t.length>r?r:t.length,n=Math.ceil(t.length/r);n>1&&(t=[...t,...Array(o*n-t.length).fill(t[0])]);let h=u.Color3toRGBAUint8(t),c=new l.l(h,o,n,a.D.TEXTUREFORMAT_RGBA,s,!1,!0,i);return c.name=e,c}static PrepareEmptyColorsTexture(e){if(!h.Y.EmptyColorsTexture){let t=new Uint8Array(4);h.Y.EmptyColorsTexture=new l.l(t,1,1,a.D.TEXTUREFORMAT_RGBA,e,!1,!1,l.l.NEAREST_NEAREST),h.Y.EmptyColorsTexture.name="grlEmptyColorsTexture"}return h.Y.EmptyColorsTexture}static DisposeEmptyColorsTexture(){h.Y.EmptyColorsTexture?.dispose(),h.Y.EmptyColorsTexture=null}static BooleanToNumber(e){return+!!e}}},4489:function(e,t,i){i.d(t,{J:()=>l});var s=i(58417),r=i(54603),o=i(59942),n=i(46363);class l extends s.k{constructor(e){super(e,o.u.Neutral),this.registerInput("left",r.E.AutoDetect),this.registerInput("right",r.E.AutoDetect),this.registerInput("gradient",r.E.AutoDetect),this.registerOutput("output",r.E.BasedOnInput),this._outputs[0]._typeConnectionSource=this._inputs[0],this._linkConnectionTypes(0,1),this._linkConnectionTypes(1,2,!0),this._inputs[2].acceptedConnectionPointTypes.push(r.E.Float)}getClassName(){return"LerpBlock"}get left(){return this._inputs[0]}get right(){return this._inputs[1]}get gradient(){return this._inputs[2]}get output(){return this._outputs[0]}_buildBlock(e){super._buildBlock(e);let t=this._outputs[0];return e.compilationString+=e._declareOutput(t)+` = mix(${this.left.associatedVariableName} , ${this.right.associatedVariableName}, ${this.gradient.associatedVariableName});
`,this}}(0,n.H7)("BABYLON.LerpBlock",l)},4557:function(e,t,i){i.d(t,{K:()=>h});var s=i(61834),r=i(51577),o=i(31913),n=i(40761),l=i(40952),a=i(5493);r.Kj._GreasedLineRibbonMeshParser=(e,t)=>h.Parse(e,t);class h extends a.KH{constructor(e,t,i,s){if(super(e,t,i),this.name=e,!i.ribbonOptions)throw"'GreasedLineMeshOptions.ribbonOptions' is not set.";this._paths=[],this._counters=[],this._slopes=[],this._widths=i.widths??[],this._ribbonWidths=[],this._pathsOptions=s??[],i.points&&this.addPoints(l.u.ConvertPoints(i.points),i,!!s)}addPoints(e,t,i=!1){if(!t.ribbonOptions)throw"addPoints() on GreasedLineRibbonMesh instance requires 'GreasedLineMeshOptions.ribbonOptions'.";i||this._pathsOptions.push({options:t,pathCount:e.length}),super.addPoints(e,t)}getClassName(){return"GreasedLineRibbonMesh"}get isFlatLine(){return this._paths.length<3}get slopes(){return this._slopes}set slopes(e){this._slopes=e}_updateColorPointers(){if(this._options.colorPointers)return;let e=0;this._colorPointers=[];for(let t=0;t<this._pathsOptions.length;t++){let{options:i,pathCount:s}=this._pathsOptions[t],r=this._points[t];if(0===i.ribbonOptions.pointsMode)for(let t=0;t<s;t++)for(let t=0;t<r.length;t+=3)this._colorPointers.push(e),this._colorPointers.push(e++);else for(let t=0;t<r.length;t+=3){for(let t=0;t<s;t++)this._colorPointers.push(e);e++}}}_updateWidths(){super._updateWidthsWithValue(1)}_setPoints(e,t){let i;if(!this._options.ribbonOptions)throw"No 'GreasedLineMeshOptions.ribbonOptions' provided.";this._points=e,this._options.points=e,this._initGreasedLine();let s=0;for(let t=0,r=0;t<this._pathsOptions.length;t++){let{options:o,pathCount:n}=this._pathsOptions[t],a=e.slice(r,r+n);if(r+=n,o.ribbonOptions?.pointsMode===1)s=this._preprocess(l.u.ToVector3Array(a),s,o);else{if(o.ribbonOptions?.directionsAutoMode===99){if(!o.ribbonOptions.directions)throw"In GreasedLineRibbonAutoDirectionMode.AUTO_DIRECTIONS_NONE 'GreasedLineMeshOptions.ribbonOptions.directions' must be defined.";i=h._GetDirectionPlanesFromDirectionsOption(a.length,o.ribbonOptions.directions)}for(let e=0;e<a.length;e++){let t=a[e],r=h._ConvertToRibbonPath(t,o.ribbonOptions,this._scene.useRightHandedSystem,i?i[e]:i);s=this._preprocess(r,s,o)}}}!this._lazy&&(this._createVertexBuffers(),this.doNotSyncBoundingInfo||this.refreshBoundingInfo())}static _GetDirectionPlanesFromDirectionsOption(e,t){return Array.isArray(t)?t:Array(e).fill(t)}static _CreateRibbonVertexData(e,t){let i=e.length;if(i<2)throw"Minimum of two paths are required to create a GreasedLineRibbonMesh.";let s=[],r=[],o=e[0];for(let t=0;t<o.length;t++)for(let i=0;i<e.length;i++){let r=e[i][t];s.push(r.x,r.y,r.z)}let n=[1,0,i],l=t.ribbonOptions?.facesMode===2,a=t.ribbonOptions?.pointsMode===1&&t.ribbonOptions.closePath;if(i>2)for(let e=0;e<o.length-1;e++){n[0]=1+i*e,n[1]=i*e,n[2]=(e+1)*i;for(let e=0;e<(i-1)*2;e++)e%2!=0&&(n[2]+=1),e%2==0&&e>0&&(n[0]+=1,n[1]+=1),r.push(n[1]+(e%2!=0?i:0),n[0],n[2]),l&&r.push(n[0],n[1]+(e%2!=0?i:0),n[2])}else for(let e=0;e<s.length/3-3;e+=2)r.push(e,e+1,e+2),r.push(e+2,e+1,e+3),l&&(r.push(e+1,e,e+2),r.push(e+1,e+2,e+3));if(a){let e=i*(o.length-1);for(let t=0;t<i-1;t++)r.push(e,t+1,t),r.push(e+1,t+1,e),l&&(r.push(t,t+1,e),r.push(e,t+1,e+1)),e++}return{positions:s,indices:r}}_preprocess(e,t,i){this._paths=e;let s=h._CreateRibbonVertexData(e,i),r=s.positions;if(!this._options.widths)throw"No 'GreasedLineMeshOptions.widths' table is specified.";let o=Array.isArray(this._vertexPositions)?this._vertexPositions:Array.from(this._vertexPositions);this._vertexPositions=o;let n=Array.isArray(this._uvs)?this._uvs:Array.from(this._uvs);this._uvs=n;let l=Array.isArray(this._indices)?this._indices:Array.from(this._indices);for(let e of(this._indices=l,r))o.push(e);let a=e;if(i.ribbonOptions?.pointsMode===1&&i.ribbonOptions.closePath){a=[];for(let t=0;t<e.length;t++){let i=e[t].slice();i.push(e[t][0].clone()),a.push(i)}}this._calculateSegmentLengths(a);let u=a.length,c=Array(u).fill(0);for(let e=0;e<a[0].length;e++){let t=0;for(let i=0;i<u;i++){let s=c[i]+this._vSegmentLengths[i][e]/this._vTotalLengths[i];this._counters.push(s),n.push(s,t),c[i]=s,t+=this._uSegmentLengths[e][i]/this._uTotalLengths[e]}}for(let e=0,t=0;e<a[0].length;e++){let i=this._uSegmentLengths[e][0]/2,s=this._uSegmentLengths[e][u-1]/2;this._ribbonWidths.push(((this._widths[t++]??1)-1)*i);for(let e=0;e<u-2;e++)this._ribbonWidths.push(0);this._ribbonWidths.push(((this._widths[t++]??1)-1)*s)}for(let e of i.ribbonOptions?.pointsMode===1?Array(a[0].length*a.length*6).fill(0):h._CalculateSlopes(a))this._slopes.push(e);if(s.indices)for(let e=0;e<s.indices.length;e++)l.push(s.indices[e]+t);return t+=r.length/3}static _ConvertToRibbonPath(e,t,i,r){if(0===t.pointsMode&&!t.width)throw"'GreasedLineMeshOptions.ribbonOptiosn.width' must be specified in GreasedLineRibbonPointsMode.POINTS_MODE_POINTS.";let o=[],n=[];if(0===t.pointsMode){let a=t.width/2,u=l.u.ToVector3Array(e),c=null,d=null;if(0===t.directionsAutoMode&&(r=h._GetDirectionFromPoints(u[0],u[1],null)),3===t.directionsAutoMode&&!(t.directions instanceof s.P))throw"In GreasedLineRibbonAutoDirectionMode.AUTO_DIRECTIONS_FACE_TO 'GreasedLineMeshOptions.ribbonOptions.directions' must be a Vector3.";s.jp.Vector3["1"]=t.directions instanceof s.P?t.directions:h.DIRECTION_XZ;for(let e=0;e<u.length-!r;e++){let l=u[e],p=u[e+1];if(r)c=r;else if(3===t.directionsAutoMode)p.subtractToRef(l,s.jp.Vector3["0"]),c=s.P.CrossToRef(s.jp.Vector3["0"],s.jp.Vector3["1"],s.jp.Vector3["2"]).normalize();else if(1===t.directionsAutoMode)c=h._GetDirectionFromPoints(l,p,c);else{let e=p.subtract(l);e.applyRotationQuaternionInPlace(e.x>e.y&&e.x>e.z?i?h._RightHandedForwardReadOnlyQuaternion:h._LeftHandedForwardReadOnlyQuaternion:h._LeftReadOnlyQuaternion),c=e.normalize()}d=c.multiplyByFloats(a,a,a),o.push(l.add(d)),n.push(l.subtract(d))}r||(o.push(u[u.length-1].add(d)),n.push(u[u.length-1].subtract(d)))}return[o,n]}static _GetDirectionFromPoints(e,t,i){return e.x!==t.x||i&&i?.x!==1?e.y===t.y?h.DIRECTION_XZ:e.z===t.z?h.DIRECTION_XY:h.DIRECTION_XZ:h.DIRECTION_YZ}clone(e=`${this.name}-cloned`,t){let i=this._createLineOptions(),s={},r=[];n.j.DeepCopy(this._pathsOptions,r,void 0,void 0,!0),n.j.DeepCopy(i,s,["instance"],void 0,!0);let o=new h(e,this._scene,s,r);return t&&(o.parent=t),o.material=this.material,o}serialize(e){super.serialize(e),e.type=this.getClassName(),e.lineOptions=this._createLineOptions(),e.pathsOptions=this._pathsOptions}static Parse(e,t){let i=e.lineOptions;return new h(e.name,t,i,e.pathOptions)}_initGreasedLine(){super._initGreasedLine(),this._paths=[],this._counters=[],this._slopes=[],this._ribbonWidths=[]}_calculateSegmentLengths(e){let t=e.length;this._vSegmentLengths=Array(t),this._vTotalLengths=Array(t);let i=0;for(let s=0;s<t;s++){let t=e[s];this._vSegmentLengths[s]=[0],i=0;for(let e=0;e<t.length-1;e++){let r=Math.abs(t[e].subtract(t[e+1]).lengthSquared());i+=r,this._vSegmentLengths[s].push(r)}this._vTotalLengths[s]=i}let r=e[0].length;this._uSegmentLengths=Array(r).fill([]),this._uTotalLengths=Array(r).fill([]);let o=new s.P;for(let s=0;s<r;s++){i=0;for(let r=1;r<t;r++){e[r][s].subtractToRef(e[r-1][s],o);let t=o.length();i+=t,this._uSegmentLengths[s].push(t)}this._uTotalLengths[s]=i}}static _CalculateSlopes(e){let t=e[0],i=2===e.length?e[1]:e[e.length-1],r=[],o=new s.P;for(let s=0;s<t.length;s++)for(let n=0;n<e.length;n++)0===n||n===e.length-1?(t[s].subtract(i[s]).normalizeToRef(o),r.push(o.x,o.y,o.z),r.push(-o.x,-o.y,-o.z)):r.push(0,0,0,0,0,0);return r}_createVertexBuffers(){this._uvs=this._options.uvs??this._uvs;let e=super._createVertexBuffers(this._options.ribbonOptions?.smoothShading),t=new o.l(this._engine,this._counters,this._updatable,1);this.setVerticesBuffer(t.createVertexBuffer("grl_counters",0,1));let i=new o.l(this._engine,this._colorPointers,this._updatable,1);this.setVerticesBuffer(i.createVertexBuffer("grl_colorPointers",0,1));let s=new o.l(this._engine,this._slopes,this._updatable,3);this.setVerticesBuffer(s.createVertexBuffer("grl_slopes",0,3));let r=new o.l(this._engine,this._ribbonWidths,this._updatable,1);return this.setVerticesBuffer(r.createVertexBuffer("grl_widths",0,1)),this._widthsBuffer=r,e}}h.DEFAULT_WIDTH=.1,h._RightHandedForwardReadOnlyQuaternion=s._f.RotationAxis(s.P.RightHandedForwardReadOnly,Math.PI/2),h._LeftHandedForwardReadOnlyQuaternion=s._f.RotationAxis(s.P.LeftHandedForwardReadOnly,Math.PI/2),h._LeftReadOnlyQuaternion=s._f.RotationAxis(s.P.LeftReadOnly,Math.PI/2),h.DIRECTION_XY=s.P.LeftHandedForwardReadOnly,h.DIRECTION_XZ=s.P.UpReadOnly,h.DIRECTION_YZ=s.P.LeftReadOnly},51276:function(e,t,i){i.d(t,{R:()=>u});var s=i(61834),r=i(51577),o=i(31913),n=i(94826),l=i(40761),a=i(40952),h=i(5493);r.Kj._GreasedLineMeshParser=(e,t)=>u.Parse(e,t);class u extends h.KH{constructor(e,t,i){super(e,t,i),this.name=e,this.intersectionThreshold=.1,this._previousAndSide=[],this._nextAndCounters=[],i.points&&this.addPoints(a.u.ConvertPoints(i.points))}getClassName(){return"GreasedLineMesh"}_updateColorPointers(){if(this._options.colorPointers)return;let e=0;for(let t of(this._colorPointers=[],this._points))for(let i=0;i<t.length;i+=3)this._colorPointers.push(e),this._colorPointers.push(e++)}_updateWidths(){}_setPoints(e){this._points=e,this._options.points=e,this._initGreasedLine();let t=0,i=0,s=0,r=0,o=0;for(let t of e)i+=2*t.length,s+=(t.length-3)*2,r+=4*t.length/3,o+=8*t.length/3;let n=new Float32Array(i),l=i>65535?new Uint32Array(s):new Uint16Array(s),h=new Float32Array(r),c=new Float32Array(o),d=new Float32Array(o),p=0,g=0,_=0,f=0,T=0;for(let i of e){let e,s=a.u.GetLineLengthArray(i),r=s[s.length-1];for(let e=0,s=0;s<i.length;e++,s+=3){let r=p+2*s;if(n[r+0]=i[s+0],n[r+1]=i[s+1],n[r+2]=i[s+2],n[r+3]=i[s+0],n[r+4]=i[s+1],n[r+5]=i[s+2],s<i.length-3){let i=2*e+t,r=g+2*s;l[r+0]=i,l[r+1]=i+1,l[r+2]=i+2,l[r+3]=i+2,l[r+4]=i+1,l[r+5]=i+3}}t+=i.length/3*2;let o=2*i.length,m=n.subarray(p,p+o);p+=o,g+=(i.length-3)*2;let y=new Float32Array(m.length),A=new Float32Array(m.length),b=m.length/6;e=u._CompareV3(0,b-1,m)?m.subarray((b-2)*6,(b-1)*6):m.subarray(0,6),y.set(e),y.set(m.subarray(0,m.length-6),6),A.set(m.subarray(6)),e=u._CompareV3(b-1,0,m)?m.subarray(6,12):m.subarray((b-1)*6,6*b),A.set(e,A.length-6);for(let e=0,t=m.length/3;e<t;e++)c[f++]=y[3*e],c[f++]=y[3*e+1],c[f++]=y[3*e+2],c[f++]=1-((1&e)<<1),d[T++]=A[3*e],d[T++]=A[3*e+1],d[T++]=A[3*e+2],d[T++]=s[e>>1]/r;if(this._options.uvs)for(let e=0;e<this._options.uvs.length;e++)h[_++]=this._options.uvs[e];else for(let e=0;e<b;e++){let t=s[e]/r,i=_+4*e;h[i+0]=t,h[i+1]=0,h[i+2]=t,h[i+3]=1}}this._vertexPositions=n,this._indices=l,this._uvs=h,this._previousAndSide=c,this._nextAndCounters=d,!this._lazy&&(this._options.colorPointers||this._updateColorPointers(),this._createVertexBuffers(),this.doNotSyncBoundingInfo||this.refreshBoundingInfo())}clone(e=`${this.name}-cloned`,t){let i=this._createLineOptions(),s={};l.j.DeepCopy(i,s,["instance"],void 0,!0);let r=new u(e,this._scene,s);return t&&(r.parent=t),r.material=this.material,r}serialize(e){super.serialize(e),e.type=this.getClassName(),e.lineOptions=this._createLineOptions()}static Parse(e,t){let i=e.lineOptions;return new u(e.name,t,i)}_initGreasedLine(){super._initGreasedLine(),this._previousAndSide=[],this._nextAndCounters=[]}intersects(e,t,i,s=!1,r,o=!1){let l=new n.p,a=this.findAllIntersections(e,t,i,s,r,o,!0);if(a?.length===1){let t=a[0];l.hit=!0,l.distance=t.distance,l.ray=e,l.pickedMesh=this,l.pickedPoint=t.point}return l}findAllIntersections(e,t,i,s=!1,r,n=!1,l=!1){if(s&&!n&&!1===e.intersectsSphere(this._boundingSphere,this.intersectionThreshold))return;let a=this.getIndices(),h=this.getVerticesData(o.o.PositionKind),c=this._widths,d=this.greasedLineMaterial?.width??1,p=[];if(a&&h&&c){let t=0,i=0;for(t=0,i=a.length-1;t<i;t+=3){let i=a[t],s=a[t+1];u._V_START.fromArray(h,3*i),u._V_END.fromArray(h,3*s),this._offsets&&(u._V_OFFSET_START.fromArray(this._offsets,3*i),u._V_OFFSET_END.fromArray(this._offsets,3*s),u._V_START.addInPlace(u._V_OFFSET_START),u._V_END.addInPlace(u._V_OFFSET_END));let r=Math.floor(t/3),o=void 0!==c[r]?c[r]:1,n=this.intersectionThreshold*(d*o)/2,g=e.intersectionSegment(u._V_START,u._V_END,n);if(-1!==g&&(p.push({distance:g,point:e.direction.normalize().multiplyByFloats(g,g,g).add(e.origin)}),l))return p}t=i}return p}get _boundingSphere(){return this.getBoundingInfo().boundingSphere}static _CompareV3(e,t,i){let s=6*e,r=6*t;return i[s]===i[r]&&i[s+1]===i[r+1]&&i[s+2]===i[r+2]}_createVertexBuffers(){let e=super._createVertexBuffers(),t=this._scene.getEngine(),i=new o.l(t,this._previousAndSide,!1,4);this.setVerticesBuffer(i.createVertexBuffer("grl_previousAndSide",0,4));let s=new o.l(t,this._nextAndCounters,!1,4);this.setVerticesBuffer(s.createVertexBuffer("grl_nextAndCounters",0,4));let r=new o.l(t,this._widths,this._updatable,1);this.setVerticesBuffer(r.createVertexBuffer("grl_widths",0,1)),this._widthsBuffer=r;let n=new o.l(t,this._colorPointers,this._updatable,1);return this.setVerticesBuffer(n.createVertexBuffer("grl_colorPointers",0,1)),this._colorPointersBuffer=n,e}}u._V_START=new s.P,u._V_END=new s.P,u._V_OFFSET_START=new s.P,u._V_OFFSET_END=new s.P},55171:function(e,t,i){i.d(t,{o:()=>c,y:()=>u});var s=i(21483),r=i(76723),o=i(57423),n=i(61834),l=i(3472),a=i(40952),h=i(57645);let u="GREASED_LINE_USE_OFFSETS";class c extends r.j{constructor(e,t,r){let u=t.getEngine(),d=u.isWebGPU&&!(r.forceGLSL||c.ForceGLSL),p=["COLOR_DISTRIBUTION_TYPE_LINE 1.","COLOR_DISTRIBUTION_TYPE_SEGMENT 0.","COLOR_MODE_SET 0.","COLOR_MODE_ADD 1.","COLOR_MODE_MULTIPLY 2."];t.useRightHandedSystem&&p.push("GREASED_LINE_RIGHT_HANDED_COORDINATE_SYSTEM");let g=["position","grl_widths","grl_offsets","grl_colorPointers"];r.cameraFacing?(p.push("GREASED_LINE_CAMERA_FACING"),g.push("grl_previousAndSide","grl_nextAndCounters")):(g.push("grl_slopes"),g.push("grl_counters"));let _=["grlColorsWidth","grlUseColors","grlWidth","grlColor","grl_colorModeAndColorDistributionType","grlResolution","grlAspect","grlAizeAttenuation","grlDashArray","grlDashOffset","grlDashRatio","grlUseDash","grlVisibility","grlColors"];if(d||_.push("world","viewProjection","view","projection"),super(e,t,{vertex:"greasedLine",fragment:"greasedLine"},{uniformBuffers:d?["Scene","Mesh"]:void 0,attributes:g,uniforms:_,samplers:d?[]:["grlColors"],defines:p,extraInitializationsAsync:async()=>{d?await Promise.all([i.e("4280").then(i.bind(i,63330)),i.e("2508").then(i.bind(i,99465))]):await Promise.all([i.e("9824").then(i.bind(i,2993)),i.e("4003").then(i.bind(i,1493))])},shaderLanguage:+!!d}),this._color=o.Wo.White(),this._colorsDistributionType=0,this._colorsTexture=null,r=r||{color:h.Y.DEFAULT_COLOR},this.visibility=r.visibility??1,this.useDash=r.useDash??!1,this.dashRatio=r.dashRatio??.5,this.dashOffset=r.dashOffset??0,this.dashCount=r.dashCount??1,this.width=r.width?r.width:r.sizeAttenuation&&r.cameraFacing?h.Y.DEFAULT_WIDTH_ATTENUATED:h.Y.DEFAULT_WIDTH,this.sizeAttenuation=r.sizeAttenuation??!1,this.color=r.color??o.Wo.White(),this.useColors=r.useColors??!1,this.colorsDistributionType=r.colorDistributionType??0,this.colorsSampling=r.colorsSampling??s.l.NEAREST_NEAREST,this.colorMode=r.colorMode??0,this._colors=r.colors??null,this._cameraFacing=r.cameraFacing??!0,this.resolution=r.resolution??new n.FM(u.getRenderWidth(),u.getRenderHeight()),r.colorsTexture?this.colorsTexture=r.colorsTexture:this._colors?this.colorsTexture=a.u.CreateColorsTexture(`${this.name}-colors-texture`,this._colors,this.colorsSampling,t):(this._color=this._color??h.Y.DEFAULT_COLOR,this.colorsTexture=a.u.PrepareEmptyColorsTexture(t)),d){let e=new l.a;e.setParameters(),e.samplingMode=this.colorsSampling,this.setTextureSampler("grlColorsSampler",e)}u.onDisposeObservable.add(()=>{a.u.DisposeEmptyColorsTexture()})}dispose(){this._colorsTexture?.dispose(),super.dispose()}_setColorModeAndColorDistributionType(){this.setVector2("grl_colorModeAndColorDistributionType",new n.FM(this._colorMode,this._colorsDistributionType))}updateLazy(){this._colors&&this.setColors(this._colors,!1,!0)}get colors(){return this._colors}set colors(e){this.setColors(e)}setColors(e,t=!1,i=!1){let s=this._colors?.length??0;if(this._colors=e,null===e||0===e.length)return void this._colorsTexture?.dispose();if(!t||i)if(this._colorsTexture&&s===e.length&&!i){let t=a.u.Color3toRGBAUint8(e);this._colorsTexture.update(t)}else this._colorsTexture?.dispose(),this.colorsTexture=a.u.CreateColorsTexture(`${this.name}-colors-texture`,e,this.colorsSampling,this.getScene())}get colorsTexture(){return this._colorsTexture??null}set colorsTexture(e){this._colorsTexture=e,this.setFloat("grlColorsWidth",this._colorsTexture.getSize().width),this.setTexture("grlColors",this._colorsTexture)}get width(){return this._width}set width(e){this._width=e,this.setFloat("grlWidth",e)}get useColors(){return this._useColors}set useColors(e){this._useColors=e,this.setFloat("grlUseColors",a.u.BooleanToNumber(e))}get colorsSampling(){return this._colorsSampling}set colorsSampling(e){this._colorsSampling=e}get visibility(){return this._visibility}set visibility(e){this._visibility=e,this.setFloat("grlVisibility",e)}get useDash(){return this._useDash}set useDash(e){this._useDash=e,this.setFloat("grlUseDash",a.u.BooleanToNumber(e))}get dashOffset(){return this._dashOffset}set dashOffset(e){this._dashOffset=e,this.setFloat("grlDashOffset",e)}get dashRatio(){return this._dashRatio}set dashRatio(e){this._dashRatio=e,this.setFloat("grlDashRatio",e)}get dashCount(){return this._dashCount}set dashCount(e){this._dashCount=e,this._dashArray=1/e,this.setFloat("grlDashArray",this._dashArray)}get sizeAttenuation(){return this._sizeAttenuation}set sizeAttenuation(e){this._sizeAttenuation=e,this.setFloat("grlSizeAttenuation",a.u.BooleanToNumber(e))}get color(){return this._color}set color(e){this.setColor(e)}setColor(e){e=e??h.Y.DEFAULT_COLOR,this._color=e,this.setColor3("grlColor",e)}get colorsDistributionType(){return this._colorsDistributionType}set colorsDistributionType(e){this._colorsDistributionType=e,this._setColorModeAndColorDistributionType()}get colorMode(){return this._colorMode}set colorMode(e){this._colorMode=e,this._setColorModeAndColorDistributionType()}get resolution(){return this._resolution}set resolution(e){this._resolution=e,this.setVector2("grlResolution",e),this.setFloat("grlAspect",e.x/e.y)}serialize(){let e=super.serialize(),t={colorDistributionType:this._colorsDistributionType,colorsSampling:this._colorsSampling,colorMode:this._colorMode,color:this._color,dashCount:this._dashCount,dashOffset:this._dashOffset,dashRatio:this._dashRatio,resolution:this._resolution,sizeAttenuation:this._sizeAttenuation,useColors:this._useColors,useDash:this._useDash,visibility:this._visibility,width:this._width,cameraFacing:this._cameraFacing};return this._colors&&(t.colors=this._colors),e.greasedLineMaterialOptions=t,e}parse(e,t,i){let s=e.greasedLineMaterialOptions;this._colorsTexture?.dispose(),s.color&&(this.color=s.color),s.colorDistributionType&&(this.colorsDistributionType=s.colorDistributionType),s.colorsSampling&&(this.colorsSampling=s.colorsSampling),s.colorMode&&(this.colorMode=s.colorMode),s.useColors&&(this.useColors=s.useColors),s.visibility&&(this.visibility=s.visibility),s.useDash&&(this.useDash=s.useDash),s.dashCount&&(this.dashCount=s.dashCount),s.dashRatio&&(this.dashRatio=s.dashRatio),s.dashOffset&&(this.dashOffset=s.dashOffset),s.width&&(this.width=s.width),s.sizeAttenuation&&(this.sizeAttenuation=s.sizeAttenuation),s.resolution&&(this.resolution=s.resolution),s.colors?this.colorsTexture=a.u.CreateColorsTexture(`${this.name}-colors-texture`,s.colors,this.colorsSampling,this.getScene()):this.colorsTexture=a.u.PrepareEmptyColorsTexture(t),this._cameraFacing=s.cameraFacing??!0,this.setDefine("GREASED_LINE_CAMERA_FACING",this._cameraFacing)}}c.ForceGLSL=!1},56093:function(e,t,i){i.d(t,{n:()=>l});var s=i(58417),r=i(54603),o=i(59942),n=i(46363);class l extends s.k{constructor(e){super(e,o.u.Neutral),this.registerInput("value",r.E.Float),this.registerInput("edge",r.E.Float),this.registerOutput("output",r.E.Float)}getClassName(){return"StepBlock"}get value(){return this._inputs[0]}get edge(){return this._inputs[1]}get output(){return this._outputs[0]}_buildBlock(e){super._buildBlock(e);let t=this._outputs[0];return e.compilationString+=e._declareOutput(t)+` = step(${this.edge.associatedVariableName}, ${this.value.associatedVariableName});
`,this}}(0,n.H7)("BABYLON.StepBlock",l)},57645:function(e,t,i){i.d(t,{Y:()=>r});var s=i(57423);class r{}r.DEFAULT_COLOR=s.Wo.White(),r.DEFAULT_WIDTH_ATTENUATED=1,r.DEFAULT_WIDTH=.1},65098:function(e,t,i){i.d(t,{l:()=>r});var s=i(85791);class r{static get LastCreatedEngine(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]}static get LastCreatedScene(){return this._LastCreatedScene}}r.Instances=[],r.OnEnginesDisposedObservable=new s.y$,r._LastCreatedScene=null,r.UseFallbackTexture=!0,r.FallbackTexture=""},77904:function(e,t,i){i.d(t,{d:()=>l});var s=i(58417),r=i(54603),o=i(59942),n=i(46363);class l extends s.k{constructor(e){super(e,o.u.Neutral),this.registerInput("left",r.E.AutoDetect),this.registerInput("right",r.E.AutoDetect),this.registerOutput("output",r.E.BasedOnInput),this._outputs[0]._typeConnectionSource=this._inputs[0],this._linkConnectionTypes(0,1)}getClassName(){return"MinBlock"}get left(){return this._inputs[0]}get right(){return this._inputs[1]}get output(){return this._outputs[0]}_buildBlock(e){super._buildBlock(e);let t=this._outputs[0];return e.compilationString+=e._declareOutput(t)+` = min(${this.left.associatedVariableName}, ${this.right.associatedVariableName});
`,this}}(0,n.H7)("BABYLON.MinBlock",l)},78626:function(e,t){t.uniformRandBool=t.normalRandom=t.randRange=t.randRangeInt=t.centeredRand=void 0;var i=function(e){return Math.random()};t.centeredRand=function(e,t){return void 0===e&&(e=i),(e(t)-.5)*2},t.randRangeInt=function(e,t,s,r){return void 0===s&&(s=i),Math.floor(s(r)*(t-e+1))+e},t.randRange=function(e,t,s,r){return void 0===e&&(e=0),void 0===t&&(t=1),void 0===s&&(s=i),s(r)*(t-e)+e},t.normalRandom=function(e,t,s,r){return void 0===s&&(s=i),e+t*Math.sqrt(-2*Math.log(s(r)))*Math.cos(2*Math.PI*s(r+1))},t.uniformRandBool=function(e,t,s){return void 0===t&&(t=i),t(s)<e}},80610:function(e,t,i){i.d(t,{D0:()=>R,En:()=>A,Lf:()=>O,QH:()=>T,Ro:()=>x,hO:()=>b,oJ:()=>C,p6:()=>m,qC:()=>w,qJ:()=>f,qh:()=>v});var s=i(70541),r=i(61834),o=i(16891),n=i(49192),l=i(90481),a=i(11740),h=i(76468),u=i(75590),c=i(88280),d=i(83393),p=i(23207);i(74484);let g="image/png",_=[134,22,135,150,246,214,150,54];function f(e){let t=new DataView(e.buffer,e.byteOffset,e.byteLength),i=0;for(let e=0;e<_.length;e++)if(t.getUint8(i++)!==_[e])return c.Y.Error("Not a babylon environment map"),null;let s="",r=0;for(;r=t.getUint8(i++);)s+=String.fromCharCode(r);let o=JSON.parse(s);return(o=T(o)).binaryDataPosition=i,o.specular&&(o.specular.lodGenerationScale=o.specular.lodGenerationScale||.8),o}function T(e){if(e.version>2)throw Error(`Unsupported babylon environment map version "${e.version}". Latest supported version is "2".`);return 2===e.version?e:e={...e,version:2,imageType:g}}async function m(e,t={}){let i=e.getInternalTexture();if(!i)return await Promise.reject("The cube texture is invalid.");let s=i.getEngine();if(2!==e.textureType&&1!==e.textureType&&0!==e.textureType&&0!==e.textureType&&7!==e.textureType&&-1!==e.textureType)return await Promise.reject("The cube texture should allow HDR (Full Float or Half Float).");let r=1;if(!s.getCaps().textureFloatRender&&(r=2,!s.getCaps().textureHalfFloatRender))return await Promise.reject("Env texture can only be created when the browser supports half float or full float rendering.");e.sphericalPolynomial;let n=e.getInternalTexture()?._sphericalPolynomialPromise,l=i.width,a=new h.x(s),u={},c={};s.flushFramebuffer();let d=t.imageType??g,p=(0,o.ILog2)(i.width);for(let i=0;i<=p;i++){let s=Math.pow(2,p-i);for(let o=0;o<6;o++)u[6*i+o]=await y(a,e,r,o,i,s,d,t.imageQuality)}let f=t.disableIrradianceTexture?null:e.irradianceTexture;if(f){let e=f.getSize().width;for(let i=0;i<6;i++)c[i]=await y(a,f,r,i,0,e,d,t.imageQuality)}a.dispose(),n&&await n;let T={version:2,width:l,imageType:d,irradiance:function(e){let t=e.sphericalPolynomial;return null==t?null:{x:[t.x.x,t.x.y,t.x.z],y:[t.y.x,t.y.y,t.y.z],z:[t.z.x,t.z.y,t.z.z],xx:[t.xx.x,t.xx.y,t.xx.z],yy:[t.yy.x,t.yy.y,t.yy.z],zz:[t.zz.x,t.zz.y,t.zz.z],yz:[t.yz.x,t.yz.y,t.yz.z],zx:[t.zx.x,t.zx.y,t.zx.z],xy:[t.xy.x,t.xy.y,t.xy.z]}}(e),specular:{mipmaps:[],lodGenerationScale:e.lodGenerationScale}},A=0;for(let e=0;e<=p;e++)for(let t=0;t<6;t++){let i=u[6*e+t].byteLength;T.specular.mipmaps.push({length:i,position:A}),A+=i}if(f){T.irradiance=T.irradiance||{x:[0,0,0],xx:[0,0,0],y:[0,0,0],yy:[0,0,0],z:[0,0,0],zz:[0,0,0],yz:[0,0,0],zx:[0,0,0],xy:[0,0,0]},T.irradiance.irradianceTexture={size:f.getSize().width,faces:[]};for(let e=0;e<6;e++){let t=c[e].byteLength;T.irradiance.irradianceTexture.faces.push({length:t,position:A}),A+=t}}let b=JSON.stringify(T),x=new ArrayBuffer(b.length+1),S=new Uint8Array(x);for(let e=0,t=b.length;e<t;e++)S[e]=b.charCodeAt(e);S[b.length]=0;let C=new ArrayBuffer(_.length+A+x.byteLength),R=new Uint8Array(C),D=new DataView(C),w=0;for(let e=0;e<_.length;e++)D.setUint8(w++,_[e]);R.set(new Uint8Array(x),w),w+=x.byteLength;for(let e=0;e<=p;e++)for(let t=0;t<6;t++){let i=u[6*e+t];R.set(new Uint8Array(i),w),w+=i.byteLength}if(f)for(let e=0;e<6;e++){let t=c[e];R.set(new Uint8Array(t),w),w+=t.byteLength}return C}async function y(e,t,i,s,r,o,n,l){let a=await t.readPixels(s,r,void 0,!1);if(a&&a.byteLength===a.length){let e=new Float32Array(4*a.byteLength);for(let t=0;t<a.byteLength;t++)e[t]=a[t]/255,e[t]=Math.pow(e[t],2.2);a=e}else if(a&&t.gammaSpace){let e=a;for(let t=0;t<e.length;t++)e[t]=Math.pow(e[t],2.2)}let h=e.getEngine(),u=h.createRawTexture(a,o,o,5,!1,!0,1,null,i);await d.r.EncodeTextureToRGBD(u,e,i);let c=await h._readTexturePixels(u,o,o),g=await (0,p.DumpDataAsync)(o,o,c,n,void 0,!1,!0,l);return u.dispose(),g}function A(e,t){let i=(t=T(t)).specular,s=Math.log2(t.width);if(s=Math.round(s)+1,i.mipmaps.length!==6*s)throw Error(`Unsupported specular mipmaps number "${i.mipmaps.length}"`);let r=Array(s);for(let o=0;o<s;o++){r[o]=Array(6);for(let s=0;s<6;s++){let n=i.mipmaps[6*o+s];r[o][s]=new Uint8Array(e.buffer,e.byteOffset+t.binaryDataPosition+n.position,n.length)}}return r}function b(e,t){t=T(t);let i=Array(6),s=t.irradiance?.irradianceTexture;if(s){if(6!==s.faces.length)throw Error(`Incorrect irradiance texture faces number "${s.faces.length}"`);for(let r=0;r<6;r++){let o=s.faces[r];i[r]=new Uint8Array(e.buffer,e.byteOffset+t.binaryDataPosition+o.position,o.length)}}return i}function x(e,t,i){let s=(i=T(i)).specular;if(!s)return Promise.resolve([]);e._lodGenerationScale=s.lodGenerationScale;let r=[],o=A(t,i);r.push(C(e,o,i.imageType));let n=i.irradiance?.irradianceTexture;if(n){let s=b(t,i);r.push(R(e,s,n.size,i.imageType))}return Promise.all(r)}async function S(e,t,i,s,r,o,n,l,a,h,u){return await new Promise((c,d)=>{if(i){let i=t.createTexture(null,!0,!0,null,1,null,e=>{d(e)},e);s?.onEffectCreatedObservable.addOnce(l=>{l.executeWhenCompiled(()=>{s.externalTextureSamplerBinding=!0,s.onApply=s=>{s._bindTexture("textureSampler",i),s.setFloat2("scale",1,t._features.needsInvertingBitmap&&e instanceof ImageBitmap?-1:1)},t.scenes.length&&(t.scenes[0].postProcessManager.directRender([s],h,!0,o,n),t.restoreDefaultFramebuffer(),i.dispose(),URL.revokeObjectURL(r),c())})})}else{if(t._uploadImageToTexture(u,e,o,n),l){let i=a[n];i&&t._uploadImageToTexture(i._texture,e,o,0)}c()}})}async function C(e,t,i=g){let s=e.getEngine();e.format=5,e.type=0,e.generateMipMaps=!0,e._cachedAnisotropicFilteringLevel=null,s.updateTextureSamplingMode(3,e),await D(e,t,!0,i),e.isReady=!0}async function R(e,t,i,s=g){let r=e.getEngine(),o=new l.l(r,5);e._irradianceTexture=new a.V(r,o),o.isCube=!0,o.format=5,o.type=0,o.generateMipMaps=!0,o._cachedAnisotropicFilteringLevel=null,o.generateMipMaps=!0,o.width=i,o.height=i,r.updateTextureSamplingMode(3,o),await D(o,[t],!1,s),r.generateMipMapsForCubemap(o),o.isReady=!0}async function D(e,t,r,n=g){if(!s.w1.IsExponentOfTwo(e.width))throw Error("Texture size must be a power of two");let h=(0,o.ILog2)(e.width)+1,c=e.getEngine(),d=!1,p=!1,_=null,f=null,T=null,m=c.getCaps();m.textureLOD?c._features.supportRenderAndCopyToLodForFloatTextures?m.textureHalfFloatRender&&m.textureHalfFloatLinearFiltering?(d=!0,e.type=2):m.textureFloatRender&&m.textureFloatLinearFiltering&&(d=!0,e.type=1):d=!1:(d=!1,p=r);let y=0;if(d)c.isWebGPU?(y=1,await i.e("5960").then(i.bind(i,38886))):await i.e("7843").then(i.bind(i,6963)),_=new u.D("rgbdDecode","rgbdDecode",null,null,1,null,3,c,!1,void 0,e.type,void 0,null,!1,void 0,y),e._isRGBD=!1,e.invertY=!1,f=c.createRenderTargetCubeTexture(e.width,{generateDepthBuffer:!1,generateMipMaps:!0,generateStencilBuffer:!1,samplingMode:3,type:e.type,format:5});else if(e._isRGBD=!0,e.invertY=!0,p){T={};let t=e._lodGenerationScale,i=e._lodGenerationOffset;for(let s=0;s<3;s++){let r=(h-1)*t+i,o=Math.round(Math.min(Math.max(i+(r-i)*(1-s/2),0),r)),n=new l.l(c,2);n.isCube=!0,n.invertY=!0,n.generateMipMaps=!1,c.updateTextureSamplingMode(2,n);let u=new a.V(null);switch(u._isCube=!0,u._texture=n,T[o]=u,s){case 0:e._lodTextureLow=u;break;case 1:e._lodTextureMid=u;break;case 2:e._lodTextureHigh=u}}}let A=[];for(let i=0;i<t.length;i++)for(let s=0;s<6;s++){let r,o=new Blob([t[i][s]],{type:n}),l=URL.createObjectURL(o);if(c._features.forceBitmapOverHTMLImageElement)r=c.createImageBitmap(o,{premultiplyAlpha:"none"}).then(async t=>await S(t,c,d,_,l,s,i,p,T,f,e));else{let t=new Image;t.src=l,r=new Promise((r,o)=>{t.onload=()=>{S(t,c,d,_,l,s,i,p,T,f,e).then(()=>r()).catch(e=>{o(e)})},t.onerror=e=>{o(e)}})}A.push(r)}if(await Promise.all(A),t.length<h){let i,s=Math.pow(2,h-1-t.length),r=s*s*4;switch(e.type){case 0:i=new Uint8Array(r);break;case 2:i=new Uint16Array(r);break;case 1:i=new Float32Array(r)}for(let s=t.length;s<h;s++)for(let t=0;t<6;t++)c._uploadArrayBufferViewToTexture(f?.texture||e,i,t,s)}if(f){let t=e._irradianceTexture;e._irradianceTexture=null,c._releaseTexture(e),f._swapAndDie(e),e._irradianceTexture=t}_&&_.dispose(),p&&(e._lodTextureHigh&&e._lodTextureHigh._texture&&(e._lodTextureHigh._texture.isReady=!0),e._lodTextureMid&&e._lodTextureMid._texture&&(e._lodTextureMid._texture.isReady=!0),e._lodTextureLow&&e._lodTextureLow._texture&&(e._lodTextureLow._texture.isReady=!0))}function w(e,t){let i=(t=T(t)).irradiance;if(!i)return;let s=new n.i;r.P.FromArrayToRef(i.x,0,s.x),r.P.FromArrayToRef(i.y,0,s.y),r.P.FromArrayToRef(i.z,0,s.z),r.P.FromArrayToRef(i.xx,0,s.xx),r.P.FromArrayToRef(i.yy,0,s.yy),r.P.FromArrayToRef(i.zz,0,s.zz),r.P.FromArrayToRef(i.yz,0,s.yz),r.P.FromArrayToRef(i.zx,0,s.zx),r.P.FromArrayToRef(i.xy,0,s.xy),e._sphericalPolynomial=s}function O(e,t,i,s,r){let o=C(e.getEngine().createRawCubeTexture(null,e.width,e.format,e.type,e.generateMipMaps,e.invertY,e.samplingMode,e._compression),t).then(()=>e);return e.onRebuildCallback=e=>({proxy:o,isReady:!0,isAsync:!0}),e._source=13,e._bufferViewArrayArray=t,e._lodGenerationScale=s,e._lodGenerationOffset=r,e._sphericalPolynomial=i,C(e,t).then(()=>(e.isReady=!0,e))}let v={GetEnvInfo:f,CreateEnvTextureAsync:m,CreateRadianceImageDataArrayBufferViews:A,CreateIrradianceImageDataArrayBufferViews:b,UploadEnvLevelsAsync:x,UploadRadianceLevelsAsync:C,UploadIrradianceLevelsAsync:R,UploadEnvSpherical:w}},80781:function(e,t,i){i.d(t,{MK:()=>p,Th:()=>_,mE:()=>f,n4:()=>m,ng:()=>g,qB:()=>d});var s=i(32160),r=i(57716),o=i(32519),n=i(88280),l=i(70541),a=i(23207),h=i(60746),u=i(67109);let c=null;function d(e,t,i,s,r="image/png",o=!1,a,h=!1){let{height:u,width:p}=T(e,t,i);return u&&p?t.getScene().activeCamera!==t?void _(e,t,i,e=>{if(o){let t=new Blob([e]);l.w1.DownloadBlob(t),s&&s("")}else s&&s(e)},r,1,e.getCreationOptions().antialias,void 0,void 0,void 0,void 0,a):void e.onEndFrameObservable.addOnce(()=>{c||(c=document.createElement("canvas")),c.width=p,c.height=u;let t=c.getContext("2d"),i=e.getRenderingCanvas();if(!t||!i)return void n.Y.Error("Failed to create screenshot. Rendering context or rendering canvas is not available.");let d=i.width,g=i.height,_=c.width,f=c.height,T=_/d,m=f/g,y=h?Math.max(T,m):Math.min(T,m),A=d*y,b=g*y;t.drawImage(i,0,0,d,g,(_-A)/2,(f-b)/2,A,b),o?(l.w1.EncodeScreenshotCanvasData(c,void 0,r,void 0,a),s&&s("")):l.w1.EncodeScreenshotCanvasData(c,s,r,void 0,a)}):void n.Y.Error("Invalid 'size' parameter !")}async function p(e,t,i,s="image/png",r,o=!1){return await new Promise((n,l)=>{d(e,t,i,e=>{void 0!==e?n(e):l(Error("Data is undefined"))},s,void 0,r,o)})}async function g(e,t,i,s,r="image/png",o,n=!1){return await new Promise(l=>{d(e,t,{width:i,height:s},()=>{l()},r,!0,o,n)})}function _(e,t,l,c,d="image/png",p=1,g=!1,f,m=!1,y=!1,A=!0,b,x,S){let{height:C,width:R,finalWidth:D,finalHeight:w}=T(e,t,l);if(!(C&&R))return void n.Y.Error("Invalid 'size' parameter !");e.skipFrameRender=!0;let O=e.getRenderWidth,v=e.getRenderHeight;e.getRenderWidth=(t=!1)=>!t&&e._currentRenderTarget?e._currentRenderTarget.width:R,e.getRenderHeight=(t=!1)=>!t&&e._currentRenderTarget?e._currentRenderTarget.height:C,e.onResizeObservable.hasObservers()&&e.onResizeObservable.notifyObservers(e);let E=t.getScene(),L=new r._("screenShot",{width:R,height:C},E,!1,!1,0,!1,s.x.BILINEAR_SAMPLINGMODE,void 0,y,void 0,void 0,void 0,p);L.renderList=E.meshes.slice(),L.samples=p,L.renderSprites=m,L.activeCamera=t,L.forceLayerMaskCheck=A,x?.(L);let M=S||a.DumpData,I=()=>{(0,u.l)(()=>L.isReadyForRendering()&&t.isReady(!0),()=>{e.onEndFrameObservable.addOnce(()=>{D===R&&w===C?L.readPixels(void 0,void 0,void 0,!1).then(e=>{M(R,C,e,c,d,f,!0,void 0,b),L.dispose()}):(e.isWebGPU?i.e("1801").then(i.bind(i,45460)):i.e("395").then(i.bind(i,35066))).then(async()=>await (0,h.$0)("pass",L.getInternalTexture(),E,void 0,void 0,void 0,D,w).then(t=>{e._readTexturePixels(t,D,w,-1,0,null,!0,!1,0,0).then(e=>{M(D,w,e,c,d,f,!0,void 0,b),t.dispose()})}))}),E.incrementRenderId(),E.resetCachedMaterial();let s=E.activeCamera,r=E.activeCameras,o=t.outputRenderTarget,n=E.spritesEnabled;E.activeCamera=t,E.activeCameras=null,t.outputRenderTarget=L,E.spritesEnabled=m;let l=E.meshes;E.meshes=L.renderList||E.meshes;try{E.render()}finally{E.activeCamera=s,E.activeCameras=r,t.outputRenderTarget=o,E.spritesEnabled=n,E.meshes=l,e.getRenderWidth=O,e.getRenderHeight=v,e.onResizeObservable.hasObservers()&&e.onResizeObservable.notifyObservers(e),t.getProjectionMatrix(!0),e.skipFrameRender=!1}},()=>{e.skipFrameRender=!1,e.getRenderWidth=O,e.getRenderHeight=v})},P=()=>{E.incrementRenderId(),E.resetCachedMaterial(),I()};if(g){let e=new o.P("antialiasing",1,E.activeCamera);L.addPostProcess(e),e.autoClear=!0,e.onEffectCreatedObservable.addOnce(e=>{e.isReady()?P():e.onCompiled=()=>{P()}})}else P()}async function f(e,t,i,s="image/png",r=1,o=!1,n,l=!1,a=!1,h=!0,u,c,d){return await new Promise((p,g)=>{_(e,t,i,e=>{void 0!==e?p(e):g(Error("Data is undefined"))},s,r,o,n,l,a,h,u,c,d)})}function T(e,t,i){let s=0,r=0,o=0,n=0;if("object"==typeof i){let l=i.precision?Math.abs(i.precision):1;i.width&&i.height?(s=i.height*l,r=i.width*l):i.width&&!i.height?s=Math.round((r=i.width*l)/e.getAspectRatio(t)):i.height&&!i.width?r=Math.round((s=i.height*l)*e.getAspectRatio(t)):s=Math.round((r=Math.round(e.getRenderWidth()*l))/e.getAspectRatio(t)),i.finalWidth&&i.finalHeight?(n=i.finalHeight,o=i.finalWidth):i.finalWidth&&!i.finalHeight?n=Math.round((o=i.finalWidth)/e.getAspectRatio(t)):i.finalHeight&&!i.finalWidth?o=Math.round((n=i.finalHeight)*e.getAspectRatio(t)):(o=r,n=s)}else isNaN(i)||(s=i,r=i,o=i,n=i);return r&&(r=Math.floor(r)),s&&(s=Math.floor(s)),o&&(o=Math.floor(o)),n&&(n=Math.floor(n)),{height:0|s,width:0|r,finalWidth:0|o,finalHeight:0|n}}let m={CreateScreenshot:d,CreateScreenshotAsync:p,CreateScreenshotWithResizeAsync:g,CreateScreenshotUsingRenderTarget:_,CreateScreenshotUsingRenderTargetAsync:f};l.w1.CreateScreenshot=d,l.w1.CreateScreenshotAsync=p,l.w1.CreateScreenshotUsingRenderTarget=_,l.w1.CreateScreenshotUsingRenderTargetAsync=f},81731:function(e,t,i){i.d(t,{u:()=>l});var s=i(58417),r=i(54603),o=i(59942),n=i(46363);class l extends s.k{constructor(e){super(e,o.u.Neutral),this.registerInput("value",r.E.AutoDetect),this.registerOutput("output",r.E.Float),this._inputs[0].excludedConnectionPointTypes.push(r.E.Float),this._inputs[0].excludedConnectionPointTypes.push(r.E.Matrix)}getClassName(){return"LengthBlock"}get value(){return this._inputs[0]}get output(){return this._outputs[0]}_buildBlock(e){super._buildBlock(e);let t=this._outputs[0];return e.compilationString+=e._declareOutput(t)+` = length(${this.value.associatedVariableName});
`,this}}(0,n.H7)("BABYLON.LengthBlock",l)},83612:function(e,t,i){i.d(t,{F:()=>o});var s=i(46363),r=i(99151);class o extends r.c{constructor(e){super(e)}getClassName(){return"SubtractBlock"}_buildBlock(e){super._buildBlock(e);let t=this._outputs[0];return e.compilationString+=e._declareOutput(t)+` = ${this.left.associatedVariableName} - ${this.right.associatedVariableName};
`,this}}(0,s.H7)("BABYLON.SubtractBlock",o)},92731:function(e,t,i){i.d(t,{Y:()=>c});var s=i(69254),r=i(88609),o=i(23448),n=i(57423),l=i(38005),a=i(46363),h=i(81234),u=i(90131);class c extends l.m{get refractionTexture(){return this.subSurface.refractionTexture}set refractionTexture(e){this.subSurface.refractionTexture=e,e?this.subSurface.isRefractionEnabled=!0:this.subSurface.linkRefractionWithTransparency||(this.subSurface.isRefractionEnabled=!1)}get indexOfRefraction(){return this.subSurface.indexOfRefraction}set indexOfRefraction(e){this.subSurface.indexOfRefraction=e}get invertRefractionY(){return this.subSurface.invertRefractionY}set invertRefractionY(e){this.subSurface.invertRefractionY=e}get linkRefractionWithTransparency(){return this.subSurface.linkRefractionWithTransparency}set linkRefractionWithTransparency(e){this.subSurface.linkRefractionWithTransparency=e,e&&(this.subSurface.isRefractionEnabled=!0)}get usePhysicalLightFalloff(){return this._lightFalloff===l.m.LIGHTFALLOFF_PHYSICAL}set usePhysicalLightFalloff(e){e!==this.usePhysicalLightFalloff&&(this._markAllSubMeshesAsTexturesDirty(),e?this._lightFalloff=l.m.LIGHTFALLOFF_PHYSICAL:this._lightFalloff=l.m.LIGHTFALLOFF_STANDARD)}get useGLTFLightFalloff(){return this._lightFalloff===l.m.LIGHTFALLOFF_GLTF}set useGLTFLightFalloff(e){e!==this.useGLTFLightFalloff&&(this._markAllSubMeshesAsTexturesDirty(),e?this._lightFalloff=l.m.LIGHTFALLOFF_GLTF:this._lightFalloff=l.m.LIGHTFALLOFF_STANDARD)}get imageProcessingConfiguration(){return this._imageProcessingConfiguration}set imageProcessingConfiguration(e){this._attachImageProcessingConfiguration(e),this._markAllSubMeshesAsImageProcessingDirty()}get cameraColorCurvesEnabled(){return this.imageProcessingConfiguration.colorCurvesEnabled}set cameraColorCurvesEnabled(e){this.imageProcessingConfiguration.colorCurvesEnabled=e}get cameraColorGradingEnabled(){return this.imageProcessingConfiguration.colorGradingEnabled}set cameraColorGradingEnabled(e){this.imageProcessingConfiguration.colorGradingEnabled=e}get cameraToneMappingEnabled(){return this._imageProcessingConfiguration.toneMappingEnabled}set cameraToneMappingEnabled(e){this._imageProcessingConfiguration.toneMappingEnabled=e}get cameraExposure(){return this._imageProcessingConfiguration.exposure}set cameraExposure(e){this._imageProcessingConfiguration.exposure=e}get cameraContrast(){return this._imageProcessingConfiguration.contrast}set cameraContrast(e){this._imageProcessingConfiguration.contrast=e}get cameraColorGradingTexture(){return this._imageProcessingConfiguration.colorGradingTexture}set cameraColorGradingTexture(e){this._imageProcessingConfiguration.colorGradingTexture=e}get cameraColorCurves(){return this._imageProcessingConfiguration.colorCurves}set cameraColorCurves(e){this._imageProcessingConfiguration.colorCurves=e}constructor(e,t,i=!1){super(e,t,i),this.directIntensity=1,this.emissiveIntensity=1,this.environmentIntensity=1,this.specularIntensity=1,this.disableBumpMap=!1,this.ambientTextureStrength=1,this.ambientTextureImpactOnAnalyticalLights=c.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,this.metallicF0Factor=1,this.metallicReflectanceColor=n.Wo.White(),this.useOnlyMetallicFromMetallicReflectanceTexture=!1,this.ambientColor=new n.Wo(0,0,0),this.albedoColor=new n.Wo(1,1,1),this.baseWeight=1,this.reflectivityColor=new n.Wo(1,1,1),this.reflectionColor=new n.Wo(1,1,1),this.emissiveColor=new n.Wo(0,0,0),this.microSurface=1,this.useLightmapAsShadowmap=!1,this.useAlphaFromAlbedoTexture=!1,this.forceAlphaTest=!1,this.alphaCutOff=.4,this.useSpecularOverAlpha=!0,this.useMicroSurfaceFromReflectivityMapAlpha=!1,this.useRoughnessFromMetallicTextureAlpha=!0,this.useRoughnessFromMetallicTextureGreen=!1,this.useMetallnessFromMetallicTextureBlue=!1,this.useAmbientOcclusionFromMetallicTextureRed=!1,this.useAmbientInGrayScale=!1,this.useAutoMicroSurfaceFromReflectivityMap=!1,this.useRadianceOverAlpha=!0,this.useObjectSpaceNormalMap=!1,this.useParallax=!1,this.useParallaxOcclusion=!1,this.parallaxScaleBias=.05,this.disableLighting=!1,this.forceIrradianceInFragment=!1,this.maxSimultaneousLights=4,this.invertNormalMapX=!1,this.invertNormalMapY=!1,this.twoSidedLighting=!1,this.useAlphaFresnel=!1,this.useLinearAlphaFresnel=!1,this.environmentBRDFTexture=null,this.forceNormalForward=!1,this.enableSpecularAntiAliasing=!1,this.useHorizonOcclusion=!0,this.useRadianceOcclusion=!0,this.unlit=!1,this.applyDecalMapAfterDetailMap=!1,this._environmentBRDFTexture=(0,o.$)(this.getScene())}getClassName(){return"PBRMaterial"}clone(e,t=!0,i=""){let s=u.p.Clone(()=>new c(e,this.getScene()),this,{cloneTexturesOnlyOnce:t});return s.id=e,s.name=e,this.stencil.copyTo(s.stencil),this._clonePlugins(s,i),s}serialize(){let e=super.serialize();return e.customType="BABYLON.PBRMaterial",e}static Parse(e,t,i){let s=u.p.Parse(()=>new c(e.name,t),e,t,i);return e.stencil&&s.stencil.parse(e.stencil,t,i),h.F._ParsePlugins(e,s,t,i),e.clearCoat&&s.clearCoat.parse(e.clearCoat,t,i),e.anisotropy&&s.anisotropy.parse(e.anisotropy,t,i),e.brdf&&s.brdf.parse(e.brdf,t,i),e.sheen&&s.sheen.parse(e.sheen,t,i),e.subSurface&&s.subSurface.parse(e.subSurface,t,i),e.iridescence&&s.iridescence.parse(e.iridescence,t,i),s}}c.PBRMATERIAL_OPAQUE=l.m.PBRMATERIAL_OPAQUE,c.PBRMATERIAL_ALPHATEST=l.m.PBRMATERIAL_ALPHATEST,c.PBRMATERIAL_ALPHABLEND=l.m.PBRMATERIAL_ALPHABLEND,c.PBRMATERIAL_ALPHATESTANDBLEND=l.m.PBRMATERIAL_ALPHATESTANDBLEND,c.DEFAULT_AO_ON_ANALYTICAL_LIGHTS=l.m.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"directIntensity",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"emissiveIntensity",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"environmentIntensity",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"specularIntensity",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"disableBumpMap",void 0),(0,s.gn)([(0,r.oU)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"albedoTexture",void 0),(0,s.gn)([(0,r.oU)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"baseWeightTexture",void 0),(0,s.gn)([(0,r.oU)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"baseDiffuseRoughnessTexture",void 0),(0,s.gn)([(0,r.oU)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"ambientTexture",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"ambientTextureStrength",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"ambientTextureImpactOnAnalyticalLights",void 0),(0,s.gn)([(0,r.oU)(),(0,r.wz)("_markAllSubMeshesAsTexturesAndMiscDirty")],c.prototype,"opacityTexture",void 0),(0,s.gn)([(0,r.oU)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"reflectionTexture",void 0),(0,s.gn)([(0,r.oU)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"emissiveTexture",void 0),(0,s.gn)([(0,r.oU)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"reflectivityTexture",void 0),(0,s.gn)([(0,r.oU)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"metallicTexture",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"metallic",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"roughness",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"metallicF0Factor",void 0),(0,s.gn)([(0,r.n9)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"metallicReflectanceColor",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useOnlyMetallicFromMetallicReflectanceTexture",void 0),(0,s.gn)([(0,r.oU)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"metallicReflectanceTexture",void 0),(0,s.gn)([(0,r.oU)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"reflectanceTexture",void 0),(0,s.gn)([(0,r.oU)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"microSurfaceTexture",void 0),(0,s.gn)([(0,r.oU)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"bumpTexture",void 0),(0,s.gn)([(0,r.oU)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty",null)],c.prototype,"lightmapTexture",void 0),(0,s.gn)([(0,r.n9)("ambient"),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"ambientColor",void 0),(0,s.gn)([(0,r.n9)("albedo"),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"albedoColor",void 0),(0,s.gn)([(0,r.qC)("baseWeight"),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"baseWeight",void 0),(0,s.gn)([(0,r.qC)("baseDiffuseRoughness"),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"baseDiffuseRoughness",void 0),(0,s.gn)([(0,r.n9)("reflectivity"),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"reflectivityColor",void 0),(0,s.gn)([(0,r.n9)("reflection"),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"reflectionColor",void 0),(0,s.gn)([(0,r.n9)("emissive"),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"emissiveColor",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"microSurface",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useLightmapAsShadowmap",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesAndMiscDirty")],c.prototype,"useAlphaFromAlbedoTexture",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesAndMiscDirty")],c.prototype,"forceAlphaTest",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesAndMiscDirty")],c.prototype,"alphaCutOff",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useSpecularOverAlpha",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useMicroSurfaceFromReflectivityMapAlpha",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useRoughnessFromMetallicTextureAlpha",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useRoughnessFromMetallicTextureGreen",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useMetallnessFromMetallicTextureBlue",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useAmbientOcclusionFromMetallicTextureRed",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useAmbientInGrayScale",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useAutoMicroSurfaceFromReflectivityMap",void 0),(0,s.gn)([(0,r.qC)()],c.prototype,"usePhysicalLightFalloff",null),(0,s.gn)([(0,r.qC)()],c.prototype,"useGLTFLightFalloff",null),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useRadianceOverAlpha",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useObjectSpaceNormalMap",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useParallax",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useParallaxOcclusion",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"parallaxScaleBias",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsLightsDirty")],c.prototype,"disableLighting",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"forceIrradianceInFragment",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsLightsDirty")],c.prototype,"maxSimultaneousLights",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"invertNormalMapX",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"invertNormalMapY",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"twoSidedLighting",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useAlphaFresnel",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useLinearAlphaFresnel",void 0),(0,s.gn)([(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"environmentBRDFTexture",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"forceNormalForward",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"enableSpecularAntiAliasing",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useHorizonOcclusion",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"useRadianceOcclusion",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsMiscDirty")],c.prototype,"unlit",void 0),(0,s.gn)([(0,r.qC)(),(0,r.wz)("_markAllSubMeshesAsMiscDirty")],c.prototype,"applyDecalMapAfterDetailMap",void 0),(0,a.H7)("BABYLON.PBRMaterial",c)}}]);