
//  This file is part of Cosmos Journeyer
//
//  Copyright (C) 2024 Barthélemy Paléologue <barth.paleologue@cosmosjourneyer.com>
//
//  This program is free software: you can redistribute it and/or modify
//  it under the terms of the GNU Affero General Public License as published by
//  the Free Software Foundation, either version 3 of the License, or
//  (at your option) any later version.
//
//  This program is distributed in the hope that it will be useful,
//  but WITHOUT ANY WARRANTY; without even the implied warranty of
//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//  GNU Affero General Public License for more details.
//
//  You should have received a copy of the GNU Affero General Public License
//  along with this program.  If not, see <https://www.gnu.org/licenses/>.
        
"use strict";(self.webpackChunkcosmos_journeyer=self.webpackChunkcosmos_journeyer||[]).push([[301],{59113:(t,e,r)=>{r.d(e,{FA:()=>b,O_:()=>_});var n=r(52101);const a=1,o=2,i=3,s=9,h=10,c=11,l=48,g=4,f=0,u=1,d=2,w=3;function _(t){let e=0;return{id_length:t[e++],colormap_type:t[e++],image_type:t[e++],colormap_index:t[e++]|t[e++]<<8,colormap_length:t[e++]|t[e++]<<8,colormap_size:t[e++],origin:[t[e++]|t[e++]<<8,t[e++]|t[e++]<<8],width:t[e++]|t[e++]<<8,height:t[e++]|t[e++]<<8,pixel_size:t[e++],flags:t[e++]}}function b(t,e){if(e.length<19)return void n.V.Error("Unable to load TGA file - Not enough data to contain header");let r=18;const b=_(e);if(b.id_length+r>e.length)return void n.V.Error("Unable to load TGA file - Not enough data");r+=b.id_length;let y,m=!1,A=!1,U=!1;switch(b.image_type){case s:m=!0;case a:A=!0;break;case h:m=!0;case o:break;case c:m=!0;case i:U=!0}const D=b.pixel_size>>3,k=b.width*b.height*D;let G,I,T,x,C,v,z;if(A&&(G=e.subarray(r,r+=b.colormap_length*(b.colormap_size>>3))),m){let t,n,a;y=new Uint8Array(k);let o=0;const i=new Uint8Array(D);for(;r<k&&o<k;)if(t=e[r++],n=1+(127&t),128&t){for(a=0;a<D;++a)i[a]=e[r++];for(a=0;a<n;++a)y.set(i,o+a*D);o+=D*n}else{for(n*=D,a=0;a<n;++a)y[o+a]=e[r++];o+=n}}else y=e.subarray(r,r+=A?b.width*b.height:k);switch((b.flags&l)>>g){default:case d:I=0,x=1,z=b.width,T=0,C=1,v=b.height;break;case f:I=0,x=1,z=b.width,T=b.height-1,C=-1,v=-1;break;case w:I=b.width-1,x=-1,z=-1,T=0,C=1,v=b.height;break;case u:I=b.width-1,x=-1,z=-1,T=b.height-1,C=-1,v=-1}const E="_getImageData"+(U?"Grey":"")+b.pixel_size+"bits",O=p[E](b,G,y,T,C,v,I,x,z);t.getEngine()._uploadDataToTextureDirectly(t,O)}const p={GetTGAHeader:_,UploadContent:b,_getImageData8bits:function(t,e,r,n,a,o,i,s,h){const c=r,l=e,g=t.width,f=t.height;let u,d,w,_=0;const b=new Uint8Array(g*f*4);for(w=n;w!==o;w+=a)for(d=i;d!==h;d+=s,_++)u=c[_],b[4*(d+g*w)+3]=255,b[4*(d+g*w)+2]=l[3*u+0],b[4*(d+g*w)+1]=l[3*u+1],b[4*(d+g*w)+0]=l[3*u+2];return b},_getImageData16bits:function(t,e,r,n,a,o,i,s,h){const c=r,l=t.width,g=t.height;let f,u,d,w=0;const _=new Uint8Array(l*g*4);for(d=n;d!==o;d+=a)for(u=i;u!==h;u+=s,w+=2){f=c[w+0]+(c[w+1]<<8);const t=255*((31744&f)>>10)/31|0,e=255*((992&f)>>5)/31|0,r=255*(31&f)/31|0;_[4*(u+l*d)+0]=t,_[4*(u+l*d)+1]=e,_[4*(u+l*d)+2]=r,_[4*(u+l*d)+3]=32768&f?0:255}return _},_getImageData24bits:function(t,e,r,n,a,o,i,s,h){const c=r,l=t.width,g=t.height;let f,u,d=0;const w=new Uint8Array(l*g*4);for(u=n;u!==o;u+=a)for(f=i;f!==h;f+=s,d+=3)w[4*(f+l*u)+3]=255,w[4*(f+l*u)+2]=c[d+0],w[4*(f+l*u)+1]=c[d+1],w[4*(f+l*u)+0]=c[d+2];return w},_getImageData32bits:function(t,e,r,n,a,o,i,s,h){const c=r,l=t.width,g=t.height;let f,u,d=0;const w=new Uint8Array(l*g*4);for(u=n;u!==o;u+=a)for(f=i;f!==h;f+=s,d+=4)w[4*(f+l*u)+2]=c[d+0],w[4*(f+l*u)+1]=c[d+1],w[4*(f+l*u)+0]=c[d+2],w[4*(f+l*u)+3]=c[d+3];return w},_getImageDataGrey8bits:function(t,e,r,n,a,o,i,s,h){const c=r,l=t.width,g=t.height;let f,u,d,w=0;const _=new Uint8Array(l*g*4);for(d=n;d!==o;d+=a)for(u=i;u!==h;u+=s,w++)f=c[w],_[4*(u+l*d)+0]=f,_[4*(u+l*d)+1]=f,_[4*(u+l*d)+2]=f,_[4*(u+l*d)+3]=255;return _},_getImageDataGrey16bits:function(t,e,r,n,a,o,i,s,h){const c=r,l=t.width,g=t.height;let f,u,d=0;const w=new Uint8Array(l*g*4);for(u=n;u!==o;u+=a)for(f=i;f!==h;f+=s,d+=2)w[4*(f+l*u)+0]=c[d+0],w[4*(f+l*u)+1]=c[d+0],w[4*(f+l*u)+2]=c[d+0],w[4*(f+l*u)+3]=c[d+1];return w}}},77301:(t,e,r)=>{r.r(e),r.d(e,{_TGATextureLoader:()=>a});var n=r(59113);class a{constructor(){this.supportCascades=!1}loadCubeData(){throw".env not supported in Cube."}loadData(t,e,r){const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),o=(0,n.O_)(a);r(o.width,o.height,e.generateMipMaps,!1,(()=>{(0,n.FA)(e,a)}))}}}}]);