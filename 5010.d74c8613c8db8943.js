"use strict";(globalThis.webpackChunkcosmos_journeyer=globalThis.webpackChunkcosmos_journeyer||[]).push([["5010"],{18316:function(e,t,r){r.d(t,{B:()=>n});var a=r(61834);class n{static ConvertPanoramaToCubemap(e,t,r,a,n=!1){if(!e)throw"ConvertPanoramaToCubemap: input cannot be null";if(e.length!=t*r*3)throw"ConvertPanoramaToCubemap: input size is wrong";let o=this.CreateCubemapTexture(a,this.FACE_FRONT,e,t,r,n),i=this.CreateCubemapTexture(a,this.FACE_BACK,e,t,r,n),h=this.CreateCubemapTexture(a,this.FACE_LEFT,e,t,r,n),u=this.CreateCubemapTexture(a,this.FACE_RIGHT,e,t,r,n);return{front:o,back:i,left:h,right:u,up:this.CreateCubemapTexture(a,this.FACE_UP,e,t,r,n),down:this.CreateCubemapTexture(a,this.FACE_DOWN,e,t,r,n),size:a,type:1,format:4,gammaSpace:!1}}static CreateCubemapTexture(e,t,r,a,n,o=!1){let i=new Float32Array(new ArrayBuffer(e*e*12)),h=o?Math.max(1,Math.round(a/4/e)):1,u=1/h,l=u*u,w=t[1].subtract(t[0]).scale(u/e),s=t[3].subtract(t[2]).scale(u/e),f=1/e,d=0;for(let o=0;o<e;o++)for(let c=0;c<h;c++){let c=t[0],C=t[2];for(let t=0;t<e;t++)for(let u=0;u<h;u++){let h=C.subtract(c).scale(d).add(c);h.normalize();let u=this.CalcProjectionSpherical(h,r,a,n);i[o*e*3+3*t+0]+=u.r*l,i[o*e*3+3*t+1]+=u.g*l,i[o*e*3+3*t+2]+=u.b*l,c=c.add(w),C=C.add(s)}d+=f*u}return i}static CalcProjectionSpherical(e,t,r,a){let n=Math.atan2(e.z,e.x),o=Math.acos(e.y);for(;n<-Math.PI;)n+=2*Math.PI;for(;n>Math.PI;)n-=2*Math.PI;let i=n/Math.PI,h=o/Math.PI,u=Math.round((i=.5*i+.5)*r);u<0?u=0:u>=r&&(u=r-1);let l=Math.round(h*a);l<0?l=0:l>=a&&(l=a-1);let w=a-l-1,s=t[w*r*3+3*u+0];return{r:s,g:t[w*r*3+3*u+1],b:t[w*r*3+3*u+2]}}}n.FACE_LEFT=[new a.P(-1,-1,-1),new a.P(1,-1,-1),new a.P(-1,1,-1),new a.P(1,1,-1)],n.FACE_RIGHT=[new a.P(1,-1,1),new a.P(-1,-1,1),new a.P(1,1,1),new a.P(-1,1,1)],n.FACE_FRONT=[new a.P(1,-1,-1),new a.P(1,-1,1),new a.P(1,1,-1),new a.P(1,1,1)],n.FACE_BACK=[new a.P(-1,-1,1),new a.P(-1,-1,-1),new a.P(-1,1,1),new a.P(-1,1,-1)],n.FACE_DOWN=[new a.P(1,1,-1),new a.P(1,1,1),new a.P(-1,1,-1),new a.P(-1,1,1)],n.FACE_UP=[new a.P(-1,-1,-1),new a.P(-1,-1,1),new a.P(1,-1,-1),new a.P(1,-1,1)]},49087:function(e,t,r){r.d(t,{Nn:()=>n,Q_:()=>o,kn:()=>i,zp:()=>a});let a=1/2.2,n=2.2,o=(1+Math.sqrt(5))/2,i=.001},56672:function(e,t,r){r.d(t,{dK:()=>i,ls:()=>u,od:()=>h,sw:()=>w});var a=r(18316);function n(e,t,r,a,n,o){if(n>0){var i;n=(i=n-136)>1023?898846567431158e293*Math.pow(2,i-1023):i<-1074?5e-324*1*Math.pow(2,i+1074):+Math.pow(2,i),e[o+0]=t*n,e[o+1]=r*n,e[o+2]=a*n}else e[o+0]=0,e[o+1]=0,e[o+2]=0}function o(e,t){let r="",a="";for(let n=t;n<e.length-t&&"\n"!=(a=String.fromCharCode(e[n]));n++)r+=a;return r}function i(e){let t=0,r=0,a=o(e,0);if("#"!=a[0]||"?"!=a[1])throw"Bad HDR Format.";let n=!1,i=!1,h=0;do h+=a.length+1,"FORMAT=32-bit_rle_rgbe"==(a=o(e,h))?i=!0:0==a.length&&(n=!0);while(!n);if(!i)throw"HDR Bad header format, unsupported FORMAT";h+=a.length+1,a=o(e,h);let u=/^-Y (.*) \+X (.*)$/g.exec(a);if(!u||u.length<3)throw"HDR Bad header format, no size";if(r=parseInt(u[2]),t=parseInt(u[1]),r<8||r>32767)throw"HDR Bad header format, unsupported size";return{height:t,width:r,dataPosition:h+=a.length+1}}function h(e,t,r=!1){let n=new Uint8Array(e),o=i(n),u=l(n,o);return a.B.ConvertPanoramaToCubemap(u,o.width,o.height,t,r)}function u(e,t){return l(e,t)}function l(e,t){let r,a,o,i,h,u=t.height,l=t.width,w=t.dataPosition,s=0,f=0,d=0,c=new Uint8Array(new ArrayBuffer(4*l)),C=new Float32Array(new ArrayBuffer(t.width*t.height*12));for(;u>0;){if(r=e[w++],a=e[w++],o=e[w++],i=e[w++],2!=r||2!=a||128&o||t.width<8||t.width>32767)return function(e,t){let r,a,o,i=t.height,h=t.width,u=t.dataPosition,l=new Float32Array(new ArrayBuffer(t.width*t.height*12));for(;i>0;){for(o=0;o<t.width;o++)r=e[u++],a=e[u++],n(l,r,a,e[u++],e[u++],(t.height-i)*h*3+3*o);i--}return l}(e,t);if((o<<8|i)!=l)throw"HDR Bad header format, wrong scan line width";for(d=0,s=0;d<4;d++)for(f=(d+1)*l;s<f;)if(r=e[w++],a=e[w++],r>128){if(0==(h=r-128)||h>f-s)throw"HDR Bad Format, bad scanline data (run)";for(;h-- >0;)c[s++]=a}else{if(0==(h=r)||h>f-s)throw"HDR Bad Format, bad scanline data (non-run)";if(c[s++]=a,--h>0)for(let t=0;t<h;t++)c[s++]=e[w++]}for(d=0;d<l;d++)r=c[d],a=c[d+l],n(C,r,a,o=c[d+2*l],i=c[d+3*l],(t.height-u)*l*3+3*d);u--}return C}let w={RGBE_ReadHeader:i,GetCubeMapTextureData:h,RGBE_ReadPixels:u}},86502:function(e,t,r){r.r(t),r.d(t,{_HDRTextureLoader:()=>n});var a=r(56672);class n{constructor(){this.supportCascades=!1}loadCubeData(){throw".hdr not supported in Cube."}loadData(e,t,r){let n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),o=(0,a.dK)(n),i=(0,a.ls)(n,o),h=o.width*o.height,u=new Float32Array(4*h);for(let e=0;e<h;e+=1)u[4*e]=i[3*e],u[4*e+1]=i[3*e+1],u[4*e+2]=i[3*e+2],u[4*e+3]=1;r(o.width,o.height,t.generateMipMaps,!1,()=>{let e=t.getEngine();t.type=1,t.format=5,t._gammaSpace=!1,e._uploadDataToTextureDirectly(t,u)})}}}}]);