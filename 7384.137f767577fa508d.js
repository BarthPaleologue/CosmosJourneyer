/*
 *  This file is part of Cosmos Journeyer
 *
 *  Copyright (C) 2024 Barthélemy Paléologue <barth.paleologue@cosmosjourneyer.com>
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Affero General Public License for more details.
 *
 *  You should have received a copy of the GNU Affero General Public License
 *  along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */

"use strict";(globalThis.webpackChunkcosmos_journeyer=globalThis.webpackChunkcosmos_journeyer||[]).push([["7384"],{11740:function(t,e,r){r.d(e,{V:()=>c});var i=r(69254),s=r(88609),a=r(85791),n=r(61834),h=r(65098),o=r(53986);r(21381);var l=r(81965),u=r(90131);class c extends l.g{set hasAlpha(t){this._hasAlpha!==t&&(this._hasAlpha=t,this._scene&&this._scene.markAllMaterialsAsDirty(1,t=>t.hasTexture(this)))}get hasAlpha(){return this._hasAlpha}set getAlphaFromRGB(t){this._getAlphaFromRGB!==t&&(this._getAlphaFromRGB=t,this._scene&&this._scene.markAllMaterialsAsDirty(1,t=>t.hasTexture(this)))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(t){this._coordinatesIndex!==t&&(this._coordinatesIndex=t,this._scene&&this._scene.markAllMaterialsAsDirty(1,t=>t.hasTexture(this)))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(t){this._coordinatesMode!==t&&(this._coordinatesMode=t,this._scene&&this._scene.markAllMaterialsAsDirty(1,t=>t.hasTexture(this)))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(t){this._wrapU=t}get wrapV(){return this._wrapV}set wrapV(t){this._wrapV=t}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(t){this._texture?this._texture.isCube=t:this._isCube=t}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(t){this._texture&&(this._texture.is3D=t)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(t){this._texture&&(this._texture.is2DArray=t)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(t){if(this._texture){if(this._texture._gammaSpace===t)return;this._texture._gammaSpace=t}else{if(this._gammaSpace===t)return;this._gammaSpace=t}this.getScene()?.markAllMaterialsAsDirty(1,t=>t.hasTexture(this))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(t){t!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=t),this.getScene()?.markAllMaterialsAsDirty(1,t=>t.hasTexture(this)))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(t){this._texture&&(this._texture._lodGenerationOffset=t)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(t){this._texture&&(this._texture._lodGenerationScale=t)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(t){this._texture&&(this._texture._linearSpecularLOD=t)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(t){this._texture&&(this._texture._irradianceTexture=t)}get uid(){return this._uid||(this._uid=(0,o.f)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(t,e=null){super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=c.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this._dominantDirection=null,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.onDisposeObservable=new a.y$,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,t?c._IsScene(t)?this._scene=t:this._engine=t:this._scene=h.l.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=e,this._uid=null}getScene(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return n.y3.IdentityReadOnly}getReflectionTextureMatrix(){return n.y3.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(t){}get canRescale(){return!1}_getFromCache(t,e,r,i,s,a){let n=this._getEngine();if(!n)return null;let h=n._getUseSRGBBuffer(!!s,e),o=n.getLoadedTexturesCache();for(let n=0;n<o.length;n++){let l=o[n];if((void 0===s||h===l._useSRGBBuffer)&&(void 0===i||i===l.invertY)&&l.url===t&&!e===l.generateMipMaps&&(!r||r===l.samplingMode)&&(void 0===a||a===l.isCube))return l.incrementReferences(),l}return null}_rebuild(t=!1){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){let t=this.getScene();t&&t.markAllMaterialsAsDirty(1)}readPixels(t=0,e=0,r=null,i=!0,s=!1,a=0,n=0,h=Number.MAX_VALUE,o=Number.MAX_VALUE){if(!this._texture)return null;let l=this._getEngine();if(!l)return null;let u=this.getSize(),c=u.width,d=u.height;0!==e&&(c/=Math.pow(2,e),d/=Math.pow(2,e),c=Math.round(c),d=Math.round(d)),h=Math.min(c,h),o=Math.min(d,o);try{if(this._texture.isCube)return l._readTexturePixels(this._texture,h,o,t,e,r,i,s,a,n);return l._readTexturePixels(this._texture,h,o,-1,e,r,i,s,a,n)}catch(t){return null}}_readPixelsSync(t=0,e=0,r=null,i=!0,s=!1){if(!this._texture)return null;let a=this.getSize(),n=a.width,h=a.height,o=this._getEngine();if(!o)return null;0!=e&&(n/=Math.pow(2,e),h/=Math.pow(2,e),n=Math.round(n),h=Math.round(h));try{if(this._texture.isCube)return o._readTexturePixelsSync(this._texture,n,h,t,e,r,i,s);return o._readTexturePixelsSync(this._texture,n,h,-1,e,r,i,s)}catch(t){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);let t=this._scene.textures.indexOf(this);if(t>=0&&this._scene.textures.splice(t,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){let t=this._parentContainer.textures.indexOf(this);t>-1&&this._parentContainer.textures.splice(t,1),this._parentContainer=null}}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.metadata=null,super.dispose()}serialize(t=!1){if(!this.name&&!t)return null;let e=u.p.Serialize(this);return u.p.AppendSerializedAnimations(this,e),e}static WhenAllReady(t,e){let r=t.length;if(0===r)return void e();for(let i=0;i<t.length;i++){let s=t[i];if(s.isReady())0==--r&&e();else{let t=s.onLoadObservable;t?t.addOnce(()=>{0==--r&&e()}):0==--r&&e()}}}static _IsScene(t){return"Scene"===t.getClassName()}}c.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,i.gn)([(0,s.qC)()],c.prototype,"uniqueId",void 0),(0,i.gn)([(0,s.qC)()],c.prototype,"name",void 0),(0,i.gn)([(0,s.qC)()],c.prototype,"displayName",void 0),(0,i.gn)([(0,s.qC)()],c.prototype,"metadata",void 0),(0,i.gn)([(0,s.qC)("hasAlpha")],c.prototype,"_hasAlpha",void 0),(0,i.gn)([(0,s.qC)("getAlphaFromRGB")],c.prototype,"_getAlphaFromRGB",void 0),(0,i.gn)([(0,s.qC)()],c.prototype,"level",void 0),(0,i.gn)([(0,s.qC)("coordinatesIndex")],c.prototype,"_coordinatesIndex",void 0),(0,i.gn)([(0,s.qC)()],c.prototype,"optimizeUVAllocation",void 0),(0,i.gn)([(0,s.qC)("coordinatesMode")],c.prototype,"_coordinatesMode",void 0),(0,i.gn)([(0,s.qC)()],c.prototype,"wrapU",null),(0,i.gn)([(0,s.qC)()],c.prototype,"wrapV",null),(0,i.gn)([(0,s.qC)()],c.prototype,"wrapR",void 0),(0,i.gn)([(0,s.qC)()],c.prototype,"anisotropicFilteringLevel",void 0),(0,i.gn)([(0,s.qC)()],c.prototype,"isCube",null),(0,i.gn)([(0,s.qC)()],c.prototype,"is3D",null),(0,i.gn)([(0,s.qC)()],c.prototype,"is2DArray",null),(0,i.gn)([(0,s.qC)()],c.prototype,"gammaSpace",null),(0,i.gn)([(0,s.qC)()],c.prototype,"invertZ",void 0),(0,i.gn)([(0,s.qC)()],c.prototype,"lodLevelInAlpha",void 0),(0,i.gn)([(0,s.qC)()],c.prototype,"lodGenerationOffset",null),(0,i.gn)([(0,s.qC)()],c.prototype,"lodGenerationScale",null),(0,i.gn)([(0,s.qC)()],c.prototype,"linearSpecularLOD",null),(0,i.gn)([(0,s.oU)()],c.prototype,"irradianceTexture",null),(0,i.gn)([(0,s.qC)()],c.prototype,"isRenderTarget",void 0)},32160:function(t,e,r){r.d(e,{x:()=>m});var i=r(69254),s=r(88609),a=r(85791),n=r(61834),h=r(11740),o=r(46363),l=r(53864),u=r(67109),c=r(84137),d=r(62941),_=r(42462),g=r(89662),f=r(5902),p=r(90131);class m extends h.V{static _CreateVideoTexture(t,e,r,i=!1,s=!1,a=m.TRILINEAR_SAMPLINGMODE,n={},h,o=5){throw(0,l.S)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(t){this._isBlocking=t}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(t,e,r,i,s=m.TRILINEAR_SAMPLINGMODE,n=null,h=null,o=null,l=!1,c,d,_,g,p){let x;super(e),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new a.y$,this._isBlocking=!0,this.name=t||"",this.url=t;let b=!1,R=null,T=!0;"object"==typeof r&&null!==r?(x=r.noMipmap??!1,i=r.invertY??!f.VJ,s=r.samplingMode??m.TRILINEAR_SAMPLINGMODE,n=r.onLoad??null,h=r.onError??null,o=r.buffer??null,l=r.deleteBuffer??!1,c=r.format,d=r.mimeType,_=r.loaderOptions,g=r.creationFlags,b=r.useSRGBBuffer??!1,R=r.internalTexture??null,T=r.gammaSpace??T,p=r.forcedExtension??p):x=!!r,this._gammaSpace=T,this._noMipmap=x,this._invertY=void 0===i?!f.VJ:i,this._initialSamplingMode=s,this._buffer=o,this._deleteBuffer=l,this._mimeType=d,this._loaderOptions=_,this._creationFlags=g,this._useSRGBBuffer=b,this._forcedExtension=p,void 0!==c&&(this._format=c);let M=this.getScene(),y=this._getEngine();if(!y)return;y.onBeforeTextureInitObservable.notifyObservers(this);let S=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),n&&n(),!this.isBlocking&&M&&M.resetCachedMaterial()},C=(t,e)=>{this._loadingError=!0,this._errorObject={message:t,exception:e},h&&h(t,e),m.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!R){this._delayedOnLoad=S,this._delayedOnError=C;return}if(this._texture=R??this._getFromCache(this.url,x,s,this._invertY,b,this.isCube),this._texture)if(this._texture.isReady)u.Q.SetImmediate(()=>S());else{let t=this._texture.onLoadedObservable.add(S);this._texture.onErrorObservable.add(e=>{C(e.message,e.exception),this._texture?.onLoadedObservable.remove(t)})}else if(M&&M.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=S,this._delayedOnError=C;else{try{this._texture=y.createTexture(this.url,x,this._invertY,M,s,S,C,this._buffer,void 0,this._format,this._forcedExtension,d,_,g,b)}catch(t){throw C("error loading",t),t}l&&(this._buffer=null)}}updateURL(t,e=null,r,i){this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(1,t=>t.hasTexture(this))),(!this.name||this.name.startsWith("data:"))&&(this.name=t),this.url=t,this._buffer=e,this._forcedExtension=i,this.delayLoadState=4,r&&(this._delayedOnLoad=r),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;let t=this.getScene();t&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?u.Q.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=t.getEngine().createTexture(this.url,this._noMipmap,this._invertY,t,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(t,e,r,i){t*=this._cachedUScale,e*=this._cachedVScale,t-=this.uRotationCenter*this._cachedUScale,e-=this.vRotationCenter*this._cachedVScale,r-=this.wRotationCenter,n.P.TransformCoordinatesFromFloatsToRef(t,e,r,this._rowGenerationMatrix,i),i.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,i.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,i.z+=this.wRotationCenter}getTextureMatrix(t=1){if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*t===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*t,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=n.y3.Zero(),this._rowGenerationMatrix=new n.y3,this._t0=n.P.Zero(),this._t1=n.P.Zero(),this._t2=n.P.Zero()),n.y3.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(n.y3.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,n.jp.Matrix["0"]),n.y3.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,n.jp.Matrix["1"]),n.y3.ScalingToRef(this._cachedUScale,this._cachedVScale,0,n.jp.Matrix["2"]),n.y3.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,n.jp.Matrix["3"]),n.jp.Matrix["0"].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(n.jp.Matrix["1"],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(n.jp.Matrix["2"],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(n.jp.Matrix["3"],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),n.y3.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));let e=this.getScene();if(!e)return this._cachedTextureMatrix;let r=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&r!==this._cachedIdentity3x2&&e.markAllMaterialsAsDirty(1,t=>t.hasTexture(this)),this._cachedTextureMatrix}getReflectionTextureMatrix(){let t=this.getScene();if(!t)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==m.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;else if(this._cachedReflectionProjectionMatrixId===t.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=n.y3.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=n.y3.Zero());let e=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case m.PLANAR_MODE:n.y3.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case m.PROJECTION_MODE:{n.y3.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);let e=t.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=e.updateFlag,e.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:n.y3.IdentityToRef(this._cachedReflectionTextureMatrix)}return e&&t.markAllMaterialsAsDirty(1,t=>t.hasTexture(this)),this._cachedReflectionTextureMatrix}clone(){let t={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,onLoad:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return p.p.Clone(()=>new m(this._texture?this._texture.url:null,this.getScene(),t),this)}serialize(){let t=this.name;!m.SerializeBuffers&&this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");let e=super.serialize(m._SerializeInternalTextureUniqueId);if(!e)return null;if(m.SerializeBuffers||m.ForceSerializeBuffers)if("string"==typeof this._buffer&&this._buffer.startsWith("data:"))e.base64String=this._buffer,e.name=e.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){let t=this.mimeType||"image/png";e.base64String=`data:${t};base64,${(0,_.Gh)(this._buffer)}`}else(m.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(e.base64String=!this._engine||this._engine._features.supportSyncTextureRead?(0,g._u)(this):(0,g.Jj)(this));return e.invertY=this._invertY,e.samplingMode=this.samplingMode,e._creationFlags=this._creationFlags,e._useSRGBBuffer=this._useSRGBBuffer,m._SerializeInternalTextureUniqueId&&(e.internalTextureUniqueId=this._texture?.uniqueId),e.internalTextureLabel=this._texture?.label,e.noMipmap=this._noMipmap,this.name=t,e}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(t,e,r){let i;if(t.customType){let i=c.K.Instantiate(t.customType).Parse(t,e,r);return t.samplingMode&&i.updateSamplingMode&&i._samplingMode&&i._samplingMode!==t.samplingMode&&i.updateSamplingMode(t.samplingMode),i}if(t.isCube&&!t.isRenderTarget)return m._CubeTextureParser(t,e,r);let s=void 0!==t.internalTextureUniqueId;if(!t.name&&!t.isRenderTarget&&!s)return null;if(s){for(let r of e.getEngine().getLoadedTexturesCache())if(r.uniqueId===t.internalTextureUniqueId){i=r;break}}let a=e=>{if(e&&e._texture&&(e._texture._cachedWrapU=null,e._texture._cachedWrapV=null,e._texture._cachedWrapR=null),t.samplingMode){let r=t.samplingMode;e&&e.samplingMode!==r&&e.updateSamplingMode(r)}if(e&&t.animations)for(let r=0;r<t.animations.length;r++){let i=t.animations[r],s=(0,o.qw)("BABYLON.Animation");s&&e.animations.push(s.Parse(i))}e&&e._texture&&(s&&!i&&e._texture._setUniqueId(t.internalTextureUniqueId),e._texture.label=t.internalTextureLabel)};return p.p.Parse(()=>{let s=!0;if(t.noMipmap&&(s=!1),t.mirrorPlane){let r=m._CreateMirror(t.name,t.renderTargetSize,e,s);return r._waitingRenderList=t.renderList,r.mirrorPlane=d.J.FromArray(t.mirrorPlane),a(r),r}if(t.isRenderTarget){let r=null;if(t.isCube){if(e.reflectionProbes)for(let r=0;r<e.reflectionProbes.length;r++){let i=e.reflectionProbes[r];if(i.name===t.name)return i.cubeTexture}}else(r=m._CreateRenderTargetTexture(t.name,t.renderTargetSize,e,s,t._creationFlags??0))._waitingRenderList=t.renderList;return a(r),r}if(t.isVideo){let i=m._CreateVideoTexture(r+(t.url||t.name),r+(t.src||t.url),e,s,t.invertY,t.samplingMode,t.settings||{});return a(i),i}{let n;if(t.base64String&&!i)(n=m.CreateFromBase64String(t.base64String,t.base64String,e,!s,t.invertY,t.samplingMode,()=>{a(n)},t._creationFlags??0,t._useSRGBBuffer??!1)).name=t.name;else{let h;h=t.name&&(t.name.indexOf("://")>0||t.name.startsWith("data:"))?t.name:r+t.name,t.url&&(t.url.startsWith("data:")||m.UseSerializedUrlIfAny)&&(h=t.url),n=new m(h,e,{noMipmap:!s,invertY:t.invertY,samplingMode:t.samplingMode,onLoad:()=>{a(n)},internalTexture:i})}return n}},t,e)}static CreateFromBase64String(t,e,r,i,s,a=m.TRILINEAR_SAMPLINGMODE,n=null,h=null,o=5,l,u){return new m("data:"+e,r,i,s,a,n,h,t,!1,o,void 0,void 0,l,u)}static LoadFromDataString(t,e,r,i=!1,s,a=!0,n=m.TRILINEAR_SAMPLINGMODE,h=null,o=null,l=5,u,c){return"data:"!==t.substring(0,5)&&(t="data:"+t),new m(t,r,s,a,n,h,o,e,i,l,void 0,void 0,u,c)}}m.SerializeBuffers=!0,m.ForceSerializeBuffers=!1,m.OnTextureLoadErrorObservable=new a.y$,m._SerializeInternalTextureUniqueId=!1,m._CubeTextureParser=(t,e,r)=>{throw(0,l.S)("CubeTexture")},m._CreateMirror=(t,e,r,i)=>{throw(0,l.S)("MirrorTexture")},m._CreateRenderTargetTexture=(t,e,r,i,s)=>{throw(0,l.S)("RenderTargetTexture")},m.NEAREST_SAMPLINGMODE=1,m.NEAREST_NEAREST_MIPLINEAR=8,m.BILINEAR_SAMPLINGMODE=2,m.LINEAR_LINEAR_MIPNEAREST=11,m.TRILINEAR_SAMPLINGMODE=3,m.LINEAR_LINEAR_MIPLINEAR=3,m.NEAREST_NEAREST_MIPNEAREST=4,m.NEAREST_LINEAR_MIPNEAREST=5,m.NEAREST_LINEAR_MIPLINEAR=6,m.NEAREST_LINEAR=7,m.NEAREST_NEAREST=1,m.LINEAR_NEAREST_MIPNEAREST=9,m.LINEAR_NEAREST_MIPLINEAR=10,m.LINEAR_LINEAR=2,m.LINEAR_NEAREST=12,m.EXPLICIT_MODE=0,m.SPHERICAL_MODE=1,m.PLANAR_MODE=2,m.CUBIC_MODE=3,m.PROJECTION_MODE=4,m.SKYBOX_MODE=5,m.INVCUBIC_MODE=6,m.EQUIRECTANGULAR_MODE=7,m.FIXED_EQUIRECTANGULAR_MODE=8,m.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,m.CLAMP_ADDRESSMODE=0,m.WRAP_ADDRESSMODE=1,m.MIRROR_ADDRESSMODE=2,m.UseSerializedUrlIfAny=!1,(0,i.gn)([(0,s.qC)()],m.prototype,"url",void 0),(0,i.gn)([(0,s.qC)()],m.prototype,"uOffset",void 0),(0,i.gn)([(0,s.qC)()],m.prototype,"vOffset",void 0),(0,i.gn)([(0,s.qC)()],m.prototype,"uScale",void 0),(0,i.gn)([(0,s.qC)()],m.prototype,"vScale",void 0),(0,i.gn)([(0,s.qC)()],m.prototype,"uAng",void 0),(0,i.gn)([(0,s.qC)()],m.prototype,"vAng",void 0),(0,i.gn)([(0,s.qC)()],m.prototype,"wAng",void 0),(0,i.gn)([(0,s.qC)()],m.prototype,"uRotationCenter",void 0),(0,i.gn)([(0,s.qC)()],m.prototype,"vRotationCenter",void 0),(0,i.gn)([(0,s.qC)()],m.prototype,"wRotationCenter",void 0),(0,i.gn)([(0,s.qC)()],m.prototype,"homogeneousRotationInUVTransform",void 0),(0,i.gn)([(0,s.qC)()],m.prototype,"isBlocking",null),(0,o.H7)("BABYLON.Texture",m),p.p._TextureParser=m.Parse},44968:function(t,e,r){r.d(e,{q:()=>i});class i{static Eval(t,e){return"true"===(t=t.match(/\([^()]*\)/g)?t.replace(/\([^()]*\)/g,t=>(t=t.slice(1,t.length-1),i._HandleParenthesisContent(t,e))):i._HandleParenthesisContent(t,e))||"false"!==t&&i.Eval(t,e)}static _HandleParenthesisContent(t,e){let r;e=e||(t=>"true"===t);let s=t.split("||");for(let t in s)if(Object.prototype.hasOwnProperty.call(s,t)){let a=i._SimplifyNegation(s[t].trim()),n=a.split("&&");if(n.length>1)for(let t=0;t<n.length;++t){let s=i._SimplifyNegation(n[t].trim());if(!(r="true"!==s&&"false"!==s?"!"===s[0]?!e(s.substring(1)):e(s):"true"===s)){a="false";break}}if(r||"true"===a){r=!0;break}r="true"!==a&&"false"!==a?"!"===a[0]?!e(a.substring(1)):e(a):"true"===a}return r?"true":"false"}static _SimplifyNegation(t){return"!true"===(t=(t=t.replace(/^[\s!]+/,t=>(t=t.replace(/[\s]/g,()=>"")).length%2?"!":"")).trim())?t="false":"!false"===t&&(t="true"),t}}},49217:function(t,e,r){r.d(e,{D:()=>n,x:()=>a});let i={},s={};function a(t){let e=t.getClassName();return s[e]||(s[e]={}),s[e]}function n(t){let e=t.getClassName();if(i[e])return i[e];i[e]={};let r=i[e],a=t,n=e;for(;n;){let t,e=s[n];for(let t in e)r[t]=e[t];let i=!1;do{if(!(t=Object.getPrototypeOf(a)).getClassName){i=!0;break}if(t.getClassName()!==n)break;a=t}while(t);if(i)break;n=t.getClassName(),a=t}return r}},57423:function(t,e,r){r.d(e,{HE:()=>d,Wo:()=>c,zZ:()=>_});var i=r(84865),s=r(46363),a=r(49087),n=r(16891);function h(t){return Math.pow(t,a.Nn)}function o(t){return t<=.04045?.0773993808*t:Math.pow(.947867299*(t+.055),2.4)}function l(t){return Math.pow(t,a.zp)}function u(t){return t<=.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class c{constructor(t=0,e=0,r=0){this.r=t,this.g=e,this.b=r}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let t=255*this.r|0;return 397*(t=397*t^(255*this.g|0))^(255*this.b|0)}toArray(t,e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,this}fromArray(t,e=0){return c.FromArrayToRef(t,e,this),this}toColor4(t=1){return new d(this.r,this.g,this.b,t)}asArray(){return[this.r,this.g,this.b]}toLuminance(){return .3*this.r+.59*this.g+.11*this.b}multiply(t){return new c(this.r*t.r,this.g*t.g,this.b*t.b)}multiplyToRef(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,e}multiplyInPlace(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyByFloats(t,e,r){return new c(this.r*t,this.g*e,this.b*r)}divide(t){throw ReferenceError("Can not divide a color")}divideToRef(t,e){throw ReferenceError("Can not divide a color")}divideInPlace(t){throw ReferenceError("Can not divide a color")}minimizeInPlace(t){return this.minimizeInPlaceFromFloats(t.r,t.g,t.b)}maximizeInPlace(t){return this.maximizeInPlaceFromFloats(t.r,t.g,t.b)}minimizeInPlaceFromFloats(t,e,r){return this.r=Math.min(t,this.r),this.g=Math.min(e,this.g),this.b=Math.min(r,this.b),this}maximizeInPlaceFromFloats(t,e,r){return this.r=Math.max(t,this.r),this.g=Math.max(e,this.g),this.b=Math.max(r,this.b),this}floorToRef(t){throw ReferenceError("Can not floor a color")}floor(){throw ReferenceError("Can not floor a color")}fractToRef(t){throw ReferenceError("Can not fract a color")}fract(){throw ReferenceError("Can not fract a color")}equals(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b}equalsFloats(t,e,r){return this.equalsToFloats(t,e,r)}equalsToFloats(t,e,r){return this.r===t&&this.g===e&&this.b===r}equalsWithEpsilon(t,e=a.kn){return(0,n.WithinEpsilon)(this.r,t.r,e)&&(0,n.WithinEpsilon)(this.g,t.g,e)&&(0,n.WithinEpsilon)(this.b,t.b,e)}negate(){throw ReferenceError("Can not negate a color")}negateInPlace(){throw ReferenceError("Can not negate a color")}negateToRef(t){throw ReferenceError("Can not negate a color")}scale(t){return new c(this.r*t,this.g*t,this.b*t)}scaleInPlace(t){return this.r*=t,this.g*=t,this.b*=t,this}scaleToRef(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e}scaleAndAddToRef(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,e}clampToRef(t=0,e=1,r){return r.r=(0,n.Clamp)(this.r,t,e),r.g=(0,n.Clamp)(this.g,t,e),r.b=(0,n.Clamp)(this.b,t,e),r}add(t){return new c(this.r+t.r,this.g+t.g,this.b+t.b)}addInPlace(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addInPlaceFromFloats(t,e,r){return this.r+=t,this.g+=e,this.b+=r,this}addToRef(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,e}subtract(t){return new c(this.r-t.r,this.g-t.g,this.b-t.b)}subtractToRef(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e}subtractInPlace(t){return this.r-=t.r,this.g-=t.g,this.b-=t.b,this}subtractFromFloats(t,e,r){return new c(this.r-t,this.g-e,this.b-r)}subtractFromFloatsToRef(t,e,r,i){return i.r=this.r-t,i.g=this.g-e,i.b=this.b-r,i}clone(){return new c(this.r,this.g,this.b)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyFromFloats(t,e,r){return this.r=t,this.g=e,this.b=r,this}set(t,e,r){return this.copyFromFloats(t,e,r)}setAll(t){return this.r=this.g=this.b=t,this}toHexString(){let t=Math.round(255*this.r),e=Math.round(255*this.g),r=Math.round(255*this.b);return"#"+(0,n.ToHex)(t)+(0,n.ToHex)(e)+(0,n.ToHex)(r)}fromHexString(t){return"#"!==t.substring(0,1)||7!==t.length||(this.r=parseInt(t.substring(1,3),16)/255,this.g=parseInt(t.substring(3,5),16)/255,this.b=parseInt(t.substring(5,7),16)/255),this}toHSV(){return this.toHSVToRef(new c)}toHSVToRef(t){let e=this.r,r=this.g,i=this.b,s=Math.max(e,r,i),a=Math.min(e,r,i),n=0,h=0,o=s-a;return 0!==s&&(h=o/s),s!=a&&(s==e?(n=(r-i)/o,r<i&&(n+=6)):s==r?n=(i-e)/o+2:s==i&&(n=(e-r)/o+4),n*=60),t.r=n,t.g=h,t.b=s,t}toLinearSpace(t=!1){let e=new c;return this.toLinearSpaceToRef(e,t),e}toLinearSpaceToRef(t,e=!1){return e?(t.r=o(this.r),t.g=o(this.g),t.b=o(this.b)):(t.r=h(this.r),t.g=h(this.g),t.b=h(this.b)),this}toGammaSpace(t=!1){let e=new c;return this.toGammaSpaceToRef(e,t),e}toGammaSpaceToRef(t,e=!1){return e?(t.r=u(this.r),t.g=u(this.g),t.b=u(this.b)):(t.r=l(this.r),t.g=l(this.g),t.b=l(this.b)),this}static HSVtoRGBToRef(t,e,r,i){let s=r*e,a=t/60,n=s*(1-Math.abs(a%2-1)),h=0,o=0,l=0;a>=0&&a<=1?(h=s,o=n):a>=1&&a<=2?(h=n,o=s):a>=2&&a<=3?(o=s,l=n):a>=3&&a<=4?(o=n,l=s):a>=4&&a<=5?(h=n,l=s):a>=5&&a<=6&&(h=s,l=n);let u=r-s;return i.r=h+u,i.g=o+u,i.b=l+u,i}static FromHSV(t,e,r){let i=new c(0,0,0);return c.HSVtoRGBToRef(t,e,r,i),i}static FromHexString(t){return new c(0,0,0).fromHexString(t)}static FromArray(t,e=0){return new c(t[e],t[e+1],t[e+2])}static FromArrayToRef(t,e=0,r){r.r=t[e],r.g=t[e+1],r.b=t[e+2]}static FromInts(t,e,r){return new c(t/255,e/255,r/255)}static Lerp(t,e,r){let i=new c(0,0,0);return c.LerpToRef(t,e,r,i),i}static LerpToRef(t,e,r,i){i.r=t.r+(e.r-t.r)*r,i.g=t.g+(e.g-t.g)*r,i.b=t.b+(e.b-t.b)*r}static Hermite(t,e,r,i,s){let a=s*s,n=s*a,h=2*n-3*a+1,o=-2*n+3*a,l=n-2*a+s,u=n-a,d=t.r*h+r.r*o+e.r*l+i.r*u;return new c(d,t.g*h+r.g*o+e.g*l+i.g*u,t.b*h+r.b*o+e.b*l+i.b*u)}static Hermite1stDerivative(t,e,r,i,s){let a=c.Black();return this.Hermite1stDerivativeToRef(t,e,r,i,s,a),a}static Hermite1stDerivativeToRef(t,e,r,i,s,a){let n=s*s;a.r=(n-s)*6*t.r+(3*n-4*s+1)*e.r+(-n+s)*6*r.r+(3*n-2*s)*i.r,a.g=(n-s)*6*t.g+(3*n-4*s+1)*e.g+(-n+s)*6*r.g+(3*n-2*s)*i.g,a.b=(n-s)*6*t.b+(3*n-4*s+1)*e.b+(-n+s)*6*r.b+(3*n-2*s)*i.b}static Red(){return new c(1,0,0)}static Green(){return new c(0,1,0)}static Blue(){return new c(0,0,1)}static Black(){return new c(0,0,0)}static get BlackReadOnly(){return c._BlackReadOnly}static White(){return new c(1,1,1)}static Purple(){return new c(.5,0,.5)}static Magenta(){return new c(1,0,1)}static Yellow(){return new c(1,1,0)}static Gray(){return new c(.5,.5,.5)}static Teal(){return new c(0,1,1)}static Random(){return new c(Math.random(),Math.random(),Math.random())}}c._V8PerformanceHack=new c(.5,.5,.5),c._BlackReadOnly=c.Black(),Object.defineProperties(c.prototype,{dimension:{value:[3]},rank:{value:1}});class d{constructor(t=0,e=0,r=0,i=1){this.r=t,this.g=e,this.b=r,this.a=i}asArray(){return[this.r,this.g,this.b,this.a]}toArray(t,e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t[e+3]=this.a,this}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this.a=t[e+3],this}equals(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}add(t){return new d(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}addToRef(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,e.a=this.a+t.a,e}addInPlace(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this}addInPlaceFromFloats(t,e,r,i){return this.r+=t,this.g+=e,this.b+=r,this.a+=i,this}subtract(t){return new d(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}subtractToRef(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e.a=this.a-t.a,e}subtractInPlace(t){return this.r-=t.r,this.g-=t.g,this.b-=t.b,this.a-=t.a,this}subtractFromFloats(t,e,r,i){return new d(this.r-t,this.g-e,this.b-r,this.a-i)}subtractFromFloatsToRef(t,e,r,i,s){return s.r=this.r-t,s.g=this.g-e,s.b=this.b-r,s.a=this.a-i,s}scale(t){return new d(this.r*t,this.g*t,this.b*t,this.a*t)}scaleInPlace(t){return this.r*=t,this.g*=t,this.b*=t,this.a*=t,this}scaleToRef(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e.a=this.a*t,e}scaleAndAddToRef(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,e.a+=this.a*t,e}clampToRef(t=0,e=1,r){return r.r=(0,n.Clamp)(this.r,t,e),r.g=(0,n.Clamp)(this.g,t,e),r.b=(0,n.Clamp)(this.b,t,e),r.a=(0,n.Clamp)(this.a,t,e),r}multiply(t){return new d(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a)}multiplyToRef(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,e.a=this.a*t.a,e}multiplyInPlace(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this.a*=t.a,this}multiplyByFloats(t,e,r,i){return new d(this.r*t,this.g*e,this.b*r,this.a*i)}divide(t){throw ReferenceError("Can not divide a color")}divideToRef(t,e){throw ReferenceError("Can not divide a color")}divideInPlace(t){throw ReferenceError("Can not divide a color")}minimizeInPlace(t){return this.r=Math.min(this.r,t.r),this.g=Math.min(this.g,t.g),this.b=Math.min(this.b,t.b),this.a=Math.min(this.a,t.a),this}maximizeInPlace(t){return this.r=Math.max(this.r,t.r),this.g=Math.max(this.g,t.g),this.b=Math.max(this.b,t.b),this.a=Math.max(this.a,t.a),this}minimizeInPlaceFromFloats(t,e,r,i){return this.r=Math.min(t,this.r),this.g=Math.min(e,this.g),this.b=Math.min(r,this.b),this.a=Math.min(i,this.a),this}maximizeInPlaceFromFloats(t,e,r,i){return this.r=Math.max(t,this.r),this.g=Math.max(e,this.g),this.b=Math.max(r,this.b),this.a=Math.max(i,this.a),this}floorToRef(t){throw ReferenceError("Can not floor a color")}floor(){throw ReferenceError("Can not floor a color")}fractToRef(t){throw ReferenceError("Can not fract a color")}fract(){throw ReferenceError("Can not fract a color")}negate(){throw ReferenceError("Can not negate a color")}negateInPlace(){throw ReferenceError("Can not negate a color")}negateToRef(t){throw ReferenceError("Can not negate a color")}equalsWithEpsilon(t,e=a.kn){return(0,n.WithinEpsilon)(this.r,t.r,e)&&(0,n.WithinEpsilon)(this.g,t.g,e)&&(0,n.WithinEpsilon)(this.b,t.b,e)&&(0,n.WithinEpsilon)(this.a,t.a,e)}equalsToFloats(t,e,r,i){return this.r===t&&this.g===e&&this.b===r&&this.a===i}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let t=255*this.r|0;return 397*(t=397*(t=397*t^(255*this.g|0))^(255*this.b|0))^(255*this.a|0)}clone(){return new d().copyFrom(this)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}copyFromFloats(t,e,r,i){return this.r=t,this.g=e,this.b=r,this.a=i,this}set(t,e,r,i){return this.copyFromFloats(t,e,r,i)}setAll(t){return this.r=this.g=this.b=this.a=t,this}toHexString(t=!1){let e=Math.round(255*this.r),r=Math.round(255*this.g),i=Math.round(255*this.b);if(t)return"#"+(0,n.ToHex)(e)+(0,n.ToHex)(r)+(0,n.ToHex)(i);let s=Math.round(255*this.a);return"#"+(0,n.ToHex)(e)+(0,n.ToHex)(r)+(0,n.ToHex)(i)+(0,n.ToHex)(s)}fromHexString(t){return"#"!==t.substring(0,1)||9!==t.length&&7!==t.length||(this.r=parseInt(t.substring(1,3),16)/255,this.g=parseInt(t.substring(3,5),16)/255,this.b=parseInt(t.substring(5,7),16)/255,9===t.length&&(this.a=parseInt(t.substring(7,9),16)/255)),this}toLinearSpace(t=!1){let e=new d;return this.toLinearSpaceToRef(e,t),e}toLinearSpaceToRef(t,e=!1){return e?(t.r=o(this.r),t.g=o(this.g),t.b=o(this.b)):(t.r=h(this.r),t.g=h(this.g),t.b=h(this.b)),t.a=this.a,this}toGammaSpace(t=!1){let e=new d;return this.toGammaSpaceToRef(e,t),e}toGammaSpaceToRef(t,e=!1){return e?(t.r=u(this.r),t.g=u(this.g),t.b=u(this.b)):(t.r=l(this.r),t.g=l(this.g),t.b=l(this.b)),t.a=this.a,this}static FromHexString(t){return"#"!==t.substring(0,1)||9!==t.length&&7!==t.length?new d(0,0,0,0):new d(0,0,0,1).fromHexString(t)}static Lerp(t,e,r){return d.LerpToRef(t,e,r,new d)}static LerpToRef(t,e,r,i){return i.r=t.r+(e.r-t.r)*r,i.g=t.g+(e.g-t.g)*r,i.b=t.b+(e.b-t.b)*r,i.a=t.a+(e.a-t.a)*r,i}static Hermite(t,e,r,i,s){let a=s*s,n=s*a,h=2*n-3*a+1,o=-2*n+3*a,l=n-2*a+s,u=n-a,c=t.r*h+r.r*o+e.r*l+i.r*u,_=t.g*h+r.g*o+e.g*l+i.g*u;return new d(c,_,t.b*h+r.b*o+e.b*l+i.b*u,t.a*h+r.a*o+e.a*l+i.a*u)}static Hermite1stDerivative(t,e,r,i,s){let a=new d;return this.Hermite1stDerivativeToRef(t,e,r,i,s,a),a}static Hermite1stDerivativeToRef(t,e,r,i,s,a){let n=s*s;a.r=(n-s)*6*t.r+(3*n-4*s+1)*e.r+(-n+s)*6*r.r+(3*n-2*s)*i.r,a.g=(n-s)*6*t.g+(3*n-4*s+1)*e.g+(-n+s)*6*r.g+(3*n-2*s)*i.g,a.b=(n-s)*6*t.b+(3*n-4*s+1)*e.b+(-n+s)*6*r.b+(3*n-2*s)*i.b,a.a=(n-s)*6*t.a+(3*n-4*s+1)*e.a+(-n+s)*6*r.a+(3*n-2*s)*i.a}static FromColor3(t,e=1){return new d(t.r,t.g,t.b,e)}static FromArray(t,e=0){return new d(t[e],t[e+1],t[e+2],t[e+3])}static FromArrayToRef(t,e=0,r){r.r=t[e],r.g=t[e+1],r.b=t[e+2],r.a=t[e+3]}static FromInts(t,e,r,i){return new d(t/255,e/255,r/255,i/255)}static CheckColors4(t,e){if(t.length===3*e){let e=[];for(let r=0;r<t.length;r+=3){let i=r/3*4;e[i]=t[r],e[i+1]=t[r+1],e[i+2]=t[r+2],e[i+3]=1}return e}return t}}d._V8PerformanceHack=new d(.5,.5,.5,.5),Object.defineProperties(d.prototype,{dimension:{value:[4]},rank:{value:1}});class _{}_.Color3=(0,i.$G)(3,c.Black),_.Color4=(0,i.$G)(3,()=>new d(0,0,0,0)),(0,s.H7)("BABYLON.Color3",c),(0,s.H7)("BABYLON.Color4",d)},5902:function(t,e,r){r.d(e,{Qt:()=>s,VJ:()=>i,eP:()=>a});let i=!1;function s(t){i=t}let a={get UseOpenGLOrientationForUV(){return i},set UseOpenGLOrientationForUV(value){i=value}}},69254:function(t,e,r){r.d(e,{gn:()=>i});function i(t,e,r,i){var s,a=arguments.length,n=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,r,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(n=(a<3?s(n):a>3?s(e,r,n):s(e,r))||n);return a>3&&n&&Object.defineProperty(e,r,n),n}},81405:function(t,e,r){r.d(e,{$:()=>s});var i=r(44968);class s{static EnableFor(t){t._tags=t._tags||{},t.hasTags=()=>s.HasTags(t),t.addTags=e=>s.AddTagsTo(t,e),t.removeTags=e=>s.RemoveTagsFrom(t,e),t.matchesTagsQuery=e=>s.MatchesQuery(t,e)}static DisableFor(t){delete t._tags,delete t.hasTags,delete t.addTags,delete t.removeTags,delete t.matchesTagsQuery}static HasTags(t){if(!t._tags)return!1;let e=t._tags;for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!0;return!1}static GetTags(t,e=!0){if(!t._tags)return null;if(!e)return t._tags;{let e=[];for(let r in t._tags)Object.prototype.hasOwnProperty.call(t._tags,r)&&!0===t._tags[r]&&e.push(r);return e.join(" ")}}static AddTagsTo(t,e){if(e&&"string"==typeof e)for(let r of e.split(" "))s._AddTagTo(t,r)}static _AddTagTo(t,e){""!==(e=e.trim())&&"true"!==e&&"false"!==e&&(e.match(/[\s]/)||e.match(/^([!]|([|]|[&]){2})/)||(s.EnableFor(t),t._tags[e]=!0))}static RemoveTagsFrom(t,e){if(!s.HasTags(t))return;let r=e.split(" ");for(let e in r)s._RemoveTagFrom(t,r[e])}static _RemoveTagFrom(t,e){delete t._tags[e]}static MatchesQuery(t,e){return void 0===e||(""===e?s.HasTags(t):i.q.Eval(e,e=>s.HasTags(t)&&t._tags[e]))}}},81965:function(t,e,r){r.d(e,{g:()=>s});var i=r(1137);class s{get wrapU(){return this._wrapU}set wrapU(t){this._wrapU=t}get wrapV(){return this._wrapV}set wrapV(t){this._wrapV=t}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(t){this._texture&&(this._texture.isCube=t)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(t){this._texture&&(this._texture.is3D=t)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(t){this._texture&&(this._texture.is2DArray=t)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(t){return t?.shareDepth!==void 0}constructor(t){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=i.$.Zero(),this._cachedBaseSize=i.$.Zero(),this._initialSamplingMode=2,this._texture=s._IsRenderTargetWrapper(t)?t.texture:t,this._texture&&(this._engine=this._texture.getEngine())}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;this._texture._size&&(this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size)}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0),this._cachedBaseSize}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(t){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(t,this._texture,this._texture.generateMipMaps)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}},88609:function(t,e,r){r.d(e,{G6:()=>b,N$:()=>_,QC:()=>u,RR:()=>d,VE:()=>x,XX:()=>g,hd:()=>c,mv:()=>p,n9:()=>o,oQ:()=>m,oU:()=>h,qC:()=>n,qQ:()=>l,rX:()=>f,wz:()=>a});var i=r(49217);function s(t,e){return(r,s)=>{let a=(0,i.x)(r);a[s]||(a[s]={type:t,sourceName:e})}}function a(t,e=null){return function(t,e=null){return(r,i)=>{let s=e||"_"+i;Object.defineProperty(r,i,{get:function(){return this[s]},set:function(e){"function"==typeof this[s]?.equals&&this[s].equals(e)||this[s]!==e&&(this[s]=e,r[t].apply(this))},enumerable:!0,configurable:!0})}}(t,e)}function n(t){return s(0,t)}function h(t){return s(1,t)}function o(t){return s(2,t)}function l(t){return s(3,t)}function u(t){return s(4,t)}function c(t){return s(5,t)}function d(t){return s(6,t)}function _(t){return s(7,t)}function g(t){return s(8,t)}function f(t){return s(9,t)}function p(t){return s(10,t)}function m(t){return s(12,t)}function x(t){return s(11,t)}function b(t,e,r,i){let s=r.value;r.value=(...r)=>{let a=s;if("undefined"!=typeof _native&&_native[e]){let t=_native[e];a=i?(...e)=>i(...e)?t(...e):s(...e):t}return t[e]=a,a(...r)}}b.filter=function(t){return(e,r,i)=>b(e,r,i,t)}},89662:function(t,e,r){function i(t,e,r=!1){let s=e.width,a=e.height;if(t instanceof Float32Array){let e=t.byteLength/t.BYTES_PER_ELEMENT,r=new Uint8Array(e);for(;--e>=0;){let i=t[e];i<0?i=0:i>1&&(i=1),r[e]=255*i}t=r}let n=document.createElement("canvas");n.width=s,n.height=a;let h=n.getContext("2d");if(!h)return null;let o=h.createImageData(s,a);if(o.data.set(t),h.putImageData(o,0,0),r){let t=document.createElement("canvas");t.width=s,t.height=a;let e=t.getContext("2d");return e?(e.translate(0,a),e.scale(1,-1),e.drawImage(n,0,0),t.toDataURL("image/png")):null}return n.toDataURL("image/png")}function s(t,e=0,r=0){let a=t.getInternalTexture();if(!a)return null;let n=t._readPixelsSync(e,r);return n?i(n,t.getSize(),a.invertY):null}async function a(t,e=0,r=0){let s=t.getInternalTexture();if(!s)return null;let n=await t.readPixels(e,r);return n?i(n,t.getSize(),s.invertY):null}r.d(e,{Jj:()=>a,_u:()=>s,r1:()=>n,xj:()=>i});let n={GenerateBase64StringFromPixelData:i,GenerateBase64StringFromTexture:s,GenerateBase64StringFromTextureAsync:a}},90131:function(t,e,r){r.d(e,{p:()=>l});var i=r(53864),s=r(81405),a=r(57423),n=r(61834),h=r(49217);let o=function(t,e,r,i={}){let a=t();s.$&&s.$.HasTags(e)&&s.$.AddTagsTo(a,s.$.GetTags(e,!0));let n=(0,h.D)(a),o={};for(let t in n){let s=n[t],h=e[t],u=s.type;if(null!=h&&("uniqueId"!==t||l.AllowLoadingUniqueId))switch(u){case 0:case 6:case 9:case 11:a[t]=h;break;case 1:i.cloneTexturesOnlyOnce&&o[h.uniqueId]?a[t]=o[h.uniqueId]:(a[t]=r||h.isRenderTarget?h:h.clone(),o[h.uniqueId]=a[t]);break;case 2:case 3:case 4:case 5:case 7:case 8:case 10:case 12:a[t]=r?h:h.clone()}}return a};class l{static AppendSerializedAnimations(t,e){if(t.animations){e.animations=[];for(let r=0;r<t.animations.length;r++){let i=t.animations[r];e.animations.push(i.serialize())}}}static Serialize(t,e){e||(e={}),s.$&&(e.tags=s.$.GetTags(t));let r=(0,h.D)(t);for(let i in r){let s=r[i],a=s.sourceName||i,n=s.type,h=t[i];if(null!=h&&("uniqueId"!==i||l.AllowLoadingUniqueId))switch(n){case 0:e[a]=h;break;case 1:case 3:case 7:case 9:e[a]=h.serialize();break;case 2:case 4:case 5:case 8:case 10:case 12:e[a]=h.asArray();break;case 6:case 11:e[a]=h.id}}return e}static ParseProperties(t,e,r,i){i||(i="");let s=(0,h.D)(e);for(let h in s){let o=s[h],u=t[o.sourceName||h],c=o.type;if(null!=u&&("uniqueId"!==h||l.AllowLoadingUniqueId))switch(c){case 0:e[h]=u;break;case 1:r&&(e[h]=l._TextureParser(u,r,i));break;case 2:e[h]=a.Wo.FromArray(u);break;case 3:e[h]=l._FresnelParametersParser(u);break;case 4:e[h]=n.FM.FromArray(u);break;case 5:e[h]=n.P.FromArray(u);break;case 6:r&&(e[h]=r.getLastMeshById(u));break;case 7:e[h]=l._ColorCurvesParser(u);break;case 8:e[h]=a.HE.FromArray(u);break;case 9:e[h]=l._ImageProcessingConfigurationParser(u);break;case 10:e[h]=n._f.FromArray(u);break;case 11:r&&(e[h]=r.getCameraById(u));break;case 12:e[h]=n.y3.FromArray(u)}}}static Parse(t,e,r,i=null){let a=t();return s.$&&s.$.AddTagsTo(a,e.tags),l.ParseProperties(e,a,r,i),a}static Clone(t,e,r={}){return o(t,e,!1,r)}static Instanciate(t,e){return o(t,e,!0)}}l.AllowLoadingUniqueId=!1,l._ImageProcessingConfigurationParser=t=>{throw(0,i.S)("ImageProcessingConfiguration")},l._FresnelParametersParser=t=>{throw(0,i.S)("FresnelParameters")},l._ColorCurvesParser=t=>{throw(0,i.S)("ColorCurves")},l._TextureParser=(t,e,r)=>{throw(0,i.S)("Texture")}}}]);