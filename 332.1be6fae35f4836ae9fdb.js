
//  This file is part of Cosmos Journeyer
//
//  Copyright (C) 2024 Barthélemy Paléologue <barth.paleologue@cosmosjourneyer.com>
//
//  This program is free software: you can redistribute it and/or modify
//  it under the terms of the GNU Affero General Public License as published by
//  the Free Software Foundation, either version 3 of the License, or
//  (at your option) any later version.
//
//  This program is distributed in the hope that it will be useful,
//  but WITHOUT ANY WARRANTY; without even the implied warranty of
//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//  GNU Affero General Public License for more details.
//
//  You should have received a copy of the GNU Affero General Public License
//  along with this program.  If not, see <https://www.gnu.org/licenses/>.
        
"use strict";(self.webpackChunkcosmos_journeyer=self.webpackChunkcosmos_journeyer||[]).push([[332],{33583:(e,n,t)=>{function r(e){return parseInt(e.toString().replace(/\W/g,""))}function l(e,n,t=1401298e-51){return Math.abs(e-n)<=t}function a(e,n){return e===n?e:Math.random()*(n-e)+e}function o(e,n,t){return e+(n-e)*t}function i(e,n,t){let r=m(n-e,360);return r>180&&(r-=360),e+r*f(t)}function s(e,n,t){let r=0;return r=e!=n?f((t-e)/(n-e)):0,r}function u(e,n,t,r,l){const a=l*l,o=l*a;return e*(2*o-3*a+1)+t*(-2*o+3*a)+n*(o-2*a+l)+r*(o-a)}function c(e,n,t,r,l){const a=l*l;return 6*(a-l)*e+(3*a-4*l+1)*n+6*(-a+l)*t+(3*a-2*l)*r}function f(e,n=0,t=1){return Math.min(t,Math.max(n,e))}function g(e){return e-2*Math.PI*Math.floor((e+Math.PI)/(2*Math.PI))}function h(e){const n=e.toString(16);return e<=15?("0"+n).toUpperCase():n.toUpperCase()}function d(e){if(Math.log2)return Math.floor(Math.log2(e));if(e<0)return NaN;if(0===e)return-1/0;let n=0;if(e<1){for(;e<1;)n++,e*=2;n=-n}else if(e>1)for(;e>1;)n++,e=Math.floor(e/2);return n}function m(e,n){return e-Math.floor(e/n)*n}function p(e,n,t){return(e-n)/(t-n)}function A(e,n,t){return e*(t-n)+n}function b(e,n){let t=m(n-e,360);return t>180&&(t-=360),t}function M(e,n){const t=m(e,2*n);return n-Math.abs(t-n)}function z(e,n,t){let r=f(t);return r=-2*r*r*r+3*r*r,n*r+e*(1-r)}function O(e,n,t){let r=0;return r=Math.abs(n-e)<=t?n:e+Math.sign(n-e)*t,r}function V(e,n,t){const r=b(e,n);let l=0;return l=-t<r&&r<t?n:O(e,n=e+r,t),l}function x(e,n,t){return(e-n)/(t-n)}function T(e,n,t){return(t-n)*e+n}function H(e,n){const t=e%n;return 0===t?n:H(n,t)}t.r(n),t.d(n,{Clamp:()=>f,DeltaAngle:()=>b,Denormalize:()=>A,ExtractAsInt:()=>r,Hermite:()=>u,Hermite1stDerivative:()=>c,HighestCommonFactor:()=>H,ILog2:()=>d,InverseLerp:()=>s,Lerp:()=>o,LerpAngle:()=>i,MoveTowards:()=>O,MoveTowardsAngle:()=>V,Normalize:()=>p,NormalizeRadians:()=>g,PercentToRange:()=>T,PingPong:()=>M,RandomRange:()=>a,RangeToPercent:()=>x,Repeat:()=>m,SmoothStep:()=>z,ToHex:()=>h,WithinEpsilon:()=>l})},65332:(e,n,t)=>{t.r(n),t.d(n,{_IESTextureLoader:()=>l});var r=t(89848);class l{constructor(){this.supportCascades=!1}loadCubeData(){throw".ies not supported in Cube."}loadData(e,n,t){const l=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a=(0,r.i)(l);t(a.width,a.height,!1,!1,(()=>{const e=n.getEngine();n.type=1,n.format=6,n._gammaSpace=!1,e._uploadDataToTextureDirectly(n,a.data)}))}}},89848:(e,n,t)=>{t.d(n,{i:()=>i});var r=t(33583);function l(e){return e.split(" ").filter((e=>""!==e)).map((e=>parseFloat(e)))}function a(e,n,t){for(;t.length!==n;){const n=l(e.lines[e.index++]);t.push(...n)}}function o(e,n,t){let l=0,a=0,o=0,i=0,s=0,u=0;for(let n=0;n<e.numberOfHorizontalAngles-1;n++)if(t<e.horizontalAngles[n+1]||n===e.numberOfHorizontalAngles-2){a=n,o=e.horizontalAngles[n],i=e.horizontalAngles[n+1];break}for(let t=0;t<e.numberOfVerticalAngles-1;t++)if(n<e.verticalAngles[t+1]||t===e.numberOfVerticalAngles-2){l=t,s=e.verticalAngles[t],u=e.verticalAngles[t+1];break}const c=i-o,f=u-s;if(0===f)return 0;const g=0===c?0:(t-o)/c,h=(n-s)/f,d=0===c?a:a+1,m=(0,r.Lerp)(e.candelaValues[a][l],e.candelaValues[d][l],g),p=(0,r.Lerp)(e.candelaValues[a][l+1],e.candelaValues[d][l+1],g);return(0,r.Lerp)(m,p,h)}function i(e){const n={lines:new TextDecoder("utf-8").decode(e).split("\n"),index:0},t={version:n.lines[0],candelaValues:[],horizontalAngles:[],verticalAngles:[],numberOfHorizontalAngles:0,numberOfVerticalAngles:0};for(n.index=1;n.lines.length>0&&!n.lines[n.index].includes("TILT=");)n.index++;n.lines[n.index].includes("INCLUDE"),n.index++;const r=l(n.lines[n.index++]);t.numberOfLights=r[0],t.lumensPerLamp=r[1],t.candelaMultiplier=r[2],t.numberOfVerticalAngles=r[3],t.numberOfHorizontalAngles=r[4],t.photometricType=r[5],t.unitsType=r[6],t.width=r[7],t.length=r[8],t.height=r[9];const i=l(n.lines[n.index++]);t.ballastFactor=i[0],t.fileGenerationType=i[1],t.inputWatts=i[2];for(let e=0;e<t.numberOfHorizontalAngles;e++)t.candelaValues[e]=[];a(n,t.numberOfVerticalAngles,t.verticalAngles),a(n,t.numberOfHorizontalAngles,t.horizontalAngles);for(let e=0;e<t.numberOfHorizontalAngles;e++)a(n,t.numberOfVerticalAngles,t.candelaValues[e]);let s=-1;for(let e=0;e<t.numberOfHorizontalAngles;e++)for(let n=0;n<t.numberOfVerticalAngles;n++)t.candelaValues[e][n]*=t.candelaValues[e][n]*t.candelaMultiplier*t.ballastFactor*t.fileGenerationType,s=Math.max(s,t.candelaValues[e][n]);if(s>0)for(let e=0;e<t.numberOfHorizontalAngles;e++)for(let n=0;n<t.numberOfVerticalAngles;n++)t.candelaValues[e][n]/=s;const u=new Float32Array(64800),c=t.horizontalAngles[0],f=t.horizontalAngles[t.numberOfHorizontalAngles-1];for(let e=0;e<64800;e++){let n=e%360;const r=Math.floor(e/360);f-c!=0&&(n<c||n>=f)&&(n%=2*f,n>f&&(n=2*f-n)),u[r+180*n]=o(t,r,n)}return{width:180,height:1,data:u}}}}]);